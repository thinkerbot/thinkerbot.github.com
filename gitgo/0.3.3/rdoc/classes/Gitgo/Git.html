<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Gitgo::Git</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Gitgo::Git</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/gitgo/git_rb.html">
                lib/gitgo/git.rb
                </a>
        <br />
                <a href="../../files/lib/gitgo/git/tree_rb.html">
                lib/gitgo/git/tree.rb
                </a>
        <br />
                <a href="../../files/lib/gitgo/git/utils_rb.html">
                lib/gitgo/git/utils.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
A wrapper to a Grit::Repo that allows access and modification of a git
repository without checking files out (under most circumstances). The api
is patterned after the git command line interface.
</p>
<h2>Usage</h2>
<p>
Checkout, <a href="Git.html#M000214">add</a>, and <a
href="Git.html#M000216">commit</a> <a href="Git.html#M000198">new</a>
content:
</p>
<pre>
  git = Git.init(&quot;example&quot;, :author =&gt; &quot;John Doe &lt;jdoe@example.com&gt;&quot;)
  git.add(
    &quot;README&quot; =&gt; &quot;New Project&quot;,
    &quot;lib/project.rb&quot; =&gt; &quot;module Project\nend&quot;,
    &quot;remove_this_file&quot; =&gt; &quot;won't be here long...&quot;)

  git.commit(&quot;setup a new project&quot;)
</pre>
<p>
Content may be removed as well:
</p>
<pre>
  git.rm(&quot;remove_this_file&quot;)
  git.commit(&quot;removed extra file&quot;)
</pre>
<p>
Now access the content:
</p>
<pre>
  git[&quot;/&quot;]                          # =&gt; [&quot;README&quot;, &quot;lib&quot;]
  git[&quot;/lib/project.rb&quot;]            # =&gt; &quot;module Project\nend&quot;
  git[&quot;/remove_this_file&quot;]          # =&gt; nil
</pre>
<p>
You can go back in time if you wish:
</p>
<pre>
  git.branch = &quot;gitgo^&quot;
  git[&quot;/remove_this_file&quot;]          # =&gt; &quot;won't be here long...&quot;
</pre>
<p>
For direct access to the Grit objects, use <a
href="Git.html#M000206">get</a>:
</p>
<pre>
  git.get(&quot;/lib&quot;).id                # =&gt; &quot;cad0dc0df65848aa8f3fee72ce047142ec707320&quot;
  git.get(&quot;/lib/project.rb&quot;).id     # =&gt; &quot;636e25a2c9fe1abc3f4d3f380956800d5243800e&quot;
</pre>
<h3>The Working <a href="Git/Tree.html">Tree</a></h3>
<p>
Changes to the repo are tracked by an in-memory working tree until being
committed. Trees can be thought of as a hash of (<a
href="Git.html#M000201">path</a>, [:mode, sha]) pairs representing the
contents of a directory.
</p>
<pre>
  git = Git.init(&quot;example&quot;, :author =&gt; &quot;John Doe &lt;jdoe@example.com&gt;&quot;)
  git.add(
    &quot;README&quot; =&gt; &quot;New Project&quot;,
    &quot;lib/project.rb&quot; =&gt; &quot;module Project\nend&quot;
  ).commit(&quot;added files&quot;)

  git.tree
  # =&gt; {
  #   &quot;README&quot; =&gt; [:&quot;100644&quot;, &quot;73a86c2718da3de6414d3b431283fbfc074a79b1&quot;],
  #   &quot;lib&quot; =&gt; {
  #     &quot;project.rb&quot; =&gt; [:&quot;100644&quot;, &quot;636e25a2c9fe1abc3f4d3f380956800d5243800e&quot;]
  #   }
  # }
</pre>
<p>
Trees can be collapsed using <a href="Git.html#M000218">reset</a>.
Afterwards subtrees are only expanded as needed; before expansion they
appear as a [:mode, sha] pair and after expansion they appear as a hash.
Symbol paths are used to differentiate subtrees (which can be expanded)
from blobs (which cannot be expanded).
</p>
<pre>
  git.reset
  git.tree
  # =&gt; {
  #   &quot;README&quot; =&gt; [:&quot;100644&quot;, &quot;73a86c2718da3de6414d3b431283fbfc074a79b1&quot;],
  #   :lib =&gt;     [:&quot;040000&quot;, &quot;cad0dc0df65848aa8f3fee72ce047142ec707320&quot;]
  # }

  git.add(&quot;lib/project/utils.rb&quot; =&gt; &quot;module Project\n  module Utils\n  end\nend&quot;)
  git.tree
  # =&gt; {
  #   &quot;README&quot; =&gt; [:&quot;100644&quot;, &quot;73a86c2718da3de6414d3b431283fbfc074a79b1&quot;],
  #   &quot;lib&quot; =&gt; {
  #     &quot;project.rb&quot; =&gt; [:&quot;100644&quot;, &quot;636e25a2c9fe1abc3f4d3f380956800d5243800e&quot;],
  #     &quot;project&quot; =&gt; {
  #       &quot;utils.rb&quot; =&gt; [:&quot;100644&quot;, &quot;c4f9aa58d6d5a2ebdd51f2f628b245f9454ff1a4&quot;]
  #     }
  #   }
  # }

  git.rm(&quot;README&quot;)
  git.tree
  # =&gt; {
  #   &quot;lib&quot; =&gt; {
  #     &quot;project.rb&quot; =&gt; [:&quot;100644&quot;, &quot;636e25a2c9fe1abc3f4d3f380956800d5243800e&quot;],
  #     &quot;project&quot; =&gt; {
  #       &quot;utils.rb&quot; =&gt; [:&quot;100644&quot;, &quot;c4f9aa58d6d5a2ebdd51f2f628b245f9454ff1a4&quot;]
  #     }
  #   }
  # }
</pre>
<p>
The working tree can be compared with the <a
href="Git.html#M000216">commit</a> tree to produce a list of files that
have been added and removed using the <a href="Git.html#M000219">status</a>
method:
</p>
<pre>
  git.status
  # =&gt; {
  #   &quot;README&quot; =&gt; :rm
  #   &quot;lib/project/utils.rb&quot; =&gt; :add
  # }
</pre>
<h2>Tracking, Push/Pull</h2>
<p>
<a href="Git.html">Git</a> provides limited support for setting a tracking
branch and doing push/pull from tracking branches without checking the
gitgo branch out. More complicated operations can are left to the command
line, where the current branch can be directly manipulated by the git
program.
</p>
<p>
Unlike git (the program), <a href="Git.html">Git</a> (the class) requires
the upstream branch setup by &#8216;git branch &#8212;<a
href="Git.html#M000210">track</a>&#8217; to be an existing tracking branch.
As an example, if you were to setup this:
</p>
<pre>
  % git branch --track remote/branch
</pre>
<p>
Or equivalently this:
</p>
<pre>
  git = Git.init
  git.track &quot;remote/branch&quot;
</pre>
<p>
Then <a href="Git.html">Git</a> would assume:
</p>
<ul>
<li>the upstream branch is &#8216;remote/branch&#8216;

</li>
<li>the tracking branch is &#8216;remotes/remote/branch&#8216;

</li>
<li>the &#8216;branch.name.<a href="Git.html#M000212">remote</a>&#8217; config
is &#8216;<a href="Git.html#M000212">remote</a>&#8216;

</li>
<li>the &#8216;branch.name.<a href="Git.html#M000223">merge</a>&#8217; config
is &#8216;refs/heads/branch&#8216;

</li>
</ul>
<p>
If ever these assumptions are broken, for instance if the gitgo branch is
manually <a href="Git.html#M000207">set</a> up to <a
href="Git.html#M000210">track</a> a local branch, methods like pull/push
could cause odd failures. To help check:
</p>
<ul>
<li><a href="Git.html#M000210">track</a> will raise an error if the upstream
branch is not a tracking branch

</li>
<li><a href="Git.html#M000211">upstream_branch</a> raises an error if the
&#8216;branch.name.<a href="Git.html#M000223">merge</a>&#8217; config
doesn&#8216;t follow the &#8216;ref/heads/branch&#8217; pattern

</li>
<li>pull/push raise an error given a non-tracking branch

</li>
</ul>
<p>
Under normal circumstances, all these assumptions will be met.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000208">[]</a>&nbsp;&nbsp;
      <a href="#M000209">[]=</a>&nbsp;&nbsp;
      <a href="#M000214">add</a>&nbsp;&nbsp;
      <a href="#M000202">author</a>&nbsp;&nbsp;
      <a href="#M000203">author=</a>&nbsp;&nbsp;
      <a href="#M000220">checkout</a>&nbsp;&nbsp;
      <a href="#M000226">clone</a>&nbsp;&nbsp;
      <a href="#M000216">commit</a>&nbsp;&nbsp;
      <a href="#M000217">commit!</a>&nbsp;&nbsp;
      <a href="#M000234">commit_grep</a>&nbsp;&nbsp;
      <a href="#M000195">debug</a>&nbsp;&nbsp;
      <a href="#M000199">default_blob_mode=</a>&nbsp;&nbsp;
      <a href="#M000200">default_tree_mode=</a>&nbsp;&nbsp;
      <a href="#M000230">diff_tree</a>&nbsp;&nbsp;
      <a href="#M000221">fetch</a>&nbsp;&nbsp;
      <a href="#M000237">fsck</a>&nbsp;&nbsp;
      <a href="#M000236">gc</a>&nbsp;&nbsp;
      <a href="#M000206">get</a>&nbsp;&nbsp;
      <a href="#M000232">grep</a>&nbsp;&nbsp;
      <a href="#M000194">init</a>&nbsp;&nbsp;
      <a href="#M000231">ls_tree</a>&nbsp;&nbsp;
      <a href="#M000223">merge</a>&nbsp;&nbsp;
      <a href="#M000222">merge?</a>&nbsp;&nbsp;
      <a href="#M000198">new</a>&nbsp;&nbsp;
      <a href="#M000201">path</a>&nbsp;&nbsp;
      <a href="#M000235">prune</a>&nbsp;&nbsp;
      <a href="#M000225">pull</a>&nbsp;&nbsp;
      <a href="#M000224">push</a>&nbsp;&nbsp;
      <a href="#M000212">remote</a>&nbsp;&nbsp;
      <a href="#M000218">reset</a>&nbsp;&nbsp;
      <a href="#M000204">resolve</a>&nbsp;&nbsp;
      <a href="#M000229">rev_list</a>&nbsp;&nbsp;
      <a href="#M000227">rev_parse</a>&nbsp;&nbsp;
      <a href="#M000215">rm</a>&nbsp;&nbsp;
      <a href="#M000228">safe_rev_parse</a>&nbsp;&nbsp;
      <a href="#M000239">sandbox</a>&nbsp;&nbsp;
      <a href="#M000207">set</a>&nbsp;&nbsp;
      <a href="#M000238">stats</a>&nbsp;&nbsp;
      <a href="#M000219">status</a>&nbsp;&nbsp;
      <a href="#M000210">track</a>&nbsp;&nbsp;
      <a href="#M000213">tracking_branch?</a>&nbsp;&nbsp;
      <a href="#M000233">tree_grep</a>&nbsp;&nbsp;
      <a href="#M000205">type</a>&nbsp;&nbsp;
      <a href="#M000211">upstream_branch</a>&nbsp;&nbsp;
      <a href="#M000196">version</a>&nbsp;&nbsp;
      <a href="#M000197">version_ok?</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name">Enumerable</span>
        <span class="include-name"><a href="Git/Utils.html">Utils</a></span>
      </div>
    </div>

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Module <a href="Git/Utils.html" class="link">Gitgo::Git::Utils</a><br />
Class <a href="Git/Tree.html" class="link">Gitgo::Git::Tree</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT_BRANCH</td>
          <td>=</td>
          <td class="context-item-value">'gitgo'</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The default branch

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT_UPSTREAM_BRANCH</td>
          <td>=</td>
          <td class="context-item-value">'origin/gitgo'</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The default upstream branch for push/pull

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT_WORK_DIR</td>
          <td>=</td>
          <td class="context-item-value">'gitgo'</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The default directory for gitgo-related files

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT_BLOB_MODE</td>
          <td>=</td>
          <td class="context-item-value">'100644'.to_sym</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The default blob mode used for added blobs

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT_TREE_MODE</td>
          <td>=</td>
          <td class="context-item-value">'40000'.to_sym</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The default tree mode used for added trees

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SHA</td>
          <td>=</td>
          <td class="context-item-value">/\A[A-Fa-f\d]{40}\z/</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
A regexp matching a valid sha sum

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">GIT_VERSION</td>
          <td>=</td>
          <td class="context-item-value">[1,6,4,2]</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The minimum required <a href="Git.html#M000196">version</a> of git (see
Git.version_ok?)

</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">branch</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The gitgo branch

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">default_blob_mode</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The default blob mode for self (see DEFAULT_BLOB_MODE)

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">default_tree_mode</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The default tree mode for self (see DEFAULT_TREE_MODE)

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">grit</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The internal Grit::Repo

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">head</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
Returns the sha for the branch

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">index_file</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The <a href="Git.html#M000201">path</a> to the temporary index_file

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">tree</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The in-memory working tree tracking any adds and removes

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">work_dir</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The <a href="Git.html#M000201">path</a> to the instance working directory

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">work_tree</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The <a href="Git.html#M000201">path</a> to the temporary working tree

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000195" class="method-detail">
        <a name="M000195"></a>

        <div class="method-heading">
          <a href="#M000195" class="method-signature">
          <span class="method-name">debug</span><span class="method-args">(dev=$stdout) {|| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets up Grit to log to the device for the duration of the block. Primarily
useful during debugging, and inadvisable otherwise because the logger must
be shared among all Grit::Repo instances (this is a consequence of how
logging is implemented in Grit).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000195-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000195-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 170</span>
170:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">debug</span>(<span class="ruby-identifier">dev</span>=<span class="ruby-identifier">$stdout</span>)
171:         <span class="ruby-identifier">current_logger</span> = <span class="ruby-constant">Grit</span>.<span class="ruby-identifier">logger</span>
172:         <span class="ruby-identifier">current_debug</span> = <span class="ruby-constant">Grit</span>.<span class="ruby-identifier">debug</span>
173:         <span class="ruby-keyword kw">begin</span>
174:           <span class="ruby-constant">Grit</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-constant">Logger</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">dev</span>)
175:           <span class="ruby-constant">Grit</span>.<span class="ruby-identifier">debug</span> = <span class="ruby-keyword kw">true</span>
176:           <span class="ruby-keyword kw">yield</span>
177:         <span class="ruby-keyword kw">ensure</span>
178:           <span class="ruby-constant">Grit</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">current_logger</span>
179:           <span class="ruby-constant">Grit</span>.<span class="ruby-identifier">debug</span> = <span class="ruby-identifier">current_debug</span>
180:         <span class="ruby-keyword kw">end</span>
181:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000194" class="method-detail">
        <a name="M000194"></a>

        <div class="method-heading">
          <a href="#M000194" class="method-signature">
          <span class="method-name">init</span><span class="method-args">(path=Dir.pwd, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a <a href="Git.html">Git</a> instance for <a
href="Git.html#M000201">path</a>, initializing the repo if necessary.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000194-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000194-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 148</span>
148:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init</span>(<span class="ruby-identifier">path</span>=<span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>, <span class="ruby-identifier">options</span>={})
149:         <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">path</span>)
150:           <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-identifier">path</span>)
151:           
152:           <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword kw">do</span>
153:             <span class="ruby-identifier">bare</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:is_bare</span>] <span class="ruby-operator">?</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>
154:             <span class="ruby-identifier">gitdir</span> = <span class="ruby-identifier">bare</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\.git$/</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value str">&quot;.git&quot;</span>)
155:             
156:             <span class="ruby-constant">Utils</span>.<span class="ruby-identifier">with_env</span>(<span class="ruby-value str">'GIT_DIR'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">gitdir</span>) <span class="ruby-keyword kw">do</span>
157:               <span class="ruby-identifier">git</span> = <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Git</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">gitdir</span>)
158:               <span class="ruby-identifier">git</span>.<span class="ruby-identifier">init</span>({<span class="ruby-identifier">:bare</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">bare</span>})
159:             <span class="ruby-keyword kw">end</span>
160:           <span class="ruby-keyword kw">end</span>
161:         <span class="ruby-keyword kw">end</span>
162:         
163:         <span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>)
164:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000198" class="method-detail">
        <a name="M000198"></a>

        <div class="method-heading">
          <a href="#M000198" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(path=Dir.pwd, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Initializes a <a href="Git.html#M000198">new</a> <a href="Git.html">Git</a>
bound to the repository at the specified <a
href="Git.html#M000201">path</a>. Raises an error if no such repository
exists. Options can specify the following:
</p>
<pre>
  :branch     the branch for self
  :author     the author for self
  + any Grit::Repo options
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000198-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000198-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 255</span>
255:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">path</span>=<span class="ruby-constant">Dir</span>.<span class="ruby-identifier">pwd</span>, <span class="ruby-identifier">options</span>={})
256:       <span class="ruby-ivar">@grit</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Repo</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">:</span> <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Repo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>)
257:       <span class="ruby-ivar">@sandbox</span> = <span class="ruby-keyword kw">false</span>
258:       <span class="ruby-ivar">@branch</span> = <span class="ruby-keyword kw">nil</span>
259:       <span class="ruby-ivar">@work_dir</span> = <span class="ruby-identifier">path</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:work_dir</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">DEFAULT_WORK_DIR</span>)
260:       <span class="ruby-ivar">@work_tree</span>  = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:work_tree</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">work_dir</span>, <span class="ruby-value str">'tmp'</span>, <span class="ruby-identifier">object_id</span>.<span class="ruby-identifier">to_s</span>)
261:       <span class="ruby-ivar">@index_file</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:index_file</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">work_dir</span>, <span class="ruby-value str">'tmp'</span>, <span class="ruby-node">&quot;#{object_id}.index&quot;</span>)
262:       
263:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">author</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:author</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword kw">nil</span>
264:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">checkout</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:branch</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">DEFAULT_BRANCH</span>
265:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">default_blob_mode</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:default_blob_mode</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">DEFAULT_BLOB_MODE</span>
266:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">default_tree_mode</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:default_tree_mode</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">DEFAULT_TREE_MODE</span>
267:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000196" class="method-detail">
        <a name="M000196"></a>

        <div class="method-heading">
          <a href="#M000196" class="method-signature">
          <span class="method-name">version</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the git <a href="Git.html#M000196">version</a> as an array of
integers like [1,6,4,2]. The <a href="Git.html#M000196">version</a> query
performed once and then cached.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000196-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000196-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 185</span>
185:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">version</span>
186:         <span class="ruby-ivar">@version</span> <span class="ruby-operator">||=</span> <span class="ruby-value">`git --version`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/\s/</span>).<span class="ruby-identifier">last</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;.&quot;</span>).<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">to_i</span>}
187:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000197" class="method-detail">
        <a name="M000197"></a>

        <div class="method-heading">
          <a href="#M000197" class="method-signature">
          <span class="method-name">version_ok?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Checks if the git <a href="Git.html#M000196">version</a> is compatible with
GIT_VERSION. This check is performed once and then cached.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000197-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000197-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 191</span>
191:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">version_ok?</span>
192:         <span class="ruby-ivar">@version_ok</span> <span class="ruby-operator">||=</span> ((<span class="ruby-constant">GIT_VERSION</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">version</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
193:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000208" class="method-detail">
        <a name="M000208"></a>

        <div class="method-heading">
          <a href="#M000208" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(path, entry=false, committed=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Gets the content for <a href="Git.html#M000201">path</a>; either the blob
data or an array of content names for a tree. Returns nil if <a
href="Git.html#M000201">path</a> doesn&#8216;t exist.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000208-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000208-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 356</span>
356:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">entry</span>=<span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">committed</span>=<span class="ruby-keyword kw">false</span>)
357:       <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">committed</span> <span class="ruby-value">? </span><span class="ruby-identifier">commit_tree</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@tree</span>
358:       
359:       <span class="ruby-identifier">segments</span> = <span class="ruby-identifier">split</span>(<span class="ruby-identifier">path</span>)
360:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">basename</span> = <span class="ruby-identifier">segments</span>.<span class="ruby-identifier">pop</span>
361:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">entry</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">tree</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">keys</span>
362:       <span class="ruby-keyword kw">end</span>
363:       
364:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">tree</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">subtree</span>(<span class="ruby-identifier">segments</span>)
365:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> 
366:       <span class="ruby-keyword kw">end</span>
367:       
368:       <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">tree</span>[<span class="ruby-identifier">basename</span>]
369:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">obj</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">entry</span>
370:       
371:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">obj</span>
372:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">:blob</span>, <span class="ruby-identifier">obj</span>[<span class="ruby-value">1</span>]).<span class="ruby-identifier">data</span>
373:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Tree</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">keys</span>
374:       <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">nil</span>
375:       <span class="ruby-keyword kw">end</span>
376:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000209" class="method-detail">
        <a name="M000209"></a>

        <div class="method-heading">
          <a href="#M000209" class="method-signature">
          <span class="method-name">[]=</span><span class="method-args">(path, content=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets content for <a href="Git.html#M000201">path</a>. The content can
either be:
</p>
<ul>
<li>a string of content

</li>
<li>a symbol sha, translated to [default_blob_mode, sha]

</li>
<li>an array like [mode, sha]

</li>
<li>a nil, to remove content

</li>
</ul>
<p>
Note that <a href="Git.html#M000207">set</a> content is immediately stored
in the repo and tracked in the in-memory working tree but not committed
until <a href="Git.html#M000216">commit</a> is called.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000209-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000209-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 387</span>
387:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">content</span>=<span class="ruby-keyword kw">nil</span>)
388:       <span class="ruby-identifier">segments</span> = <span class="ruby-identifier">split</span>(<span class="ruby-identifier">path</span>)
389:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">basename</span> = <span class="ruby-identifier">segments</span>.<span class="ruby-identifier">pop</span>
390:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;invalid path: #{path.inspect}&quot;</span>
391:       <span class="ruby-keyword kw">end</span>
392:       
393:       <span class="ruby-identifier">tree</span> = <span class="ruby-ivar">@tree</span>.<span class="ruby-identifier">subtree</span>(<span class="ruby-identifier">segments</span>, <span class="ruby-keyword kw">true</span>)
394:       <span class="ruby-identifier">tree</span>[<span class="ruby-identifier">basename</span>] = <span class="ruby-identifier">convert_to_entry</span>(<span class="ruby-identifier">content</span>)
395:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000214" class="method-detail">
        <a name="M000214"></a>

        <div class="method-heading">
          <a href="#M000214" class="method-signature">
          <span class="method-name">add</span><span class="method-args">(paths)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a hash of (<a href="Git.html#M000201">path</a>, content) pairs (see
AGET for valid content).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000214-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000214-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 452</span>
452:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add</span>(<span class="ruby-identifier">paths</span>)
453:       <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span>, <span class="ruby-identifier">content</span><span class="ruby-operator">|</span>
454:         <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">path</span>] = <span class="ruby-identifier">content</span>
455:       <span class="ruby-keyword kw">end</span>
456:       
457:       <span class="ruby-keyword kw">self</span>
458:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000202" class="method-detail">
        <a name="M000202"></a>

        <div class="method-heading">
          <a href="#M000202" class="method-signature">
          <span class="method-name">author</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the configured <a href="Git.html#M000202">author</a> (which should
be a Grit::Actor, or similar). If no <a href="Git.html#M000202">author</a>
is is currently <a href="Git.html#M000207">set</a>, a default <a
href="Git.html#M000202">author</a> will be determined from the git
configurations.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000202-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000202-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 289</span>
289:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">author</span>
290:       <span class="ruby-ivar">@author</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">begin</span>
291:         <span class="ruby-identifier">name</span> =  <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">config</span>[<span class="ruby-value str">'user.name'</span>]
292:         <span class="ruby-identifier">email</span> = <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">config</span>[<span class="ruby-value str">'user.email'</span>]
293:         <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Actor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">email</span>)
294:       <span class="ruby-keyword kw">end</span>
295:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000203" class="method-detail">
        <a name="M000203"></a>

        <div class="method-heading">
          <a href="#M000203" class="method-signature">
          <span class="method-name">author=</span><span class="method-args">(input)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the <a href="Git.html#M000202">author</a>. The input may be a
Grit::Actor, an array like [<a href="Git.html#M000202">author</a>, email],
a git-formatted <a href="Git.html#M000202">author</a> string, or nil.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000203-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000203-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 299</span>
299:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">author=</span>(<span class="ruby-identifier">input</span>)
300:       <span class="ruby-ivar">@author</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">input</span>
301:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Actor</span>, <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">input</span>
302:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Actor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">input</span>)
303:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span> <span class="ruby-keyword kw">then</span> <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Actor</span>.<span class="ruby-identifier">from_string</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">input</span>)
304:       <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;could not convert to Grit::Actor: #{input.class}&quot;</span>
305:       <span class="ruby-keyword kw">end</span>
306:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000220" class="method-detail">
        <a name="M000220"></a>

        <div class="method-heading">
          <a href="#M000220" class="method-signature">
          <span class="method-name">checkout</span><span class="method-args">(branch=self.branch) {|working_dir| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the current branch and updates tree.
</p>
<p>
Checkout does not actually <a href="Git.html#M000220">checkout</a> any
files unless a block is given. In that case, the current branch will be
checked out for the duration of the block into work_tree; a gitgo-specific
directory distinct from the user&#8216;s working directory. Checkout with a
block permits the execution of git commands that must be performed in a
working directory.
</p>
<p>
Returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000220-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000220-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 577</span>
577:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">checkout</span>(<span class="ruby-identifier">branch</span>=<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">branch</span>) <span class="ruby-comment cmt"># :yields: working_dir</span>
578:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">branch</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@branch</span>
579:         <span class="ruby-ivar">@branch</span> = <span class="ruby-identifier">branch</span>
580:         <span class="ruby-identifier">reset</span>
581:       <span class="ruby-keyword kw">end</span>
582:       
583:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
584:         <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
585:           <span class="ruby-identifier">git</span>.<span class="ruby-identifier">read_tree</span>({<span class="ruby-identifier">:index_output</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">index_file</span>}, <span class="ruby-identifier">branch</span>)
586:           <span class="ruby-identifier">git</span>.<span class="ruby-identifier">checkout_index</span>({<span class="ruby-identifier">:a</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>})
587:           <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">work_tree</span>)
588:         <span class="ruby-keyword kw">end</span>
589:       <span class="ruby-keyword kw">end</span>
590:       
591:       <span class="ruby-keyword kw">self</span>
592:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000226" class="method-detail">
        <a name="M000226"></a>

        <div class="method-heading">
          <a href="#M000226" class="method-signature">
          <span class="method-name">clone</span><span class="method-args">(path, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Clones self into the specified <a href="Git.html#M000201">path</a> and sets
up tracking of branch in the <a href="Git.html#M000198">new</a> grit. Clone
was primarily implemented for testing; normally clones are managed by the
user.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000226-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000226-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 675</span>
675:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clone</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>={})
676:       <span class="ruby-identifier">with_env</span> <span class="ruby-keyword kw">do</span>
677:         <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">clone</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">path</span>, <span class="ruby-identifier">path</span>)
678:         <span class="ruby-identifier">clone</span> = <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Repo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>)
679: 
680:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:bare</span>]
681:           <span class="ruby-comment cmt"># bare origins directly copy branch heads without mapping them to</span>
682:           <span class="ruby-comment cmt"># 'refs/remotes/origin/' (see git-clone docs). this maps the branch</span>
683:           <span class="ruby-comment cmt"># head so the bare grit can checkout branch</span>
684:           <span class="ruby-identifier">clone</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">remote</span>({}, <span class="ruby-value str">&quot;add&quot;</span>, <span class="ruby-value str">&quot;origin&quot;</span>, <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">path</span>)
685:           <span class="ruby-identifier">clone</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">fetch</span>({}, <span class="ruby-value str">&quot;origin&quot;</span>)
686:           <span class="ruby-identifier">clone</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">branch</span>({}, <span class="ruby-value str">&quot;-D&quot;</span>, <span class="ruby-identifier">branch</span>)
687:         <span class="ruby-keyword kw">end</span>
688: 
689:         <span class="ruby-comment cmt"># sets up branch to track the origin to enable pulls</span>
690:         <span class="ruby-identifier">clone</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">branch</span>({<span class="ruby-identifier">:track</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}, <span class="ruby-identifier">branch</span>, <span class="ruby-node">&quot;origin/#{branch}&quot;</span>)
691:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">clone</span>, <span class="ruby-identifier">:branch</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">branch</span>, <span class="ruby-identifier">:author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">author</span>)
692:       <span class="ruby-keyword kw">end</span>
693:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000216" class="method-detail">
        <a name="M000216"></a>

        <div class="method-heading">
          <a href="#M000216" class="method-signature">
          <span class="method-name">commit</span><span class="method-args">(message, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Commits the in-memory working tree to branch with the specified message and
returns the sha for the <a href="Git.html#M000198">new</a> <a
href="Git.html#M000216">commit</a>. The branch is created if it
doesn&#8216;t already exist. Options can specify (as symbols):
</p>
<table>
<tr><td valign="top">tree:</td><td>The sha of the tree this <a href="Git.html#M000216">commit</a> points to
(default the sha for tree, the in-memory working tree)

</td></tr>
<tr><td valign="top">parents:</td><td>An array of shas representing parent commits (default the current <a
href="Git.html#M000216">commit</a>)

</td></tr>
<tr><td valign="top"><a href="Git.html#M000202">author</a>:</td><td>A Grit::Actor, or similar representing the <a
href="Git.html#M000216">commit</a> <a href="Git.html#M000202">author</a>
(default <a href="Git.html#M000202">author</a>)

</td></tr>
<tr><td valign="top">authored_date:</td><td>The authored date (default now)

</td></tr>
<tr><td valign="top">committer:</td><td>A Grit::Actor, or similar representing the user making the <a
href="Git.html#M000216">commit</a> (default <a
href="Git.html#M000202">author</a>)

</td></tr>
<tr><td valign="top">committed_date:</td><td>The authored date (default now)

</td></tr>
</table>
<p>
Raises an error if there are no changes to <a
href="Git.html#M000216">commit</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000216-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000216-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 482</span>
482:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">commit</span>(<span class="ruby-identifier">message</span>, <span class="ruby-identifier">options</span>={})
483:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;no changes to commit&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">status</span>.<span class="ruby-identifier">empty?</span>
484:       <span class="ruby-identifier">commit!</span>(<span class="ruby-identifier">message</span>, <span class="ruby-identifier">options</span>)
485:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000217" class="method-detail">
        <a name="M000217"></a>

        <div class="method-heading">
          <a href="#M000217" class="method-signature">
          <span class="method-name">commit!</span><span class="method-args">(message, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="Git.html#M000216">commit</a> but does not check if there
are changes to <a href="Git.html#M000216">commit</a>, useful when you know
there are changes to <a href="Git.html#M000216">commit</a> and don&#8216;t
want the overhead of checking for changes.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000217-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000217-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 490</span>
490:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">commit!</span>(<span class="ruby-identifier">message</span>, <span class="ruby-identifier">options</span>={})
491:       <span class="ruby-identifier">now</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
492:       
493:       <span class="ruby-identifier">sha</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:tree</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">write_to</span>(<span class="ruby-keyword kw">self</span>).<span class="ruby-identifier">at</span>(<span class="ruby-value">1</span>)
494:       <span class="ruby-identifier">parents</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:parents</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">head</span> <span class="ruby-value">? </span>[<span class="ruby-identifier">head</span>] <span class="ruby-operator">:</span> [])
495:       <span class="ruby-identifier">author</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:author</span>] <span class="ruby-operator">||</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">author</span>
496:       <span class="ruby-identifier">authored_date</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:authored_date</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">now</span>
497:       <span class="ruby-identifier">committer</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:committer</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">author</span>
498:       <span class="ruby-identifier">committed_date</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:committed_date</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">now</span>
499: 
500:       <span class="ruby-comment cmt"># commit format:</span>
501:       <span class="ruby-comment cmt">#---------------------------------------------------</span>
502:       <span class="ruby-comment cmt">#   tree sha</span>
503:       <span class="ruby-comment cmt">#   parent sha</span>
504:       <span class="ruby-comment cmt">#   author name &lt;email&gt; time_as_int zone_offset</span>
505:       <span class="ruby-comment cmt">#   committer name &lt;email&gt; time_as_int zone_offset</span>
506:       <span class="ruby-comment cmt">#   </span>
507:       <span class="ruby-comment cmt">#   messsage</span>
508:       <span class="ruby-comment cmt">#   </span>
509:       <span class="ruby-comment cmt">#---------------------------------------------------</span>
510:       <span class="ruby-comment cmt"># Note there is a trailing newline after the message.</span>
511:       <span class="ruby-comment cmt">#</span>
512:       <span class="ruby-identifier">lines</span> = []
513:       <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;tree #{sha}&quot;</span>
514:       <span class="ruby-identifier">parents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parent</span><span class="ruby-operator">|</span>
515:         <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;parent #{parent}&quot;</span>
516:       <span class="ruby-keyword kw">end</span>
517:       <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;author #{author.name} &lt;#{author.email}&gt; #{authored_date.strftime(&quot;%s %z&quot;)}&quot;</span>
518:       <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;committer #{committer.name} &lt;#{committer.email}&gt; #{committed_date.strftime(&quot;%s %z&quot;)}&quot;</span>
519:       <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&quot;</span>
520:       <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">message</span>
521:       <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&quot;</span>
522:       
523:       <span class="ruby-ivar">@head</span> = <span class="ruby-identifier">set</span>(<span class="ruby-value str">'commit'</span>, <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>))
524:       <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">update_ref</span>(<span class="ruby-identifier">branch</span>, <span class="ruby-identifier">head</span>)
525:       
526:       <span class="ruby-identifier">head</span>
527:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000234" class="method-detail">
        <a name="M000234"></a>

        <div class="method-heading">
          <a href="#M000234" class="method-signature">
          <span class="method-name">commit_grep</span><span class="method-args">(pattern, treeish=head) {|commit| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Greps for commits with messages matching the pattern, starting at the
specified treeish. Each matching <a href="Git.html#M000216">commit</a>
yielded to the block.
</p>
<p>
Instead of a pattern, a hash of git-log options may be provided.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000234-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000234-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 826</span>
826:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">commit_grep</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">treeish</span>=<span class="ruby-identifier">head</span>) <span class="ruby-comment cmt"># :yields: commit</span>
827:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:merge</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> {<span class="ruby-identifier">:grep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pattern</span>}
828:       <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">nil_or_empty?</span>(<span class="ruby-identifier">value</span>) }
829:       <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:format</span>] = <span class="ruby-value str">&quot;%H&quot;</span>
830:       
831:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
832:         <span class="ruby-identifier">git</span>.<span class="ruby-identifier">log</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">treeish</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sha</span><span class="ruby-operator">|</span>
833:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">commit</span>(<span class="ruby-identifier">sha</span>)
834:         <span class="ruby-keyword kw">end</span>
835:       <span class="ruby-keyword kw">end</span>
836:       <span class="ruby-keyword kw">self</span>
837:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000199" class="method-detail">
        <a name="M000199"></a>

        <div class="method-heading">
          <a href="#M000199" class="method-signature">
          <span class="method-name">default_blob_mode=</span><span class="method-args">(mode)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the default blob mode
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000199-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000199-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 270</span>
270:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_blob_mode=</span>(<span class="ruby-identifier">mode</span>)
271:       <span class="ruby-ivar">@default_blob_mode</span> = <span class="ruby-identifier">mode</span>.<span class="ruby-identifier">to_sym</span>
272:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000200" class="method-detail">
        <a name="M000200"></a>

        <div class="method-heading">
          <a href="#M000200" class="method-signature">
          <span class="method-name">default_tree_mode=</span><span class="method-args">(mode)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the default tree mode
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000200-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000200-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 275</span>
275:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_tree_mode=</span>(<span class="ruby-identifier">mode</span>)
276:       <span class="ruby-ivar">@default_tree_mode</span> = <span class="ruby-identifier">mode</span>.<span class="ruby-identifier">to_sym</span>
277:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000230" class="method-detail">
        <a name="M000230"></a>

        <div class="method-heading">
          <a href="#M000230" class="method-signature">
          <span class="method-name">diff_tree</span><span class="method-args">(a, b=&quot;^</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Retuns an array of added, deleted, and modified files keyed by
&#8216;A&#8217;, &#8216;D&#8217;, and &#8216;M&#8217; respectively.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000230-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000230-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 734</span>
734:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">diff_tree</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>=<span class="ruby-node">&quot;^#{a}&quot;</span>)
735:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
736:         <span class="ruby-identifier">output</span> = <span class="ruby-identifier">git</span>.<span class="ruby-identifier">run</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">:diff_tree</span>, <span class="ruby-value str">''</span>, {<span class="ruby-identifier">:r</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:name_status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}, [<span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>])
737:         
738:         <span class="ruby-identifier">diff</span> = {<span class="ruby-value str">'A'</span> =<span class="ruby-operator">&gt;</span> [], <span class="ruby-value str">'D'</span> =<span class="ruby-operator">&gt;</span> [], <span class="ruby-value str">'M'</span> =<span class="ruby-operator">&gt;</span> []}
739:         <span class="ruby-identifier">output</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
740:           <span class="ruby-identifier">mode</span>, <span class="ruby-identifier">path</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">' '</span>, <span class="ruby-value">2</span>)
741:           <span class="ruby-identifier">array</span> = <span class="ruby-identifier">diff</span>[<span class="ruby-identifier">mode</span>] <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;unexpected diff output:\n#{output}&quot;</span>
742:           <span class="ruby-identifier">array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">path</span>
743:         <span class="ruby-keyword kw">end</span>
744: 
745:         <span class="ruby-identifier">diff</span>
746:       <span class="ruby-keyword kw">end</span>
747:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000221" class="method-detail">
        <a name="M000221"></a>

        <div class="method-heading">
          <a href="#M000221" class="method-signature">
          <span class="method-name">fetch</span><span class="method-args">(remote=self.remote)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Fetches from the <a href="Git.html#M000212">remote</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000221-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000221-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 595</span>
595:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">remote</span>=<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">remote</span>)
596:       <span class="ruby-identifier">sandbox</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">git</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">git</span>.<span class="ruby-identifier">fetch</span>({}, <span class="ruby-identifier">remote</span>) }
597:       <span class="ruby-keyword kw">self</span>
598:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000237" class="method-detail">
        <a name="M000237"></a>

        <div class="method-heading">
          <a href="#M000237" class="method-signature">
          <span class="method-name">fsck</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Performs &#8216;git <a href="Git.html#M000237">fsck</a>&#8217; and returns
the output.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000237-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000237-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 853</span>
853:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fsck</span>
854:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
855:         <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span> = <span class="ruby-identifier">git</span>.<span class="ruby-identifier">sh</span>(<span class="ruby-node">&quot;#{Grit::Git.git_binary} fsck&quot;</span>)
856:         <span class="ruby-node">&quot;#{stdout}#{stderr}&quot;</span>
857:       <span class="ruby-keyword kw">end</span>
858:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000236" class="method-detail">
        <a name="M000236"></a>

        <div class="method-heading">
          <a href="#M000236" class="method-signature">
          <span class="method-name">gc</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Performs &#8216;git <a href="Git.html#M000236">gc</a>&#8217; and resets
self so that grit will use the updated pack files. Returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000236-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000236-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 847</span>
847:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">gc</span>
848:       <span class="ruby-identifier">sandbox</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">git</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">git</span>.<span class="ruby-identifier">gc</span> }
849:       <span class="ruby-identifier">reset</span>(<span class="ruby-keyword kw">true</span>)
850:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000206" class="method-detail">
        <a name="M000206"></a>

        <div class="method-heading">
          <a href="#M000206" class="method-signature">
          <span class="method-name">get</span><span class="method-args">(type, id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Gets the specified object, returning an instance of the appropriate Grit
class. Raises an error for unknown types.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000206-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000206-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 330</span>
330:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">id</span>)
331:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_sym</span>
332:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:blob</span>   <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">blob</span>(<span class="ruby-identifier">id</span>)
333:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:tree</span>   <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">tree</span>(<span class="ruby-identifier">id</span>)
334:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:commit</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">commit</span>(<span class="ruby-identifier">id</span>)
335:       <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">:tag</span>
336:         
337:         <span class="ruby-identifier">object</span> = <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">ruby_git</span>.<span class="ruby-identifier">get_object_by_sha1</span>(<span class="ruby-identifier">id</span>)
338:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">object</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:tag</span> 
339:           <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Tag</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">commit</span>(<span class="ruby-identifier">object</span>.<span class="ruby-identifier">object</span>))
340:         <span class="ruby-keyword kw">else</span>
341:           <span class="ruby-keyword kw">nil</span>
342:         <span class="ruby-keyword kw">end</span>
343:       
344:       <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;unknown type: #{type}&quot;</span>
345:       <span class="ruby-keyword kw">end</span>
346:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000232" class="method-detail">
        <a name="M000232"></a>

        <div class="method-heading">
          <a href="#M000232" class="method-signature">
          <span class="method-name">grep</span><span class="method-args">(pattern, treeish=head) {|path, blob| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Greps for paths matching the pattern, at the specified treeish. Each
matching <a href="Git.html#M000201">path</a> and blob are yielded to the
block.
</p>
<p>
Instead of a pattern, a hash of <a href="Git.html#M000232">grep</a> options
may be provided. The following options are allowed:
</p>
<pre>
  :ignore_case
  :invert_match
  :fixed_strings
  :e
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000232-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000232-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 767</span>
767:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">grep</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">treeish</span>=<span class="ruby-identifier">head</span>) <span class="ruby-comment cmt"># :yields: path, blob</span>
768:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:merge</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> {<span class="ruby-identifier">:e</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pattern</span>}
769:       <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">nil_or_empty?</span>(<span class="ruby-identifier">value</span>) }
770:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(
771:         <span class="ruby-identifier">:cached</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
772:         <span class="ruby-identifier">:name_only</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
773:         <span class="ruby-identifier">:full_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
774:       )
775:       
776:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">commit</span> = <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">commit</span>(<span class="ruby-identifier">treeish</span>)
777:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;unknown commit: #{treeish}&quot;</span>
778:       <span class="ruby-keyword kw">end</span>
779:       
780:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
781:         <span class="ruby-identifier">git</span>.<span class="ruby-identifier">read_tree</span>({<span class="ruby-identifier">:index_output</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">index_file</span>}, <span class="ruby-identifier">commit</span>.<span class="ruby-identifier">id</span>)
782:         <span class="ruby-identifier">git</span>.<span class="ruby-identifier">grep</span>(<span class="ruby-identifier">options</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
783:           <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">path</span>, (<span class="ruby-identifier">commit</span>.<span class="ruby-identifier">tree</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">path</span>))
784:         <span class="ruby-keyword kw">end</span>
785:       <span class="ruby-keyword kw">end</span>
786:       <span class="ruby-keyword kw">self</span>
787:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000231" class="method-detail">
        <a name="M000231"></a>

        <div class="method-heading">
          <a href="#M000231" class="method-signature">
          <span class="method-name">ls_tree</span><span class="method-args">(treeish)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of paths at the specified treeish.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000231-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000231-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 750</span>
750:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ls_tree</span>(<span class="ruby-identifier">treeish</span>)
751:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
752:         <span class="ruby-identifier">git</span>.<span class="ruby-identifier">run</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">:ls_tree</span>, <span class="ruby-value str">''</span>, {<span class="ruby-identifier">:r</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:name_only</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}, [<span class="ruby-identifier">treeish</span>]).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
753:       <span class="ruby-keyword kw">end</span>
754:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000223" class="method-detail">
        <a name="M000223"></a>

        <div class="method-heading">
          <a href="#M000223" class="method-signature">
          <span class="method-name">merge</span><span class="method-args">(treeish=upstream_branch)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Merges the specified reference with the current branch, fast-forwarding
when possible. This method does not need to <a
href="Git.html#M000220">checkout</a> the branch into a working directory to
perform the <a href="Git.html#M000223">merge</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000223-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000223-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 616</span>
616:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">treeish</span>=<span class="ruby-identifier">upstream_branch</span>)
617:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
618:         <span class="ruby-identifier">des</span>, <span class="ruby-identifier">src</span> = <span class="ruby-identifier">safe_rev_parse</span>(<span class="ruby-identifier">branch</span>, <span class="ruby-identifier">treeish</span>)
619:         <span class="ruby-identifier">base</span> = <span class="ruby-identifier">des</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">git</span>.<span class="ruby-identifier">merge_base</span>({}, <span class="ruby-identifier">des</span>, <span class="ruby-identifier">src</span>).<span class="ruby-identifier">chomp</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
620:         
621:         <span class="ruby-keyword kw">case</span>
622:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">base</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">src</span>
623:           <span class="ruby-keyword kw">break</span>
624:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">base</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">des</span>
625:           <span class="ruby-comment cmt"># fast forward situation</span>
626:           <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">update_ref</span>(<span class="ruby-identifier">branch</span>, <span class="ruby-identifier">src</span>)
627:         <span class="ruby-keyword kw">else</span>
628:           <span class="ruby-comment cmt"># todo: add rebase as an option</span>
629:           
630:           <span class="ruby-identifier">git</span>.<span class="ruby-identifier">read_tree</span>({
631:             <span class="ruby-identifier">:m</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,          <span class="ruby-comment cmt"># merge</span>
632:             <span class="ruby-identifier">:i</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,          <span class="ruby-comment cmt"># without a working tree</span>
633:             <span class="ruby-identifier">:trivial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,    <span class="ruby-comment cmt"># only merge if no file-level merges are required</span>
634:             <span class="ruby-identifier">:aggressive</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-comment cmt"># allow resolution of removes</span>
635:             <span class="ruby-identifier">:index_output</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">index_file</span>
636:           }, <span class="ruby-identifier">base</span>, <span class="ruby-identifier">branch</span>, <span class="ruby-identifier">src</span>)
637:           
638:           <span class="ruby-identifier">commit!</span>(<span class="ruby-node">&quot;gitgo merge of #{treeish} into #{branch}&quot;</span>, 
639:             <span class="ruby-identifier">:tree</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">git</span>.<span class="ruby-identifier">write_tree</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-value str">&quot;\n&quot;</span>),
640:             <span class="ruby-identifier">:parents</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">des</span>, <span class="ruby-identifier">src</span>]
641:           )
642:         <span class="ruby-keyword kw">end</span>
643:         
644:         <span class="ruby-identifier">reset</span>
645:       <span class="ruby-keyword kw">end</span>
646:       
647:       <span class="ruby-keyword kw">self</span>
648:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000222" class="method-detail">
        <a name="M000222"></a>

        <div class="method-heading">
          <a href="#M000222" class="method-signature">
          <span class="method-name">merge?</span><span class="method-args">(treeish=upstream_branch)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if a <a href="Git.html#M000223">merge</a> update is available
for branch.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000222-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000222-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 601</span>
601:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge?</span>(<span class="ruby-identifier">treeish</span>=<span class="ruby-identifier">upstream_branch</span>)
602:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
603:         <span class="ruby-identifier">des</span>, <span class="ruby-identifier">src</span> = <span class="ruby-identifier">safe_rev_parse</span>(<span class="ruby-identifier">branch</span>, <span class="ruby-identifier">treeish</span>)
604:         
605:         <span class="ruby-keyword kw">case</span>
606:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">src</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">then</span> <span class="ruby-keyword kw">false</span>
607:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">des</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword kw">then</span> <span class="ruby-keyword kw">true</span>
608:         <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">des</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">src</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">git</span>.<span class="ruby-identifier">merge_base</span>({}, <span class="ruby-identifier">des</span>, <span class="ruby-identifier">src</span>).<span class="ruby-identifier">chomp</span>(<span class="ruby-value str">&quot;\n&quot;</span>) <span class="ruby-operator">!=</span> <span class="ruby-identifier">src</span>
609:         <span class="ruby-keyword kw">end</span>
610:       <span class="ruby-keyword kw">end</span>
611:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000201" class="method-detail">
        <a name="M000201"></a>

        <div class="method-heading">
          <a href="#M000201" class="method-signature">
          <span class="method-name">path</span><span class="method-args">(*segments)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the specified <a href="Git.html#M000201">path</a> relative to the
git repository (ie the .git directory). With no arguments <a
href="Git.html#M000201">path</a> returns the repository <a
href="Git.html#M000201">path</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000201-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000201-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 281</span>
281:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">path</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">segments</span>)
282:       <span class="ruby-identifier">segments</span>.<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span> <span class="ruby-identifier">segment</span>.<span class="ruby-identifier">to_s</span> }
283:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">grit</span>.<span class="ruby-identifier">path</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">segments</span>)
284:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000235" class="method-detail">
        <a name="M000235"></a>

        <div class="method-heading">
          <a href="#M000235" class="method-signature">
          <span class="method-name">prune</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Peforms &#8216;git <a href="Git.html#M000235">prune</a>&#8217; and returns
self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000235-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000235-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 840</span>
840:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prune</span>
841:       <span class="ruby-identifier">sandbox</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">git</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">git</span>.<span class="ruby-identifier">prune</span> }
842:       <span class="ruby-keyword kw">self</span>
843:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000225" class="method-detail">
        <a name="M000225"></a>

        <div class="method-heading">
          <a href="#M000225" class="method-signature">
          <span class="method-name">pull</span><span class="method-args">(tracking_branch=upstream_branch)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Fetches the tracking branch and merges with branch. No other branches are
fetched. Raises an error if given a non-tracking branch (see the Tracking,
Push/Pull notes above).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000225-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000225-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 663</span>
663:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pull</span>(<span class="ruby-identifier">tracking_branch</span>=<span class="ruby-identifier">upstream_branch</span>)
664:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
665:         <span class="ruby-identifier">remote</span>, <span class="ruby-identifier">remote_branch</span> = <span class="ruby-identifier">parse_tracking_branch</span>(<span class="ruby-identifier">tracking_branch</span>)
666:         <span class="ruby-identifier">git</span>.<span class="ruby-identifier">fetch</span>({}, <span class="ruby-identifier">remote</span>, <span class="ruby-node">&quot;#{remote_branch}:remotes/#{tracking_branch}&quot;</span>)
667:         <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">tracking_branch</span>)
668:       <span class="ruby-keyword kw">end</span>
669:       <span class="ruby-identifier">reset</span>
670:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000224" class="method-detail">
        <a name="M000224"></a>

        <div class="method-heading">
          <a href="#M000224" class="method-signature">
          <span class="method-name">push</span><span class="method-args">(tracking_branch=upstream_branch)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Pushes branch to the tracking branch. No other branches are pushed. Raises
an error if given a non-tracking branch (see the Tracking, Push/Pull notes
above).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000224-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000224-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 653</span>
653:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">push</span>(<span class="ruby-identifier">tracking_branch</span>=<span class="ruby-identifier">upstream_branch</span>)
654:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
655:         <span class="ruby-identifier">remote</span>, <span class="ruby-identifier">remote_branch</span> = <span class="ruby-identifier">parse_tracking_branch</span>(<span class="ruby-identifier">tracking_branch</span>)
656:         <span class="ruby-identifier">git</span>.<span class="ruby-identifier">push</span>({}, <span class="ruby-identifier">remote</span>, <span class="ruby-node">&quot;#{branch}:#{remote_branch}&quot;</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">head</span>.<span class="ruby-identifier">nil?</span>
657:       <span class="ruby-keyword kw">end</span>
658:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000212" class="method-detail">
        <a name="M000212"></a>

        <div class="method-heading">
          <a href="#M000212" class="method-signature">
          <span class="method-name">remote</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Git.html#M000212">remote</a> as setup by <a
href="Git.html#M000210">track</a>, or origin if tracking has not been
setup.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000212-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000212-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 437</span>
437:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remote</span>
438:       <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">config</span>[<span class="ruby-node">&quot;branch.#{branch}.remote&quot;</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">'origin'</span>
439:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000218" class="method-detail">
        <a name="M000218"></a>

        <div class="method-heading">
          <a href="#M000218" class="method-signature">
          <span class="method-name">reset</span><span class="method-args">(full=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Resets the working tree. Also reinitializes grit if full is specified; this
can be useful after operations that change configurations or the cached
packs (see <a href="Git.html#M000236">gc</a>).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000218-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000218-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 532</span>
532:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset</span>(<span class="ruby-identifier">full</span>=<span class="ruby-keyword kw">false</span>)
533:       <span class="ruby-ivar">@grit</span> = <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Repo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">:is_bare</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">bare</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">full</span>
534:       <span class="ruby-identifier">commit</span> = <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">commits</span>(<span class="ruby-identifier">branch</span>, <span class="ruby-value">1</span>).<span class="ruby-identifier">first</span>
535:       <span class="ruby-ivar">@head</span> = <span class="ruby-identifier">commit</span> <span class="ruby-value">? </span><span class="ruby-identifier">commit</span>.<span class="ruby-identifier">sha</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
536:       <span class="ruby-ivar">@tree</span> = <span class="ruby-identifier">commit_tree</span>
537:       
538:       <span class="ruby-keyword kw">self</span>
539:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000204" class="method-detail">
        <a name="M000204"></a>

        <div class="method-heading">
          <a href="#M000204" class="method-signature">
          <span class="method-name">resolve</span><span class="method-args">(id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a full sha for the identifier, as determined by <a
href="Git.html#M000227">rev_parse</a>. All valid sha string are returned
immediately; there is no guarantee the sha will point to an object
currently in the repo.
</p>
<p>
Returns nil the identifier cannot be resolved to an sha.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000204-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000204-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 313</span>
313:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">id</span>)
314:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">id</span>
315:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">SHA</span>, <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">id</span>
316:       <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">rev_parse</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">first</span>
317:       <span class="ruby-keyword kw">end</span>
318:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000229" class="method-detail">
        <a name="M000229"></a>

        <div class="method-heading">
          <a href="#M000229" class="method-signature">
          <span class="method-name">rev_list</span><span class="method-args">(*treeishs)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of revisions (commits) reachable from the treeish.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000229-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000229-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 727</span>
727:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rev_list</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">treeishs</span>)
728:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">treeishs</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">treeishs</span>.<span class="ruby-identifier">empty?</span>
729:       <span class="ruby-identifier">sandbox</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">git</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">git</span>.<span class="ruby-identifier">run</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">:rev_list</span>, <span class="ruby-value str">''</span>, {}, <span class="ruby-identifier">treeishs</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>) }
730:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000227" class="method-detail">
        <a name="M000227"></a>

        <div class="method-heading">
          <a href="#M000227" class="method-signature">
          <span class="method-name">rev_parse</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of shas identified by the args (ex a sha, short-sha, or
treeish). Raises an error if not all args can be converted into a valid
sha.
</p>
<p>
Note there is no guarantee the resulting shas indicate objects in the
repository; not even &#8216;git rev-parse&#8217; will do that.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000227-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000227-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 701</span>
701:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rev_parse</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
702:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">args</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span>
703:       
704:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>,<span class="ruby-identifier">w</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
705:         <span class="ruby-identifier">shas</span> = <span class="ruby-identifier">git</span>.<span class="ruby-identifier">run</span>(<span class="ruby-value str">''</span>, <span class="ruby-identifier">:rev_parse</span>, <span class="ruby-value str">''</span>, {}, <span class="ruby-identifier">args</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
706:         
707:         <span class="ruby-comment cmt"># Grit::Git#run only makes stdout available, not stderr, and so this</span>
708:         <span class="ruby-comment cmt"># wonky check relies on the fact that git rev-parse will print the</span>
709:         <span class="ruby-comment cmt"># unresolved ref to stdout and quit if it can't succeed. That means</span>
710:         <span class="ruby-comment cmt"># the last printout will not look like a sha in the event of an error.</span>
711:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">shas</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">SHA</span>
712:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;could not resolve to a sha: #{shas.last}&quot;</span>
713:         <span class="ruby-keyword kw">end</span>
714:         
715:         <span class="ruby-identifier">shas</span>
716:       <span class="ruby-keyword kw">end</span>
717:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000215" class="method-detail">
        <a name="M000215"></a>

        <div class="method-heading">
          <a href="#M000215" class="method-signature">
          <span class="method-name">rm</span><span class="method-args">(*paths)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Removes the content at each of the specified paths
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000215-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000215-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 461</span>
461:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rm</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">paths</span>)
462:       <span class="ruby-identifier">paths</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">path</span>] = <span class="ruby-keyword kw">nil</span> }
463:       <span class="ruby-keyword kw">self</span>
464:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000228" class="method-detail">
        <a name="M000228"></a>

        <div class="method-heading">
          <a href="#M000228" class="method-signature">
          <span class="method-name">safe_rev_parse</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="Git.html#M000227">rev_parse</a> but always returns an
array. Arguments that cannot be converted to a valid sha will be
represented by nil. This method is slower than <a
href="Git.html#M000227">rev_parse</a> because it converts arguments one by
one
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000228-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000228-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 722</span>
722:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">safe_rev_parse</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
723:       <span class="ruby-identifier">args</span>.<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">rev_parse</span>(<span class="ruby-identifier">arg</span>).<span class="ruby-identifier">at</span>(<span class="ruby-value">0</span>) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span> }
724:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000239" class="method-detail">
        <a name="M000239"></a>

        <div class="method-heading">
          <a href="#M000239" class="method-signature">
          <span class="method-name">sandbox</span><span class="method-args">( {|git, work_tree, index_file| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates and sets a work tree and index file so that git will have an
environment it can work in. Specifically <a
href="Git.html#M000239">sandbox</a> creates an empty work_tree and
index_file, the sets these ENV variables:
</p>
<pre>
 GIT_DIR:: set to the repo path
 GIT_WORK_TREE:: work_tree,
 GIT_INDEX_FILE:: index_file
</pre>
<p>
Once these are <a href="Git.html#M000207">set</a>, <a
href="Git.html#M000239">sandbox</a> yields grit.git, the work_tree, and
index_file to the block. After the block returns, the work_tree and
index_file are removed. Nested calls to <a
href="Git.html#M000239">sandbox</a> will reuse the previous <a
href="Git.html#M000239">sandbox</a> and yield immediately to the block.
</p>
<p>
Note that no content is checked out into work_tree or index_file by this
method; that must be done as needed within the block.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000239-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000239-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 890</span>
890:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sandbox</span> <span class="ruby-comment cmt"># :yields: git, work_tree, index_file</span>
891:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sandbox</span>
892:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span>)
893:       <span class="ruby-keyword kw">end</span>
894:       
895:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_r</span>(<span class="ruby-identifier">work_tree</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">work_tree</span>)
896:       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">index_file</span>)  <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">index_file</span>)
897:       
898:       <span class="ruby-keyword kw">begin</span>
899:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span>(<span class="ruby-identifier">work_tree</span>)
900:         <span class="ruby-ivar">@sandbox</span> = <span class="ruby-keyword kw">true</span>
901:         
902:         <span class="ruby-identifier">with_env</span>(
903:           <span class="ruby-value str">'GIT_DIR'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">path</span>, 
904:           <span class="ruby-value str">'GIT_WORK_TREE'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">work_tree</span>,
905:           <span class="ruby-value str">'GIT_INDEX_FILE'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">index_file</span>
906:         ) <span class="ruby-keyword kw">do</span>
907:           
908:           <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span>)
909:         <span class="ruby-keyword kw">end</span>
910:       <span class="ruby-keyword kw">ensure</span>
911:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_r</span>(<span class="ruby-identifier">work_tree</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">work_tree</span>)
912:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">index_file</span>)  <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">index_file</span>)
913:         <span class="ruby-ivar">@sandbox</span> = <span class="ruby-keyword kw">false</span>
914:       <span class="ruby-keyword kw">end</span>
915:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000207" class="method-detail">
        <a name="M000207"></a>

        <div class="method-heading">
          <a href="#M000207" class="method-signature">
          <span class="method-name">set</span><span class="method-args">(type, content)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets an object of the specified <a href="Git.html#M000205">type</a> into
the git repository and returns the object sha.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000207-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000207-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 350</span>
350:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">content</span>)
351:       <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">put_raw_object</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>)
352:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000238" class="method-detail">
        <a name="M000238"></a>

        <div class="method-heading">
          <a href="#M000238" class="method-signature">
          <span class="method-name">stats</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a hash of repo statistics parsed from &#8216;git count-objects
&#8212;verbose&#8217;.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000238-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000238-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 862</span>
862:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">stats</span>
863:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
864:         <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span> = <span class="ruby-identifier">git</span>.<span class="ruby-identifier">sh</span>(<span class="ruby-node">&quot;#{Grit::Git.git_binary} count-objects --verbose&quot;</span>)
865:         <span class="ruby-identifier">stats</span> = <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">stdout</span>)
866:         
867:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">stats</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>)
868:           <span class="ruby-identifier">raise</span> <span class="ruby-identifier">stderr</span>
869:         <span class="ruby-keyword kw">end</span>
870:         
871:         <span class="ruby-identifier">stats</span>
872:       <span class="ruby-keyword kw">end</span>
873:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000219" class="method-detail">
        <a name="M000219"></a>

        <div class="method-heading">
          <a href="#M000219" class="method-signature">
          <span class="method-name">status</span><span class="method-args">(full=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a hash of (<a href="Git.html#M000201">path</a>, state) pairs
indicating paths that have been added or removed. States are add/rm/mod
only &#8212; renames, moves, and copies are not detected.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000219-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000219-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 544</span>
544:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">status</span>(<span class="ruby-identifier">full</span>=<span class="ruby-keyword kw">false</span>)
545:       <span class="ruby-identifier">a</span> = <span class="ruby-identifier">commit_tree</span>.<span class="ruby-identifier">flatten</span>
546:       <span class="ruby-identifier">b</span> = <span class="ruby-identifier">tree</span>.<span class="ruby-identifier">flatten</span>
547:       
548:       <span class="ruby-identifier">diff</span> = {}
549:       (<span class="ruby-identifier">a</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">b</span>.<span class="ruby-identifier">keys</span>).<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
550:         <span class="ruby-identifier">a_entry</span> = <span class="ruby-identifier">a</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">key</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">a</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
551:         <span class="ruby-identifier">b_entry</span> = <span class="ruby-identifier">b</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">key</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">b</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
552:         
553:         <span class="ruby-identifier">change</span> = <span class="ruby-keyword kw">case</span>
554:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">a_entry</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">b_entry</span>
555:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">a_entry</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">b_entry</span>
556:           <span class="ruby-identifier">:mod</span>
557:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">a_entry</span>
558:           <span class="ruby-identifier">:rm</span>
559:         <span class="ruby-keyword kw">when</span> <span class="ruby-identifier">b_entry</span>
560:           <span class="ruby-identifier">:add</span>
561:         <span class="ruby-keyword kw">end</span>
562:         
563:         <span class="ruby-identifier">diff</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">full</span> <span class="ruby-value">? </span>[<span class="ruby-identifier">change</span>, <span class="ruby-identifier">a_entry</span> <span class="ruby-operator">||</span> [], <span class="ruby-identifier">b_entry</span> <span class="ruby-operator">||</span> []] <span class="ruby-operator">:</span> <span class="ruby-identifier">change</span>
564:       <span class="ruby-keyword kw">end</span>
565:       <span class="ruby-identifier">diff</span>
566:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000210" class="method-detail">
        <a name="M000210"></a>

        <div class="method-heading">
          <a href="#M000210" class="method-signature">
          <span class="method-name">track</span><span class="method-args">(upstream_branch)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets branch to <a href="Git.html#M000210">track</a> the specified <a
href="Git.html#M000211">upstream_branch</a>. The <a
href="Git.html#M000211">upstream_branch</a> must be an existing tracking
branch; an error is raised if this requirement is not met (see the
Tracking, Push/Pull notes above).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000210-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000210-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 400</span>
400:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">track</span>(<span class="ruby-identifier">upstream_branch</span>)
401:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">upstream_branch</span>.<span class="ruby-identifier">nil?</span>
402:         <span class="ruby-comment cmt"># currently grit.config does not support unsetting (grit-2.0.0)</span>
403:         <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">config</span>({<span class="ruby-identifier">:unset</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}, <span class="ruby-node">&quot;branch.#{branch}.remote&quot;</span>)
404:         <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">config</span>({<span class="ruby-identifier">:unset</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}, <span class="ruby-node">&quot;branch.#{branch}.merge&quot;</span>)
405:       <span class="ruby-keyword kw">else</span>
406:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">tracking_branch?</span>(<span class="ruby-identifier">upstream_branch</span>)
407:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;the upstream branch is not a tracking branch: #{upstream_branch}&quot;</span>
408:         <span class="ruby-keyword kw">end</span>
409:         
410:         <span class="ruby-identifier">remote</span>, <span class="ruby-identifier">remote_branch</span> = <span class="ruby-identifier">upstream_branch</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>, <span class="ruby-value">2</span>)
411:         <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">config</span>[<span class="ruby-node">&quot;branch.#{branch}.remote&quot;</span>] = <span class="ruby-identifier">remote</span>
412:         <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">config</span>[<span class="ruby-node">&quot;branch.#{branch}.merge&quot;</span>] = <span class="ruby-node">&quot;refs/heads/#{remote_branch}&quot;</span>
413:       <span class="ruby-keyword kw">end</span>
414:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000213" class="method-detail">
        <a name="M000213"></a>

        <div class="method-heading">
          <a href="#M000213" class="method-signature">
          <span class="method-name">tracking_branch?</span><span class="method-args">(ref)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if the specified ref is a tracking branch, ie it is the name
of an existing <a href="Git.html#M000212">remote</a> ref.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000213-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000213-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 443</span>
443:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tracking_branch?</span>(<span class="ruby-identifier">ref</span>)
444:       <span class="ruby-identifier">ref</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">remotes</span>.<span class="ruby-identifier">find</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">remote</span><span class="ruby-operator">|</span> <span class="ruby-identifier">remote</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">ref</span> }
445:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000233" class="method-detail">
        <a name="M000233"></a>

        <div class="method-heading">
          <a href="#M000233" class="method-signature">
          <span class="method-name">tree_grep</span><span class="method-args">(pattern, treeish=head) {|path, tree| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Greps for trees matching the pattern, at the specified treeish. Each
matching <a href="Git.html#M000201">path</a> and tree are yielded to the
block.
</p>
<p>
Instead of a pattern, a hash of <a href="Git.html#M000232">grep</a> options
may be provided. The following options are allowed:
</p>
<pre>
  :ignore_case
  :invert_match
  :fixed_strings
  :e
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000233-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000233-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 800</span>
800:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tree_grep</span>(<span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">treeish</span>=<span class="ruby-identifier">head</span>) <span class="ruby-comment cmt"># :yields: path, tree</span>
801:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:merge</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">pattern</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> {<span class="ruby-identifier">:e</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pattern</span>}
802:       <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">nil_or_empty?</span>(<span class="ruby-identifier">value</span>) }
803:       
804:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">commit</span> = <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">commit</span>(<span class="ruby-identifier">treeish</span>)
805:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;unknown commit: #{treeish}&quot;</span>
806:       <span class="ruby-keyword kw">end</span>
807:       
808:       <span class="ruby-identifier">sandbox</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">git</span>, <span class="ruby-identifier">work_tree</span>, <span class="ruby-identifier">index_file</span><span class="ruby-operator">|</span>
809:         <span class="ruby-identifier">postfix</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-value str">''</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">begin</span>
810:           <span class="ruby-identifier">grep_options</span> = <span class="ruby-identifier">git</span>.<span class="ruby-identifier">transform_options</span>(<span class="ruby-identifier">options</span>)
811:           <span class="ruby-node">&quot; | grep #{grep_options.join(' ')}&quot;</span>
812:         <span class="ruby-keyword kw">end</span>
813:         
814:         <span class="ruby-identifier">stdout</span>, <span class="ruby-identifier">stderr</span> = <span class="ruby-identifier">git</span>.<span class="ruby-identifier">sh</span>(<span class="ruby-node">&quot;#{Grit::Git.git_binary} ls-tree -r --name-only #{git.e(commit.id)} #{postfix}&quot;</span>)
815:         <span class="ruby-identifier">stdout</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span>
816:           <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">commit</span>.<span class="ruby-identifier">tree</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">path</span>)
817:         <span class="ruby-keyword kw">end</span>
818:       <span class="ruby-keyword kw">end</span>
819:       <span class="ruby-keyword kw">self</span>
820:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000205" class="method-detail">
        <a name="M000205"></a>

        <div class="method-heading">
          <a href="#M000205" class="method-signature">
          <span class="method-name">type</span><span class="method-args">(sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Git.html#M000205">type</a> of the object identified by
sha; the output of:
</p>
<pre>
   % git cat-file -t sha
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000205-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000205-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 324</span>
324:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">type</span>(<span class="ruby-identifier">sha</span>)
325:       <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">cat_file</span>({<span class="ruby-identifier">:t</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}, <span class="ruby-identifier">sha</span>)
326:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000211" class="method-detail">
        <a name="M000211"></a>

        <div class="method-heading">
          <a href="#M000211" class="method-signature">
          <span class="method-name">upstream_branch</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Git.html#M000211">upstream_branch</a> as setup by <a
href="Git.html#M000210">track</a>. Raises an error if the
&#8216;branch.name.<a href="Git.html#M000223">merge</a>&#8217; config
doesn&#8216;t follow the pattern &#8216;ref/heads/branch&#8217; (see the
Tracking, Push/Pull notes above).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000211-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000211-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/git.rb, line 419</span>
419:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">upstream_branch</span>
420:       <span class="ruby-identifier">remote</span> = <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">config</span>[<span class="ruby-node">&quot;branch.#{branch}.remote&quot;</span>]
421:       <span class="ruby-identifier">merge</span>  = <span class="ruby-identifier">grit</span>.<span class="ruby-identifier">config</span>[<span class="ruby-node">&quot;branch.#{branch}.merge&quot;</span>]
422:       
423:       <span class="ruby-comment cmt"># No remote, no merge, no tracking.</span>
424:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">remote</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">merge</span>.<span class="ruby-identifier">nil?</span>
425:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
426:       <span class="ruby-keyword kw">end</span>
427:       
428:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">merge</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^refs\/heads\/(.*)$/</span>
429:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;invalid upstream branch&quot;</span>
430:       <span class="ruby-keyword kw">end</span>
431:       
432:       <span class="ruby-node">&quot;#{remote}/#{$1}&quot;</span>
433:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>