<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Gitgo::Repo::Graph</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Gitgo::Repo::Graph</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/gitgo/repo/graph_rb.html">
                lib/gitgo/repo/graph.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="Graph.html">Graph</a> performs the important and somewhat
complicated task of deconvoluting document graphs. <a
href="Graph.html">Graph</a> and <a href="Node.html">Node</a> use signifant
amounts of caching to make sure traversal of the document graph is as quick
as possible. Graphs must be <a href="Graph.html#M000192">reset</a> to
detect any associations added after initialization.
</p>
<p>
See <a href="../Repo.html">Gitgo::Repo</a> for terminology used in this
documentation.
</p>
<h2>Deconvolution</h2>
<p>
Deconvolution involves replacing <a href="Graph.html#M000190">each</a> <a
href="Graph.html#M000186">node</a> in a DAG with the current versions of
that <a href="Graph.html#M000186">node</a>, and specifically reassigning
parent and children <a href="Graph.html#M000187">links</a> from updated
nodes to their current versions.
</p>
<pre>
         a                              a
         |                              |
         b -&gt; b1                        b1--+
         |    |                         |   |
         c    |             becomes     c   |
              |                             |
              d                             d
</pre>
<p>
When multiple current versions exist for a <a
href="Graph.html#M000186">node</a>, a <a href="Graph.html#M000183">new</a>
fork in the graph is introduced:
</p>
<pre>
         a                              a
         |                              |--+
         b -&gt; [b1, b2]                  b1 |
         |                              |  |
         c                 becomes      |  b2
                                        |  |
                                        c--+
</pre>
<p>
These forks can happen anywhere (including the graph head), as can updates
that merge multiple revisions:
</p>
<pre>
         a                              a
         |                              |
         b -&gt; [b1, b2] -&gt; b3            b3
         |                              |
         c                 becomes      c
</pre>
<p>
Linkages for the convoluted graph is not directly available from <a
href="Graph.html">Graph</a>, although all nodes are (via nodes).
</p>
<h2>Notes</h2>
<p>
The possibility of multiple current versions is perhaps non-intuitive, but
entirely possible if user A modifies a document while separately user B
modifies the same document in a different way. When these changes are
merged, you end up with multiple current versions.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000185">[]</a>&nbsp;&nbsp;
      <a href="#M000191">draw</a>&nbsp;&nbsp;
      <a href="#M000190">each</a>&nbsp;&nbsp;
      <a href="#M000184">empty?</a>&nbsp;&nbsp;
      <a href="#M000193">inspect</a>&nbsp;&nbsp;
      <a href="#M000187">links</a>&nbsp;&nbsp;
      <a href="#M000183">new</a>&nbsp;&nbsp;
      <a href="#M000186">node</a>&nbsp;&nbsp;
      <a href="#M000192">reset</a>&nbsp;&nbsp;
      <a href="#M000189">sort</a>&nbsp;&nbsp;
      <a href="#M000188">tails</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name">Enumerable</span>
      </div>
    </div>

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">head</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The graph head

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">nodes</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A hash of (sha, <a href="Graph.html#M000186">node</a>) pairs identifying
all accessible nodes

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">repo</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A back-reference to the repo where the documents are stored

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000183" class="method-detail">
        <a name="M000183"></a>

        <div class="method-heading">
          <a href="#M000183" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(repo, head)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a <a href="Graph.html#M000183">new</a> <a
href="Graph.html">Graph</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000183-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000183-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 70</span>
70:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">repo</span>, <span class="ruby-identifier">head</span>)
71:         <span class="ruby-ivar">@repo</span> = <span class="ruby-identifier">repo</span>
72:         <span class="ruby-ivar">@head</span> = <span class="ruby-identifier">head</span>
73:         <span class="ruby-identifier">reset</span>
74:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000185" class="method-detail">
        <a name="M000185"></a>

        <div class="method-heading">
          <a href="#M000185" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="Graph.html#M000186">node</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000185-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000185-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 83</span>
83:       <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">sha</span>)
84:         <span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">sha</span>]
85:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000191" class="method-detail">
        <a name="M000191"></a>

        <div class="method-heading">
          <a href="#M000191" class="method-signature">
          <span class="method-name">draw</span><span class="method-args">(indent=0)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Draws the graph
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000191-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000191-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 192</span>
192:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">draw</span>(<span class="ruby-identifier">indent</span>=<span class="ruby-value">0</span>)
193:         <span class="ruby-identifier">lines</span> = []
194:         <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">slot</span>, <span class="ruby-identifier">index</span>, <span class="ruby-identifier">current_slots</span>, <span class="ruby-identifier">transitions</span>)<span class="ruby-operator">|</span>
195:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sha</span>.<span class="ruby-identifier">nil?</span>
196:           
197:           <span class="ruby-identifier">line</span> = []
198:           <span class="ruby-identifier">transition</span> = []
199:           
200:           <span class="ruby-identifier">transitions</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">target</span><span class="ruby-operator">|</span>
201:             <span class="ruby-identifier">tstart</span> = (<span class="ruby-identifier">slot</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">indent</span>
202:             <span class="ruby-identifier">tend</span> = (<span class="ruby-identifier">target</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">indent</span>
203:             
204:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tstart</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tend</span>
205:               <span class="ruby-identifier">tstart</span>, <span class="ruby-identifier">tend</span> = <span class="ruby-identifier">tend</span>, <span class="ruby-identifier">tstart</span>
206:             <span class="ruby-keyword kw">end</span>
207:             
208:             <span class="ruby-identifier">tstart</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">tend</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">transition</span>[<span class="ruby-identifier">i</span>] = <span class="ruby-value str">'-'</span>}
209:             <span class="ruby-identifier">transition</span>[<span class="ruby-identifier">tstart</span>] = <span class="ruby-value str">'+'</span>
210:             <span class="ruby-identifier">transition</span>[<span class="ruby-identifier">tend</span>] = <span class="ruby-value str">'+'</span>
211:           <span class="ruby-keyword kw">end</span>
212:           
213:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">transitions</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">slot</span>)
214:             <span class="ruby-identifier">transition</span>[(<span class="ruby-identifier">slot</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">indent</span>] = <span class="ruby-value str">'|'</span>
215:           <span class="ruby-keyword kw">end</span>
216:           
217:           <span class="ruby-identifier">current_slots</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cs</span><span class="ruby-operator">|</span>
218:             <span class="ruby-identifier">line</span>[(<span class="ruby-identifier">cs</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">indent</span>] = <span class="ruby-value str">'|'</span>
219:             <span class="ruby-identifier">transition</span>[(<span class="ruby-identifier">cs</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">indent</span>] = <span class="ruby-value str">'|'</span>
220:           <span class="ruby-keyword kw">end</span>
221:           
222:           <span class="ruby-identifier">line</span>[(<span class="ruby-identifier">slot</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">indent</span>] = <span class="ruby-value str">'*'</span>
223:           
224:           <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>.<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-value str">' '</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">obj</span> }.<span class="ruby-identifier">join</span>
225:           <span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">transition</span>.<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-value str">' '</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">obj</span> }.<span class="ruby-identifier">join</span>
226:         <span class="ruby-keyword kw">end</span>
227:         
228:         <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)
229:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000190" class="method-detail">
        <a name="M000190"></a>

        <div class="method-heading">
          <a href="#M000190" class="method-signature">
          <span class="method-name">each</span><span class="method-args">(head=nil) {|sha, slot, index, current_slots, transitions| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Yields <a href="Graph.html#M000190">each</a> <a
href="Graph.html#M000186">node</a> in the deconvoluted graph to the block
with coordinates for rendering linkages between the nodes. The nodes are
ordered from head to <a href="Graph.html#M000188">tails</a> and respect the
order of children.
</p>
<p>
Each <a href="Graph.html#M000186">node</a> is assigned a slot (x), and at
<a href="Graph.html#M000190">each</a> iteration (y), there is information
regarding which slots are currently open, and which slots need to be linked
to produce the graph. For example, a simple fork-merge could be graphed
like this:
</p>
<pre>
  Graph    node  x  y  current transistions
  *        :a    0  0  []      [0,1]
  |--+
  *  |     :b    0  1  [1]     [0]
  |  |
  |  *     :c    1  2  [0]     [0]
  |--+
  *        :d    0  3  []      []
</pre>
<p>
Where the coordinates are the arguments yielded to the block:
</p>
<pre>
  sha::   the sha for the node
  slot::  the slot where the node belongs (x-axis)
  index:: a counter for the number of nodes yielded (y-axis)
  current_slots:: slots currently open (|)
  transitions:: the slots that this node should connect to (|,--+)
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000190-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000190-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 154</span>
154:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>(<span class="ruby-identifier">head</span>=<span class="ruby-keyword kw">nil</span>) <span class="ruby-comment cmt"># :yields: sha, slot, index, current_slots, transitions</span>
155:         <span class="ruby-identifier">slots</span> = []
156:         <span class="ruby-identifier">slot</span> = {<span class="ruby-identifier">head</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>}
157:         
158:         <span class="ruby-comment cmt"># visit walks each branch in the DAG and collects the visited nodes</span>
159:         <span class="ruby-comment cmt"># in reverse; that way uniq + reverse_each will iterate the nodes in</span>
160:         <span class="ruby-comment cmt"># order, with merges pushed down as far as necessary</span>
161:         <span class="ruby-identifier">order</span> = <span class="ruby-identifier">visit</span>(<span class="ruby-identifier">links</span>, <span class="ruby-identifier">head</span>)
162:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">uniq!</span>
163:         
164:         <span class="ruby-identifier">index</span> = <span class="ruby-value">0</span>
165:         <span class="ruby-identifier">order</span>.<span class="ruby-identifier">reverse_each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sha</span><span class="ruby-operator">|</span>
166:           <span class="ruby-identifier">children</span> = <span class="ruby-identifier">links</span>[<span class="ruby-identifier">sha</span>]
167:           <span class="ruby-identifier">parent_slot</span>  = <span class="ruby-identifier">slot</span>[<span class="ruby-identifier">sha</span>]
168:           
169:           <span class="ruby-comment cmt"># free the parent slot if possible - if no children exist then the</span>
170:           <span class="ruby-comment cmt"># sha is an open tail; keep these slots occupied</span>
171:           <span class="ruby-identifier">slots</span>[<span class="ruby-identifier">parent_slot</span>] = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">children</span>.<span class="ruby-identifier">empty?</span>
172:           
173:           <span class="ruby-comment cmt"># determine currently occupied slots - any slots with a non-nil,</span>
174:           <span class="ruby-comment cmt"># non-false value; in this case a number</span>
175:           <span class="ruby-identifier">current_slots</span> = <span class="ruby-identifier">slots</span>.<span class="ruby-identifier">select</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">s</span> }
176:           
177:           <span class="ruby-identifier">transitions</span> = <span class="ruby-identifier">children</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">child</span><span class="ruby-operator">|</span>
178:             <span class="ruby-comment cmt"># determine the next open (ie nil) slot for the child and occupy</span>
179:             <span class="ruby-identifier">child_slot</span> = <span class="ruby-identifier">slot</span>[<span class="ruby-identifier">child</span>] <span class="ruby-operator">||=</span> (<span class="ruby-identifier">slots</span>.<span class="ruby-identifier">index</span>(<span class="ruby-keyword kw">nil</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">slots</span>.<span class="ruby-identifier">length</span>)
180:             <span class="ruby-identifier">slots</span>[<span class="ruby-identifier">child_slot</span>] = <span class="ruby-identifier">child_slot</span>
181:             <span class="ruby-identifier">child_slot</span>
182:           <span class="ruby-keyword kw">end</span>
183:           
184:           <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">slot</span>[<span class="ruby-identifier">sha</span>], <span class="ruby-identifier">index</span>, <span class="ruby-identifier">current_slots</span>, <span class="ruby-identifier">transitions</span>)
185:           <span class="ruby-identifier">index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
186:         <span class="ruby-keyword kw">end</span>
187:         
188:         <span class="ruby-keyword kw">self</span>
189:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000184" class="method-detail">
        <a name="M000184"></a>

        <div class="method-heading">
          <a href="#M000184" class="method-signature">
          <span class="method-name">empty?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if head is nil (implying that no meaningful nodes can be
reached from this graph).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000184-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000184-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 78</span>
78:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>
79:         <span class="ruby-identifier">head</span>.<span class="ruby-identifier">nil?</span>
80:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000193" class="method-detail">
        <a name="M000193"></a>

        <div class="method-heading">
          <a href="#M000193" class="method-signature">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a string like:
</p>
<pre>
  #&lt;Gitgo::Repo::Graph:object_id head=&quot;sha&quot;&gt;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000193-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000193-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 262</span>
262:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
263:         <span class="ruby-node">&quot;#&lt;#{self.class}:#{object_id} head=#{head.inspect}&gt;&quot;</span>
264:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000187" class="method-detail">
        <a name="M000187"></a>

        <div class="method-heading">
          <a href="#M000187" class="method-signature">
          <span class="method-name">links</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a hash of (<a href="Graph.html#M000186">node</a>, children) pairs
mapping linkages in the deconvoluted graph. Links does not contain updated
or deleted nodes and typically serves as the basis for drawing graphs.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000187-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000187-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 96</span>
 96:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">links</span>
 97:         <span class="ruby-ivar">@links</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">begin</span>
 98:           <span class="ruby-identifier">links</span> = {}
 99:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">head</span>.<span class="ruby-identifier">nil?</span>
100:             <span class="ruby-identifier">versions</span> = <span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">head</span>].<span class="ruby-identifier">original</span>].<span class="ruby-identifier">versions</span>
101:             <span class="ruby-identifier">versions</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">sha</span><span class="ruby-operator">|</span> <span class="ruby-identifier">collect_links</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">links</span>) }
102:             
103:             <span class="ruby-identifier">links</span>[<span class="ruby-keyword kw">nil</span>] = <span class="ruby-identifier">versions</span>
104:           <span class="ruby-keyword kw">end</span>
105:           <span class="ruby-identifier">links</span>
106:         <span class="ruby-keyword kw">end</span>
107:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000186" class="method-detail">
        <a name="M000186"></a>

        <div class="method-heading">
          <a href="#M000186" class="method-signature">
          <span class="method-name">node</span><span class="method-args">(sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Retrieves the <a href="Graph.html#M000186">node</a> for the sha, or nil if
the <a href="Graph.html#M000186">node</a> is inaccessible from this
document graph.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000186-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000186-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 89</span>
89:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">node</span>(<span class="ruby-identifier">sha</span>)
90:         <span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">sha</span>]
91:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000192" class="method-detail">
        <a name="M000192"></a>

        <div class="method-heading">
          <a href="#M000192" class="method-signature">
          <span class="method-name">reset</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Resets the graph, recollecting all nodes and <a
href="Graph.html#M000187">links</a>. Reset is required detect <a
href="Graph.html#M000183">new</a> nodes inserted after initialization.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000192-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000192-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 244</span>
244:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset</span>
245:         <span class="ruby-ivar">@nodes</span> = {}
246:         <span class="ruby-identifier">collect_nodes</span>(<span class="ruby-identifier">head</span>)
247:         
248:         <span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span><span class="ruby-operator">|</span>
249:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">node</span>.<span class="ruby-identifier">original?</span>
250:             <span class="ruby-identifier">node</span>.<span class="ruby-identifier">deconvolute</span>
251:           <span class="ruby-keyword kw">end</span>
252:         <span class="ruby-keyword kw">end</span>
253:         
254:         <span class="ruby-ivar">@links</span> = <span class="ruby-keyword kw">nil</span>
255:         <span class="ruby-keyword kw">self</span>
256:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000189" class="method-detail">
        <a name="M000189"></a>

        <div class="method-heading">
          <a href="#M000189" class="method-signature">
          <span class="method-name">sort</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sorts <a href="Graph.html#M000190">each</a> of the children in <a
href="Graph.html#M000187">links</a>, using the block if given.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000189-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000189-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 121</span>
121:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sort</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
122:         <span class="ruby-identifier">links</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">children</span><span class="ruby-operator">|</span>
123:           <span class="ruby-identifier">children</span>.<span class="ruby-identifier">sort!</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
124:         <span class="ruby-keyword kw">end</span>
125:         <span class="ruby-keyword kw">self</span>
126:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000188" class="method-detail">
        <a name="M000188"></a>

        <div class="method-heading">
          <a href="#M000188" class="method-signature">
          <span class="method-name">tails</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array the tail nodes in the deconvoluted graph.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000188-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000188-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/repo/graph.rb, line 110</span>
110:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tails</span>
111:         <span class="ruby-ivar">@tails</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">begin</span>
112:           <span class="ruby-identifier">tails</span> = []
113:           <span class="ruby-identifier">links</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span>, <span class="ruby-identifier">children</span><span class="ruby-operator">|</span>
114:             <span class="ruby-identifier">tails</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">node</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">children</span>.<span class="ruby-identifier">empty?</span>
115:           <span class="ruby-keyword kw">end</span>
116:           <span class="ruby-identifier">tails</span>
117:         <span class="ruby-keyword kw">end</span>
118:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>