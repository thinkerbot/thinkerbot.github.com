<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Gitgo::Document</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Gitgo::Document</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/gitgo/document_rb.html">
                lib/gitgo/document.rb
                </a>
        <br />
                <a href="../../files/lib/gitgo/document/invalid_document_error_rb.html">
                lib/gitgo/document/invalid_document_error.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="Document.html">Document</a> represents the data model of <a
href="../Gitgo.html">Gitgo</a>, and provides high(er)-level access to
documents stored in a <a href="Repo.html">Repo</a>. Content and data
consistency constraints are enforced on <a
href="Document.html">Document</a> and not on <a href="Repo.html">Repo</a>.
As such, <a href="Document.html">Document</a> should be the only way casual
users enter data into a <a href="Repo.html">Repo</a>.
</p>
<h2>Usage</h2>
<p>
For the most part <a href="Document.html">Document</a> behaves like a
standard ORM model. The primary gotcha revolves around setting documents
into the git repository and exists to prevent the creation of unnecessary
git objects.
</p>
<p>
Unlike you would expect, two method calls are required to store a document:
</p>
<pre>
  a = Document.new(:content =&gt; 'a')
  a.save
  a.create
</pre>
<p>
The <a href="Document.html#M000311">save</a> method sets the document data
into the git <a href="Document.html#M000309">repo</a> as a blob and records
the blob sha as a unique identifier for the document. The <a
href="Document.html#M000312">create</a> method is what indicates the
document is the head of a <a href="Document.html#M000324">new</a> document
<a href="Document.html#M000330">graph</a>. Simply calling <a
href="Document.html#M000311">save</a> is not enough (indeed the result of
<a href="Document.html#M000311">save</a> is a hanging blob that can be
gc&#8216;d by git).
</p>
<p>
The <a href="Document.html#M000354">link</a> and <a
href="Document.html#M000316">update</a> methods are used instead of <a
href="Document.html#M000312">create</a> to associate <a
href="Document.html#M000324">new</a> documents into an existing <a
href="Document.html#M000330">graph</a>. For example:
</p>
<pre>
  b = Document.new(:content =&gt; 'b')
  b.save
  a.link(b)
</pre>
<p>
Calling <a href="Document.html#M000312">create</a> prevents a document from
being linked into another <a href="Document.html#M000330">graph</a> and
vice-versa; the intent is that a given document only belongs to one
document <a href="Document.html#M000330">graph</a>. This constraint is only
enforced at the <a href="Document.html">Document</a> level and represents
the main reason why using <a href="Document.html#M000309">repo</a> directy
is a no-no.
</p>
<p>
Additionally, as in the command-line git workflow, newly added documents
are not actually committed to a <a href="Document.html#M000309">repo</a>
until commit is called.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000362">==</a>&nbsp;&nbsp;
      <a href="#M000314">[]</a>&nbsp;&nbsp;
      <a href="#M000332">[]</a>&nbsp;&nbsp;
      <a href="#M000333">[]=</a>&nbsp;&nbsp;
      <a href="#M000338">active?</a>&nbsp;&nbsp;
      <a href="#M000363">arrayify</a>&nbsp;&nbsp;
      <a href="#M000335">author</a>&nbsp;&nbsp;
      <a href="#M000334">author=</a>&nbsp;&nbsp;
      <a href="#M000320">basis</a>&nbsp;&nbsp;
      <a href="#M000364">blank?</a>&nbsp;&nbsp;
      <a href="#M000315">cast</a>&nbsp;&nbsp;
      <a href="#M000359">commit!</a>&nbsp;&nbsp;
      <a href="#M000312">create</a>&nbsp;&nbsp;
      <a href="#M000351">create</a>&nbsp;&nbsp;
      <a href="#M000337">date</a>&nbsp;&nbsp;
      <a href="#M000336">date=</a>&nbsp;&nbsp;
      <a href="#M000322">define_attributes</a>&nbsp;&nbsp;
      <a href="#M000356">delete</a>&nbsp;&nbsp;
      <a href="#M000318">delete</a>&nbsp;&nbsp;
      <a href="#M000348">each_index</a>&nbsp;&nbsp;
      <a href="#M000345">errors</a>&nbsp;&nbsp;
      <a href="#M000317">find</a>&nbsp;&nbsp;
      <a href="#M000330">graph</a>&nbsp;&nbsp;
      <a href="#M000329">graph_head</a>&nbsp;&nbsp;
      <a href="#M000328">graph_head?</a>&nbsp;&nbsp;
      <a href="#M000327">graph_head_idx</a>&nbsp;&nbsp;
      <a href="#M000326">idx</a>&nbsp;&nbsp;
      <a href="#M000325">index</a>&nbsp;&nbsp;
      <a href="#M000347">indexes</a>&nbsp;&nbsp;
      <a href="#M000360">initialize_copy</a>&nbsp;&nbsp;
      <a href="#M000361">inspect</a>&nbsp;&nbsp;
      <a href="#M000354">link</a>&nbsp;&nbsp;
      <a href="#M000355">link_to</a>&nbsp;&nbsp;
      <a href="#M000341">merge</a>&nbsp;&nbsp;
      <a href="#M000342">merge!</a>&nbsp;&nbsp;
      <a href="#M000324">new</a>&nbsp;&nbsp;
      <a href="#M000331">node</a>&nbsp;&nbsp;
      <a href="#M000343">normalize</a>&nbsp;&nbsp;
      <a href="#M000344">normalize!</a>&nbsp;&nbsp;
      <a href="#M000313">read</a>&nbsp;&nbsp;
      <a href="#M000321">register_as</a>&nbsp;&nbsp;
      <a href="#M000357">reindex</a>&nbsp;&nbsp;
      <a href="#M000309">repo</a>&nbsp;&nbsp;
      <a href="#M000358">reset</a>&nbsp;&nbsp;
      <a href="#M000349">save</a>&nbsp;&nbsp;
      <a href="#M000311">save</a>&nbsp;&nbsp;
      <a href="#M000350">saved?</a>&nbsp;&nbsp;
      <a href="#M000340">summary</a>&nbsp;&nbsp;
      <a href="#M000339">tags</a>&nbsp;&nbsp;
      <a href="#M000310">type</a>&nbsp;&nbsp;
      <a href="#M000316">update</a>&nbsp;&nbsp;
      <a href="#M000352">update</a>&nbsp;&nbsp;
      <a href="#M000319">update_index</a>&nbsp;&nbsp;
      <a href="#M000353">update_to</a>&nbsp;&nbsp;
      <a href="#M000346">validate</a>&nbsp;&nbsp;
      <a href="#M000323">validate</a>&nbsp;&nbsp;
      <a href="#M000368">validate_array_or_nil</a>&nbsp;&nbsp;
      <a href="#M000366">validate_format</a>&nbsp;&nbsp;
      <a href="#M000367">validate_format_or_nil</a>&nbsp;&nbsp;
      <a href="#M000365">validate_not_blank</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="Document/InvalidDocumentError.html" class="link">Gitgo::Document::InvalidDocumentError</a><br />

    </div>

    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">AUTHOR</td>
          <td>=</td>
          <td class="context-item-value">/\A.*?&lt;.*?&gt;\z/</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DATE</td>
          <td>=</td>
          <td class="context-item-value">/\A\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d-\d\d:\d\d\z/</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SHA</td>
          <td>=</td>
          <td class="context-item-value">Git::SHA</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">attrs</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A hash of the document attributes, corresponding to what is stored in the
<a href="Document.html#M000309">repo</a>.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">repo</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The <a href="Document.html#M000309">repo</a> this document belongs to.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">sha</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The document sha, unset until the document is saved.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">types</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
Returns a hash registry mapping a <a href="Document.html#M000310">type</a>
string to a <a href="Document.html">Document</a> class. <a
href="Document.html">Document</a> itself is registered as the nil <a
href="Document.html#M000310">type</a>. Types also includes reverse mappings
for a <a href="Document.html">Document</a> class to it&#8216;s <a
href="Document.html#M000310">type</a> string.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">validators</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A hash of (key, validator) pairs mapping attribute keys to a validation
method. Not all attributes will have a validator whereas some attributes
share the same validation method.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000314" class="method-detail">
        <a name="M000314"></a>

        <div class="method-heading">
          <a href="#M000314" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reads the specified document from the <a
href="Document.html#M000309">repo</a> cache and casts it into an instance
as per <a href="Document.html#M000315">cast</a>. Returns nil if the
document doesn&#8216;t exist.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000314-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000314-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 110</span>
110:       <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">sha</span>)
111:         <span class="ruby-identifier">sha</span> = <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">sha</span>)
112:         <span class="ruby-identifier">attrs</span> = <span class="ruby-identifier">repo</span>[<span class="ruby-identifier">sha</span>]
113:         
114:         <span class="ruby-identifier">attrs</span> <span class="ruby-value">? </span><span class="ruby-identifier">cast</span>(<span class="ruby-identifier">attrs</span>, <span class="ruby-identifier">sha</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
115:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000315" class="method-detail">
        <a name="M000315"></a>

        <div class="method-heading">
          <a href="#M000315" class="method-signature">
          <span class="method-name">cast</span><span class="method-args">(attrs, sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Casts the attributes hash into a document instance. The document class is
determined by resolving the &#8216;<a
href="Document.html#M000310">type</a>&#8217; attribute against the types
registry.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000315-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000315-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 120</span>
120:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cast</span>(<span class="ruby-identifier">attrs</span>, <span class="ruby-identifier">sha</span>)
121:         <span class="ruby-identifier">type</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'type'</span>]
122:         <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">types</span>[<span class="ruby-identifier">type</span>] <span class="ruby-keyword kw">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;unknown type: #{type}&quot;</span>
123:         <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">attrs</span>, <span class="ruby-identifier">repo</span>, <span class="ruby-identifier">sha</span>)
124:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000312" class="method-detail">
        <a name="M000312"></a>

        <div class="method-heading">
          <a href="#M000312" class="method-signature">
          <span class="method-name">create</span><span class="method-args">(attrs={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a <a href="Document.html#M000324">new</a> document with the attrs.
The document is saved, created, and indexed before being returned.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000312-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000312-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 86</span>
86:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>(<span class="ruby-identifier">attrs</span>={})
87:         <span class="ruby-identifier">update_index</span>
88:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">save</span>(<span class="ruby-identifier">attrs</span>)
89:         <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">create</span>
90:         <span class="ruby-identifier">doc</span>
91:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000318" class="method-detail">
        <a name="M000318"></a>

        <div class="method-heading">
          <a href="#M000318" class="method-signature">
          <span class="method-name">delete</span><span class="method-args">(sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000318-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000318-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 178</span>
178:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">sha</span>)
179:         <span class="ruby-identifier">doc</span> = <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">sha</span>]
180:         <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">delete</span>
181:         <span class="ruby-identifier">doc</span>
182:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000317" class="method-detail">
        <a name="M000317"></a>

        <div class="method-heading">
          <a href="#M000317" class="method-signature">
          <span class="method-name">find</span><span class="method-args">(all={}, any=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Finds all documents matching the any and all criteria. The any and all
inputs are hashes of <a href="Document.html#M000325">index</a> values used
to filter all possible documents. They consist of (key, value) or (key,
[values]) pairs. At least one of pair must match in the any case. All pairs
must match in the all case. Specify nil for either array to prevent
filtering using that criteria.
</p>
<p>
See <a href="Document.html#M000320">basis</a> for more detail regarding the
scope of &#8216;all documents&#8217; that can be found via <a
href="Document.html#M000317">find</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000317-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000317-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 167</span>
167:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find</span>(<span class="ruby-identifier">all</span>={}, <span class="ruby-identifier">any</span>=<span class="ruby-keyword kw">nil</span>)
168:         <span class="ruby-identifier">update_index</span>
169:         
170:         <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">index</span>.<span class="ruby-identifier">select</span>(
171:           <span class="ruby-identifier">:basis</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">basis</span>, 
172:           <span class="ruby-identifier">:all</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">all</span>, 
173:           <span class="ruby-identifier">:any</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">any</span>, 
174:           <span class="ruby-identifier">:shas</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
175:         ).<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">sha</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">sha</span>] }
176:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000324" class="method-detail">
        <a name="M000324"></a>

        <div class="method-heading">
          <a href="#M000324" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(attrs={}, repo=nil, sha=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000324-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000324-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 315</span>
315:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">attrs</span>={}, <span class="ruby-identifier">repo</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">sha</span>=<span class="ruby-keyword kw">nil</span>)
316:       <span class="ruby-ivar">@repo</span> = <span class="ruby-identifier">repo</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Repo</span>.<span class="ruby-identifier">current</span>
317:       <span class="ruby-ivar">@attrs</span> = <span class="ruby-identifier">attrs</span>
318:       <span class="ruby-identifier">reset</span>(<span class="ruby-identifier">sha</span>)
319:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000313" class="method-detail">
        <a name="M000313"></a>

        <div class="method-heading">
          <a href="#M000313" class="method-signature">
          <span class="method-name">read</span><span class="method-args">(sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reads the specified document and casts it into an instance as per <a
href="Document.html#M000315">cast</a>. Returns nil if the document
doesn&#8216;t exist.
</p>
<h2>Usage Note</h2>
<p>
Read will re-<a href="Document.html#M000313">read</a> the document directly
from the git repository every time it is called. For better performance,
use the AGET method which performs the same <a
href="Document.html#M000313">read</a> but uses the <a
href="Repo.html">Repo</a> cache if possible.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000313-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000313-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 101</span>
101:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>(<span class="ruby-identifier">sha</span>)
102:         <span class="ruby-identifier">sha</span> = <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">sha</span>)
103:         <span class="ruby-identifier">attrs</span> = <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">sha</span>)
104:         
105:         <span class="ruby-identifier">attrs</span> <span class="ruby-value">? </span><span class="ruby-identifier">cast</span>(<span class="ruby-identifier">attrs</span>, <span class="ruby-identifier">sha</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
106:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000309" class="method-detail">
        <a name="M000309"></a>

        <div class="method-heading">
          <a href="#M000309" class="method-signature">
          <span class="method-name">repo</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Repo.html">Repo</a> currently in scope (see <a
href="Repo.html#M000134">Repo.current</a>)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000309-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000309-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 64</span>
64:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">repo</span>
65:         <span class="ruby-constant">Repo</span>.<span class="ruby-identifier">current</span>
66:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000311" class="method-detail">
        <a name="M000311"></a>

        <div class="method-heading">
          <a href="#M000311" class="method-signature">
          <span class="method-name">save</span><span class="method-args">(attrs={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a <a href="Document.html#M000324">new</a> document with the
attributes and saves. Saved documents are not automatically associated with
a document <a href="Document.html#M000330">graph</a> and must be associated
with one via create/update/link to be permanently stored in the <a
href="Document.html#M000309">repo</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000311-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000311-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 77</span>
77:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save</span>(<span class="ruby-identifier">attrs</span>={})
78:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">attrs</span>, <span class="ruby-identifier">repo</span>)
79:         <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">save</span>
80:         <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">reindex</span>
81:         <span class="ruby-identifier">doc</span>
82:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000310" class="method-detail">
        <a name="M000310"></a>

        <div class="method-heading">
          <a href="#M000310" class="method-signature">
          <span class="method-name">type</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Document.html#M000310">type</a> string for self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000310-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000310-source">
<pre>
    <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 69</span>
69:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">type</span>
70:         <span class="ruby-identifier">types</span>[<span class="ruby-keyword kw">self</span>]
71:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000316" class="method-detail">
        <a name="M000316"></a>

        <div class="method-heading">
          <a href="#M000316" class="method-signature">
          <span class="method-name">update</span><span class="method-args">(old_doc, attrs={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Updates and <a href="Document.html#M000347">indexes</a> the old document
with <a href="Document.html#M000324">new</a> attributes. The <a
href="Document.html#M000324">new</a> attributes are merged with the current
doc attributes. Returns the <a href="Document.html#M000324">new</a>
document.
</p>
<p>
The <a href="Document.html#M000324">new</a> document can be used to <a
href="Document.html#M000316">update</a> other documents, if necessary, as
when resolving forks in an <a href="Document.html#M000316">update</a> <a
href="Document.html#M000330">graph</a>:
</p>
<pre>
  a = Document.create(:content =&gt; 'a')
  b = Document.update(a, :content =&gt; 'b')
  c = Document.update(a, :content =&gt; 'c')

  d = Document.update(b, :content =&gt; 'd')
  c.update(d)

  a.reset
  a.node.versions.uniq    # =&gt; [d.sha]
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000316-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000316-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 143</span>
143:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">old_doc</span>, <span class="ruby-identifier">attrs</span>={})
144:         <span class="ruby-identifier">update_index</span>
145:         
146:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">old_doc</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Document</span>)
147:           <span class="ruby-identifier">old_doc</span> = <span class="ruby-constant">Document</span>[<span class="ruby-identifier">old_doc</span>]
148:         <span class="ruby-keyword kw">end</span>
149:         
150:         <span class="ruby-identifier">new_doc</span> = <span class="ruby-identifier">old_doc</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">attrs</span>)
151:         <span class="ruby-identifier">new_doc</span>.<span class="ruby-identifier">save</span>
152:         <span class="ruby-identifier">new_doc</span>.<span class="ruby-identifier">reindex</span>
153:         
154:         <span class="ruby-identifier">old_doc</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">new_doc</span>)
155:         <span class="ruby-identifier">new_doc</span>
156:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000319" class="method-detail">
        <a name="M000319"></a>

        <div class="method-heading">
          <a href="#M000319" class="method-signature">
          <span class="method-name">update_index</span><span class="method-args">(reindex=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Performs a partial <a href="Document.html#M000316">update</a> of the
document <a href="Document.html#M000325">index</a>. All documents added
between the <a href="Document.html#M000325">index</a>-head and the <a
href="Document.html#M000309">repo</a>-head are updated using this method.
</p>
<p>
Specify <a href="Document.html#M000357">reindex</a> to clobber and
completely rebuild the <a href="Document.html#M000325">index</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000319-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000319-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 189</span>
189:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_index</span>(<span class="ruby-identifier">reindex</span>=<span class="ruby-keyword kw">false</span>)
190:         <span class="ruby-identifier">index</span> = <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">index</span>
191:         <span class="ruby-identifier">index</span>.<span class="ruby-identifier">clear</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">reindex</span>
192:         <span class="ruby-identifier">git_head</span>, <span class="ruby-identifier">index_head</span> = <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">head</span>, <span class="ruby-identifier">index</span>.<span class="ruby-identifier">head</span>
193:         
194:         <span class="ruby-comment cmt"># if the index is up-to-date save the work of doing diff</span>
195:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">git_head</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">git_head</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">index_head</span>
196:           <span class="ruby-keyword kw">return</span> []
197:         <span class="ruby-keyword kw">end</span>
198:         
199:         <span class="ruby-identifier">shas</span> = <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">diff</span>(<span class="ruby-identifier">index_head</span>, <span class="ruby-identifier">git_head</span>)
200:         <span class="ruby-identifier">shas</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">source</span><span class="ruby-operator">|</span>
201:           <span class="ruby-identifier">doc</span> = <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">source</span>]
202:           <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">reindex</span>
203:           
204:           <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">each_assoc</span>(<span class="ruby-identifier">source</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">target</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">|</span>
205:             <span class="ruby-identifier">index</span>.<span class="ruby-identifier">assoc</span>(<span class="ruby-identifier">source</span>, <span class="ruby-identifier">target</span>, <span class="ruby-identifier">type</span>)
206:           <span class="ruby-keyword kw">end</span>
207:         <span class="ruby-keyword kw">end</span>
208:         
209:         <span class="ruby-identifier">index</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">git_head</span>)
210:         <span class="ruby-identifier">shas</span>
211:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Class methods</h3>

      <div id="method-M000320" class="method-detail">
        <a name="M000320"></a>

        <div class="method-heading">
          <a href="#M000320" class="method-signature">
          <span class="method-name">basis</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Document.html#M000320">basis</a> for finds, ie the set
of documents that get filtered by the <a
href="Document.html#M000317">find</a> method.
</p>
<p>
If <a href="Document.html#M000310">type</a> is specified for self, then
only documents of <a href="Document.html#M000310">type</a> will be
available (ie Issue.find will only <a href="Document.html#M000317">find</a>
documents of <a href="Document.html#M000310">type</a> &#8216;issue&#8217;).
<a href="Document.html">Document</a> itself will filter all documents with
an email; which should typically represent all possible documents.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000320-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000320-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 222</span>
222:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">basis</span>
223:         <span class="ruby-identifier">type</span> <span class="ruby-value">? </span><span class="ruby-identifier">repo</span>.<span class="ruby-identifier">index</span>[<span class="ruby-value str">'type'</span>][<span class="ruby-identifier">type</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">index</span>.<span class="ruby-identifier">all</span>(<span class="ruby-value str">'email'</span>)
224:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000322" class="method-detail">
        <a name="M000322"></a>

        <div class="method-heading">
          <a href="#M000322" class="method-signature">
          <span class="method-name">define_attributes</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Turns on attribute definition for the duration of the block. If attribute
definition is on, then the standard attribute declarations (attr_reader,
attr_writer, attr_accessor) will <a href="Document.html#M000312">create</a>
accessors for the attrs hash rather than instance variables.
</p>
<p>
Moreover, blocks given to attr_writer/attr_accessor will be used to define
a validator for the accessor.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000322-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000322-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 241</span>
241:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">define_attributes</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
242:         <span class="ruby-keyword kw">begin</span>
243:           <span class="ruby-ivar">@define_attributes</span> = <span class="ruby-keyword kw">true</span>
244:           <span class="ruby-identifier">instance_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
245:         <span class="ruby-keyword kw">ensure</span>
246:           <span class="ruby-ivar">@define_attributes</span> = <span class="ruby-keyword kw">false</span>
247:         <span class="ruby-keyword kw">end</span>
248:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000321" class="method-detail">
        <a name="M000321"></a>

        <div class="method-heading">
          <a href="#M000321" class="method-signature">
          <span class="method-name">register_as</span><span class="method-args">(type)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers self as the specified <a href="Document.html#M000310">type</a>.
The previous registered <a href="Document.html#M000310">type</a> is
overridden.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000321-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000321-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 228</span>
228:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">register_as</span>(<span class="ruby-identifier">type</span>)
229:         <span class="ruby-identifier">types</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span> }
230:         <span class="ruby-identifier">types</span>[<span class="ruby-identifier">type</span>] = <span class="ruby-keyword kw">self</span>
231:         <span class="ruby-identifier">types</span>[<span class="ruby-keyword kw">self</span>] = <span class="ruby-identifier">type</span>
232:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000323" class="method-detail">
        <a name="M000323"></a>

        <div class="method-heading">
          <a href="#M000323" class="method-signature">
          <span class="method-name">validate</span><span class="method-args">(key, validator=&quot;validate_</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers the validator method to <a
href="Document.html#M000323">validate</a> the specified attribute. If a
block is given, it will be used to define the validator as a protected
instance method (otherwise you need to define the validator method
manually).
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000323-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000323-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 277</span>
277:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">validator</span>=<span class="ruby-node">&quot;validate_#{key}&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
278:         <span class="ruby-identifier">validators</span>[<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>] = <span class="ruby-identifier">validator</span>.<span class="ruby-identifier">to_sym</span>
279:         
280:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
281:           <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">validator</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
282:           <span class="ruby-identifier">protected</span> <span class="ruby-identifier">validator</span>
283:         <span class="ruby-keyword kw">end</span>
284:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000362" class="method-detail">
        <a name="M000362"></a>

        <div class="method-heading">
          <a href="#M000362" class="method-signature">
          <span class="method-name">==</span><span class="method-args">(another)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
This is a thin equality &#8212; use with caution.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000362-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000362-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 635</span>
635:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">another</span>)
636:       <span class="ruby-identifier">saved?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">another</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Document</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">sha</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">another</span>.<span class="ruby-identifier">sha</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">super</span>
637:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000332" class="method-detail">
        <a name="M000332"></a>

        <div class="method-heading">
          <a href="#M000332" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Gets the specified attribute.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000332-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000332-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 352</span>
352:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">key</span>)
353:       <span class="ruby-identifier">attrs</span>[<span class="ruby-identifier">key</span>]
354:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000333" class="method-detail">
        <a name="M000333"></a>

        <div class="method-heading">
          <a href="#M000333" class="method-signature">
          <span class="method-name">[]=</span><span class="method-args">(key, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the specified attribute.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000333-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000333-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 357</span>
357:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
358:       <span class="ruby-identifier">attrs</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
359:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000338" class="method-detail">
        <a name="M000338"></a>

        <div class="method-heading">
          <a href="#M000338" class="method-signature">
          <span class="method-name">active?</span><span class="method-args">(commit=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000338-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000338-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 392</span>
392:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active?</span>(<span class="ruby-identifier">commit</span>=<span class="ruby-keyword kw">nil</span>)
393:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">at</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">commit</span>.<span class="ruby-identifier">nil?</span>
394:       <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">rev_list</span>(<span class="ruby-identifier">commit</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">at</span>)
395:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000335" class="method-detail">
        <a name="M000335"></a>

        <div class="method-heading">
          <a href="#M000335" class="method-signature">
          <span class="method-name">author</span><span class="method-args">(cast=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000335-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000335-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 369</span>
369:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">author</span>(<span class="ruby-identifier">cast</span>=<span class="ruby-keyword kw">true</span>)
370:       <span class="ruby-identifier">author</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'author'</span>]
371:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cast</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
372:         <span class="ruby-identifier">author</span> = <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Actor</span>.<span class="ruby-identifier">from_string</span>(<span class="ruby-identifier">author</span>)
373:       <span class="ruby-keyword kw">end</span>
374:       <span class="ruby-identifier">author</span>
375:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000334" class="method-detail">
        <a name="M000334"></a>

        <div class="method-heading">
          <a href="#M000334" class="method-signature">
          <span class="method-name">author=</span><span class="method-args">(author)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000334-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000334-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 361</span>
361:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">author=</span>(<span class="ruby-identifier">author</span>)
362:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Actor</span>)
363:         <span class="ruby-identifier">email</span> = <span class="ruby-identifier">author</span>.<span class="ruby-identifier">email</span>
364:         <span class="ruby-identifier">author</span> = <span class="ruby-identifier">blank?</span>(<span class="ruby-identifier">email</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;#{author.name} &lt;#{email}&gt;&quot;</span>.<span class="ruby-identifier">lstrip</span>
365:       <span class="ruby-keyword kw">end</span>
366:       <span class="ruby-keyword kw">self</span>[<span class="ruby-value str">'author'</span>] = <span class="ruby-identifier">author</span>
367:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000359" class="method-detail">
        <a name="M000359"></a>

        <div class="method-heading">
          <a href="#M000359" class="method-signature">
          <span class="method-name">commit!</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000359-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000359-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 619</span>
619:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">commit!</span>
620:       <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">commit!</span>
621:       <span class="ruby-keyword kw">self</span>
622:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000351" class="method-detail">
        <a name="M000351"></a>

        <div class="method-heading">
          <a href="#M000351" class="method-signature">
          <span class="method-name">create</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Stores self as a <a href="Document.html#M000324">new</a> <a
href="Document.html#M000330">graph</a> head. Returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000351-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000351-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 509</span>
509:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>
510:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">saved?</span>
511:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;cannot create unless saved&quot;</span>
512:       <span class="ruby-keyword kw">end</span>
513:       
514:       <span class="ruby-identifier">index</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">sha</span>)
515:       <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">sha</span>)
516:       <span class="ruby-keyword kw">self</span>
517:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000337" class="method-detail">
        <a name="M000337"></a>

        <div class="method-heading">
          <a href="#M000337" class="method-signature">
          <span class="method-name">date</span><span class="method-args">(cast=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000337-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000337-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 384</span>
384:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">date</span>(<span class="ruby-identifier">cast</span>=<span class="ruby-keyword kw">true</span>)
385:       <span class="ruby-identifier">date</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'date'</span>]
386:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">cast</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">date</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
387:         <span class="ruby-identifier">date</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">date</span>)
388:       <span class="ruby-keyword kw">end</span>
389:       <span class="ruby-identifier">date</span>
390:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000336" class="method-detail">
        <a name="M000336"></a>

        <div class="method-heading">
          <a href="#M000336" class="method-signature">
          <span class="method-name">date=</span><span class="method-args">(date)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000336-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000336-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 377</span>
377:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">date=</span>(<span class="ruby-identifier">date</span>)
378:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">date</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:iso8601</span>)
379:         <span class="ruby-identifier">date</span> = <span class="ruby-identifier">date</span>.<span class="ruby-identifier">iso8601</span>
380:       <span class="ruby-keyword kw">end</span>
381:       <span class="ruby-keyword kw">self</span>[<span class="ruby-value str">'date'</span>] = <span class="ruby-identifier">date</span>
382:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000356" class="method-detail">
        <a name="M000356"></a>

        <div class="method-heading">
          <a href="#M000356" class="method-signature">
          <span class="method-name">delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deletes self. Delete raises an error if unsaved. Returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000356-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000356-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 592</span>
592:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete</span>
593:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">saved?</span>
594:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;cannot delete unless saved&quot;</span>
595:       <span class="ruby-keyword kw">end</span>
596:       
597:       <span class="ruby-identifier">index</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">sha</span>)
598:       <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">sha</span>)
599:       <span class="ruby-keyword kw">self</span>
600:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000348" class="method-detail">
        <a name="M000348"></a>

        <div class="method-heading">
          <a href="#M000348" class="method-signature">
          <span class="method-name">each_index</span><span class="method-args">() {|'email', blank?(email ? 'unknown' : email)| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000348-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000348-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 468</span>
468:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_index</span>
469:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">author</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'author'</span>]
470:         <span class="ruby-identifier">email</span> = <span class="ruby-constant">Grit</span><span class="ruby-operator">::</span><span class="ruby-constant">Actor</span>.<span class="ruby-identifier">from_string</span>(<span class="ruby-identifier">author</span>).<span class="ruby-identifier">email</span>
471:         <span class="ruby-keyword kw">yield</span>(<span class="ruby-value str">'email'</span>, <span class="ruby-identifier">blank?</span>(<span class="ruby-identifier">email</span>) <span class="ruby-operator">?</span> <span class="ruby-value str">'unknown'</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">email</span>)
472:       <span class="ruby-keyword kw">end</span>
473:       
474:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">date</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'date'</span>]
475:         <span class="ruby-comment cmt"># reformats iso8601 as YYYYMMDD</span>
476:         <span class="ruby-keyword kw">yield</span>(<span class="ruby-value str">'date'</span>, <span class="ruby-node">&quot;#{date[0,4]}#{date[5,2]}#{date[8,2]}&quot;</span>)
477:       <span class="ruby-keyword kw">end</span>
478:       
479:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">at</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'at'</span>]
480:         <span class="ruby-keyword kw">yield</span>(<span class="ruby-value str">'at'</span>, <span class="ruby-identifier">at</span>)
481:       <span class="ruby-keyword kw">end</span>
482:       
483:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tags</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'tags'</span>]
484:         <span class="ruby-identifier">tags</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span>
485:           <span class="ruby-keyword kw">yield</span>(<span class="ruby-value str">'tags'</span>, <span class="ruby-identifier">tag</span>)
486:         <span class="ruby-keyword kw">end</span>
487:       <span class="ruby-keyword kw">end</span>
488:       
489:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'type'</span>]
490:         <span class="ruby-keyword kw">yield</span>(<span class="ruby-value str">'type'</span>, <span class="ruby-identifier">type</span>)
491:       <span class="ruby-keyword kw">end</span>
492:       
493:       <span class="ruby-keyword kw">self</span>
494:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000345" class="method-detail">
        <a name="M000345"></a>

        <div class="method-heading">
          <a href="#M000345" class="method-signature">
          <span class="method-name">errors</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000345-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000345-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 440</span>
440:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">errors</span>
441:       <span class="ruby-identifier">errors</span> = {}
442:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">validators</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">validator</span><span class="ruby-operator">|</span>
443:         <span class="ruby-keyword kw">begin</span>
444:           <span class="ruby-identifier">send</span>(<span class="ruby-identifier">validator</span>, <span class="ruby-identifier">attrs</span>[<span class="ruby-identifier">key</span>])
445:         <span class="ruby-keyword kw">rescue</span>
446:           <span class="ruby-identifier">errors</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">$!</span>
447:         <span class="ruby-keyword kw">end</span>
448:       <span class="ruby-keyword kw">end</span>
449:       <span class="ruby-identifier">errors</span>
450:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000330" class="method-detail">
        <a name="M000330"></a>

        <div class="method-heading">
          <a href="#M000330" class="method-signature">
          <span class="method-name">graph</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000330-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000330-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 343</span>
343:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">graph</span>
344:       <span class="ruby-ivar">@graph</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">graph</span>(<span class="ruby-identifier">graph_head</span>)
345:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000329" class="method-detail">
        <a name="M000329"></a>

        <div class="method-heading">
          <a href="#M000329" class="method-signature">
          <span class="method-name">graph_head</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000329-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000329-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 338</span>
338:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">graph_head</span>
339:       <span class="ruby-identifier">idx</span> = <span class="ruby-identifier">graph_head_idx</span>
340:       <span class="ruby-identifier">idx</span> <span class="ruby-value">? </span><span class="ruby-identifier">index</span>.<span class="ruby-identifier">list</span>[<span class="ruby-identifier">idx</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
341:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000328" class="method-detail">
        <a name="M000328"></a>

        <div class="method-heading">
          <a href="#M000328" class="method-signature">
          <span class="method-name">graph_head?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000328-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000328-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 334</span>
334:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">graph_head?</span>
335:       <span class="ruby-identifier">graph_head_idx</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">idx</span>
336:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000327" class="method-detail">
        <a name="M000327"></a>

        <div class="method-heading">
          <a href="#M000327" class="method-signature">
          <span class="method-name">graph_head_idx</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000327-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000327-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 330</span>
330:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">graph_head_idx</span>
331:       <span class="ruby-identifier">index</span>.<span class="ruby-identifier">graph_head_idx</span>(<span class="ruby-identifier">idx</span>)
332:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000326" class="method-detail">
        <a name="M000326"></a>

        <div class="method-heading">
          <a href="#M000326" class="method-signature">
          <span class="method-name">idx</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000326-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000326-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 326</span>
326:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">idx</span>
327:       <span class="ruby-identifier">sha</span> <span class="ruby-value">? </span><span class="ruby-identifier">index</span>.<span class="ruby-identifier">idx</span>(<span class="ruby-identifier">sha</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
328:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000325" class="method-detail">
        <a name="M000325"></a>

        <div class="method-heading">
          <a href="#M000325" class="method-signature">
          <span class="method-name">index</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="Document.html#M000309">repo</a> <a
href="Document.html#M000325">index</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000325-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000325-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 322</span>
322:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
323:       <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">index</span>
324:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000347" class="method-detail">
        <a name="M000347"></a>

        <div class="method-heading">
          <a href="#M000347" class="method-signature">
          <span class="method-name">indexes</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000347-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000347-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 462</span>
462:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">indexes</span>
463:       <span class="ruby-identifier">indexes</span> = []
464:       <span class="ruby-identifier">each_index</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">indexes</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>] }
465:       <span class="ruby-identifier">indexes</span>
466:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000360" class="method-detail">
        <a name="M000360"></a>

        <div class="method-heading">
          <a href="#M000360" class="method-signature">
          <span class="method-name">initialize_copy</span><span class="method-args">(orig)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000360-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000360-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 624</span>
624:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize_copy</span>(<span class="ruby-identifier">orig</span>)
625:       <span class="ruby-keyword kw">super</span>
626:       <span class="ruby-identifier">reset</span>(<span class="ruby-keyword kw">nil</span>)
627:       <span class="ruby-ivar">@attrs</span> = <span class="ruby-identifier">orig</span>.<span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">dup</span>
628:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000361" class="method-detail">
        <a name="M000361"></a>

        <div class="method-heading">
          <a href="#M000361" class="method-signature">
          <span class="method-name">inspect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000361-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000361-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 630</span>
630:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
631:       <span class="ruby-node">&quot;#&lt;#{self.class}:#{object_id} sha=#{sha.inspect}&gt;&quot;</span>
632:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000354" class="method-detail">
        <a name="M000354"></a>

        <div class="method-heading">
          <a href="#M000354" class="method-signature">
          <span class="method-name">link</span><span class="method-args">(child)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Links the child document to self. Returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000354-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000354-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 556</span>
556:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link</span>(<span class="ruby-identifier">child</span>)
557:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">saved?</span>
558:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;cannot link unless saved&quot;</span>
559:       <span class="ruby-keyword kw">end</span>
560:       
561:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">child</span>.<span class="ruby-identifier">saved?</span>
562:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;cannot link to an unsaved document: #{child.inspect}&quot;</span> 
563:       <span class="ruby-keyword kw">end</span>
564:       
565:       <span class="ruby-identifier">child_sha</span> = <span class="ruby-identifier">child</span>.<span class="ruby-identifier">sha</span>
566:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">assoc_type</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">child_sha</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">:update</span>
567:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;cannot link to an update of self: #{sha} -&gt; #{child_sha}&quot;</span>
568:       <span class="ruby-keyword kw">end</span>
569:       
570:       <span class="ruby-identifier">index</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">child_sha</span>)
571:       <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">link</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">child_sha</span>)
572:       
573:       <span class="ruby-identifier">child</span>.<span class="ruby-identifier">reset</span>
574:       <span class="ruby-identifier">reset</span>
575:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000355" class="method-detail">
        <a name="M000355"></a>

        <div class="method-heading">
          <a href="#M000355" class="method-signature">
          <span class="method-name">link_to</span><span class="method-args">(*parents)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000355-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000355-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 577</span>
577:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">link_to</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">parents</span>)
578:       <span class="ruby-identifier">graph_heads</span> = <span class="ruby-identifier">parents</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">parent</span><span class="ruby-operator">|</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">graph_head</span> }.<span class="ruby-identifier">uniq</span>
579:       
580:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">graph_heads</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
581:         <span class="ruby-identifier">parents</span>.<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">parent</span><span class="ruby-operator">|</span> <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">sha</span> }
582:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;cannot link to unrelated documents: #{parents.inspect}&quot;</span>
583:       <span class="ruby-keyword kw">end</span>
584:       
585:       <span class="ruby-identifier">parents</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parent</span><span class="ruby-operator">|</span>
586:         <span class="ruby-identifier">parent</span>.<span class="ruby-identifier">link</span>(<span class="ruby-keyword kw">self</span>)
587:       <span class="ruby-keyword kw">end</span>
588:       <span class="ruby-keyword kw">self</span>
589:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000341" class="method-detail">
        <a name="M000341"></a>

        <div class="method-heading">
          <a href="#M000341" class="method-signature">
          <span class="method-name">merge</span><span class="method-args">(attrs)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000341-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000341-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 405</span>
405:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">attrs</span>)
406:       <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">attrs</span>)
407:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000342" class="method-detail">
        <a name="M000342"></a>

        <div class="method-heading">
          <a href="#M000342" class="method-signature">
          <span class="method-name">merge!</span><span class="method-args">(attrs)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000342-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000342-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 409</span>
409:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">attrs</span>)
410:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">attrs</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">attrs</span>)
411:       <span class="ruby-keyword kw">self</span>
412:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000331" class="method-detail">
        <a name="M000331"></a>

        <div class="method-heading">
          <a href="#M000331" class="method-signature">
          <span class="method-name">node</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000331-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000331-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 347</span>
347:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">node</span>
348:       <span class="ruby-identifier">graph</span>[<span class="ruby-identifier">sha</span>]
349:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000343" class="method-detail">
        <a name="M000343"></a>

        <div class="method-heading">
          <a href="#M000343" class="method-signature">
          <span class="method-name">normalize</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000343-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000343-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 414</span>
414:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalize</span>
415:       <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">normalize!</span>
416:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000344" class="method-detail">
        <a name="M000344"></a>

        <div class="method-heading">
          <a href="#M000344" class="method-signature">
          <span class="method-name">normalize!</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000344-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000344-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 418</span>
418:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalize!</span>
419:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">author</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">git</span>.<span class="ruby-identifier">author</span>
420:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">date</span>   <span class="ruby-operator">||=</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
421:       
422:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">at</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'at'</span>]
423:         <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'at'</span>] = <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">at</span>)
424:       <span class="ruby-keyword kw">end</span>
425:       
426:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tags</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'tags'</span>]
427:         <span class="ruby-identifier">tags</span> = <span class="ruby-identifier">arrayify</span>(<span class="ruby-identifier">tags</span>)
428:         <span class="ruby-identifier">tags</span>.<span class="ruby-identifier">delete_if</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tag</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span> }
429:         <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'tags'</span>] = <span class="ruby-identifier">tags</span>
430:       <span class="ruby-keyword kw">end</span>
431:       
432:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">type</span> = <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'type'</span>]
433:         <span class="ruby-identifier">default_type</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">type</span>
434:         <span class="ruby-identifier">attrs</span>[<span class="ruby-value str">'type'</span>] = <span class="ruby-identifier">default_type</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">default_type</span>
435:       <span class="ruby-keyword kw">end</span>
436:       
437:       <span class="ruby-keyword kw">self</span>
438:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000357" class="method-detail">
        <a name="M000357"></a>

        <div class="method-heading">
          <a href="#M000357" class="method-signature">
          <span class="method-name">reindex</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000357-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000357-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 602</span>
602:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reindex</span>
603:       <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;cannot reindex unless saved&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">saved?</span>
604:       
605:       <span class="ruby-identifier">idx</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">idx</span>
606:       <span class="ruby-identifier">each_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
607:         <span class="ruby-identifier">index</span>[<span class="ruby-identifier">key</span>][<span class="ruby-identifier">value</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">idx</span>
608:       <span class="ruby-keyword kw">end</span>
609:       
610:       <span class="ruby-keyword kw">self</span>
611:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000358" class="method-detail">
        <a name="M000358"></a>

        <div class="method-heading">
          <a href="#M000358" class="method-signature">
          <span class="method-name">reset</span><span class="method-args">(new_sha=sha)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000358-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000358-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 613</span>
613:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset</span>(<span class="ruby-identifier">new_sha</span>=<span class="ruby-identifier">sha</span>)
614:       <span class="ruby-ivar">@sha</span> = <span class="ruby-identifier">new_sha</span>
615:       <span class="ruby-ivar">@graph</span> = <span class="ruby-keyword kw">nil</span>
616:       <span class="ruby-keyword kw">self</span>
617:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000349" class="method-detail">
        <a name="M000349"></a>

        <div class="method-heading">
          <a href="#M000349" class="method-signature">
          <span class="method-name">save</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Validates and saves attrs into the <a
href="Document.html#M000309">repo</a>, then resets self with the resulting
sha. Returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000349-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000349-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 498</span>
498:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save</span>
499:       <span class="ruby-identifier">validate</span>
500:       <span class="ruby-identifier">reset</span> <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">save</span>(<span class="ruby-identifier">attrs</span>)
501:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000350" class="method-detail">
        <a name="M000350"></a>

        <div class="method-heading">
          <a href="#M000350" class="method-signature">
          <span class="method-name">saved?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns true if sha is set.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000350-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000350-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 504</span>
504:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">saved?</span>
505:       <span class="ruby-identifier">sha</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">false</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">true</span>
506:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000340" class="method-detail">
        <a name="M000340"></a>

        <div class="method-heading">
          <a href="#M000340" class="method-signature">
          <span class="method-name">summary</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000340-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000340-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 401</span>
401:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">summary</span>
402:       <span class="ruby-identifier">sha</span>
403:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000339" class="method-detail">
        <a name="M000339"></a>

        <div class="method-heading">
          <a href="#M000339" class="method-signature">
          <span class="method-name">tags</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000339-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000339-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 397</span>
397:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">tags</span>
398:       <span class="ruby-keyword kw">self</span>[<span class="ruby-value str">'tags'</span>] <span class="ruby-operator">||=</span> []
399:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000352" class="method-detail">
        <a name="M000352"></a>

        <div class="method-heading">
          <a href="#M000352" class="method-signature">
          <span class="method-name">update</span><span class="method-args">(new_doc)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Updates self with the <a href="Document.html#M000324">new</a> document.
Returns self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000352-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000352-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 520</span>
520:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">new_doc</span>)
521:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">saved?</span>
522:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;cannot update unless saved&quot;</span>
523:       <span class="ruby-keyword kw">end</span>
524:       
525:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">new_doc</span>.<span class="ruby-identifier">saved?</span>
526:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;cannot update with an unsaved document: #{new_doc.inspect}&quot;</span> 
527:       <span class="ruby-keyword kw">end</span>
528:       
529:       <span class="ruby-identifier">new_sha</span> = <span class="ruby-identifier">new_doc</span>.<span class="ruby-identifier">sha</span>
530:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">assoc_type</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">new_sha</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">:link</span>
531:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;cannot update with a child of self: #{sha} -&gt; #{new_sha}&quot;</span>
532:       <span class="ruby-keyword kw">end</span>
533:       
534:       <span class="ruby-identifier">index</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">new_sha</span>)
535:       <span class="ruby-identifier">repo</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">sha</span>, <span class="ruby-identifier">new_sha</span>)
536:       
537:       <span class="ruby-identifier">new_doc</span>.<span class="ruby-identifier">reset</span>
538:       <span class="ruby-identifier">reset</span>
539:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000353" class="method-detail">
        <a name="M000353"></a>

        <div class="method-heading">
          <a href="#M000353" class="method-signature">
          <span class="method-name">update_to</span><span class="method-args">(*old_docs)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000353-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000353-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 541</span>
541:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_to</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">old_docs</span>)
542:       <span class="ruby-identifier">originals</span> = <span class="ruby-identifier">old_docs</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">old_doc</span><span class="ruby-operator">|</span> <span class="ruby-identifier">old_doc</span>.<span class="ruby-identifier">node</span>.<span class="ruby-identifier">original</span> }.<span class="ruby-identifier">uniq</span>
543:       
544:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">originals</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
545:         <span class="ruby-identifier">old_docs</span>.<span class="ruby-identifier">collect!</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">old_doc</span><span class="ruby-operator">|</span> <span class="ruby-identifier">old_doc</span>.<span class="ruby-identifier">sha</span> }
546:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;cannot update unrelated documents: #{old_docs.inspect}&quot;</span>
547:       <span class="ruby-keyword kw">end</span>
548:       
549:       <span class="ruby-identifier">old_docs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">old_doc</span><span class="ruby-operator">|</span>
550:         <span class="ruby-identifier">old_doc</span>.<span class="ruby-identifier">update</span>(<span class="ruby-keyword kw">self</span>)
551:       <span class="ruby-keyword kw">end</span>
552:       <span class="ruby-keyword kw">self</span>
553:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000346" class="method-detail">
        <a name="M000346"></a>

        <div class="method-heading">
          <a href="#M000346" class="method-signature">
          <span class="method-name">validate</span><span class="method-args">(normalize=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000346-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000346-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 452</span>
452:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate</span>(<span class="ruby-identifier">normalize</span>=<span class="ruby-keyword kw">true</span>)
453:       <span class="ruby-identifier">normalize!</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalize</span>
454:       
455:       <span class="ruby-identifier">errors</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">errors</span>
456:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">empty?</span>
457:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidDocumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">errors</span>)
458:       <span class="ruby-keyword kw">end</span>
459:       <span class="ruby-keyword kw">self</span>
460:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000363" class="method-detail">
        <a name="M000363"></a>

        <div class="method-heading">
          <a href="#M000363" class="method-signature">
          <span class="method-name">arrayify</span><span class="method-args">(obj)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000363-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000363-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 641</span>
641:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">arrayify</span>(<span class="ruby-identifier">obj</span>)
642:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">obj</span>
643:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">obj</span>
644:       <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span>    <span class="ruby-keyword kw">then</span> []
645:       <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span>[] <span class="ruby-operator">:</span> [<span class="ruby-identifier">obj</span>]
646:       <span class="ruby-keyword kw">else</span> [<span class="ruby-identifier">obj</span>]
647:       <span class="ruby-keyword kw">end</span>
648:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000364" class="method-detail">
        <a name="M000364"></a>

        <div class="method-heading">
          <a href="#M000364" class="method-signature">
          <span class="method-name">blank?</span><span class="method-args">(obj)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000364-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000364-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 650</span>
650:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">blank?</span>(<span class="ruby-identifier">obj</span>)
651:       <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>
652:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000368" class="method-detail">
        <a name="M000368"></a>

        <div class="method-heading">
          <a href="#M000368" class="method-signature">
          <span class="method-name">validate_array_or_nil</span><span class="method-args">(value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000368-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000368-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 674</span>
674:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate_array_or_nil</span>(<span class="ruby-identifier">value</span>)
675:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
676:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">'not an array'</span>
677:       <span class="ruby-keyword kw">end</span>
678:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000366" class="method-detail">
        <a name="M000366"></a>

        <div class="method-heading">
          <a href="#M000366" class="method-signature">
          <span class="method-name">validate_format</span><span class="method-args">(value, format)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000366-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000366-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 660</span>
660:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate_format</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">format</span>)
661:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
662:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">'missing'</span>
663:       <span class="ruby-keyword kw">end</span>
664:       
665:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">format</span>
666:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">'misformatted'</span>
667:       <span class="ruby-keyword kw">end</span>
668:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000367" class="method-detail">
        <a name="M000367"></a>

        <div class="method-heading">
          <a href="#M000367" class="method-signature">
          <span class="method-name">validate_format_or_nil</span><span class="method-args">(value, format)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000367-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000367-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 670</span>
670:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate_format_or_nil</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">format</span>)
671:       <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">validate_format</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">format</span>)
672:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000365" class="method-detail">
        <a name="M000365"></a>

        <div class="method-heading">
          <a href="#M000365" class="method-signature">
          <span class="method-name">validate_not_blank</span><span class="method-args">(str)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000365-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000365-source">
<pre>
     <span class="ruby-comment cmt"># File lib/gitgo/document.rb, line 654</span>
654:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate_not_blank</span>(<span class="ruby-identifier">str</span>)
655:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">blank?</span>(<span class="ruby-identifier">str</span>)
656:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">'nothing specified'</span>
657:       <span class="ruby-keyword kw">end</span>
658:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>