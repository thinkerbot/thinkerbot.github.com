<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Configurable::ClassMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Configurable::ClassMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/configurable/class_methods_rb.html">
                lib/configurable/class_methods.rb
                </a>
        <br />
                <a href="../../files/lib/configurable/ordered_hash_patch_rb.html">
                lib/configurable/ordered_hash_patch.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="ClassMethods.html">ClassMethods</a> extends classes that include
<a href="../Configurable.html">Configurable</a> and provides methods for
declaring <a href="ClassMethods.html#M000046">configurations</a>.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000054">c</a>&nbsp;&nbsp;
      <a href="#M000047">cache_configurations</a>&nbsp;&nbsp;
      <a href="#M000049">config</a>&nbsp;&nbsp;
      <a href="#M000050">config_attr</a>&nbsp;&nbsp;
      <a href="#M000046">configurations</a>&nbsp;&nbsp;
      <a href="#M000051">nest</a>&nbsp;&nbsp;
      <a href="#M000044">parse</a>&nbsp;&nbsp;
      <a href="#M000045">parse!</a>&nbsp;&nbsp;
      <a href="#M000052">remove_config</a>&nbsp;&nbsp;
      <a href="#M000053">undef_config</a>&nbsp;&nbsp;
      <a href="#M000048">use_indifferent_access</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="../Configurable.html">Configurable</a></span>
      </div>
    </div>

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONFIGURATIONS_CLASS</td>
          <td>=</td>
          <td class="context-item-value">Hash</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CONFIGURATIONS_CLASS</td>
          <td>=</td>
          <td class="context-item-value">OrderedHashPatch</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">config_registry</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A hash of (key, <a href="Config.html">Config</a>) pairs tracking configs
defined on self. See <a href="ClassMethods.html#M000046">configurations</a>
for all configs declared across all ancestors.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000047" class="method-detail">
        <a name="M000047"></a>

        <div class="method-heading">
          <a href="#M000047" class="method-signature">
          <span class="method-name">cache_configurations</span><span class="method-args">(on=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Caches the <a href="ClassMethods.html#M000046">configurations</a> hash so
as to improve peformance. Call with on set to false to turn off caching.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000047-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000047-source">
<pre>
    <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 83</span>
83:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cache_configurations</span>(<span class="ruby-identifier">on</span>=<span class="ruby-keyword kw">true</span>)
84:       <span class="ruby-ivar">@configurations</span> = <span class="ruby-keyword kw">nil</span>
85:       <span class="ruby-ivar">@configurations</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">configurations</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">on</span>
86:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000046" class="method-detail">
        <a name="M000046"></a>

        <div class="method-heading">
          <a href="#M000046" class="method-signature">
          <span class="method-name">configurations</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A hash of (key, <a href="Config.html">Config</a>) pairs representing all <a
href="ClassMethods.html#M000046">configurations</a> defined on this class
or inherited from ancestors. The <a
href="ClassMethods.html#M000046">configurations</a> hash is generated on
each call to ensure it accurately reflects any configs added on ancestors.
This slows down initialization and <a
href="ClassMethods.html#M000049">config</a> access through instance.config.
</p>
<p>
Call <a href="ClassMethods.html#M000047">cache_configurations</a> after all
configs have been declared in order to prevent regeneration of <a
href="ClassMethods.html#M000046">configurations</a> and to significantly
improve performance.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000046-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000046-source">
<pre>
    <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 61</span>
61:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">configurations</span>
62:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@configurations</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@configurations</span>
63:       
64:       <span class="ruby-identifier">configurations</span> = <span class="ruby-constant">CONFIGURATIONS_CLASS</span>.<span class="ruby-identifier">new</span>
65:       <span class="ruby-identifier">configurations</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">IndifferentAccess</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@use_indifferent_access</span>
66:       
67:       <span class="ruby-identifier">ancestors</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ancestor</span><span class="ruby-operator">|</span>
68:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">ancestor</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">ClassMethods</span>)
69:         <span class="ruby-identifier">ancestor</span>.<span class="ruby-identifier">config_registry</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
70:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
71:             <span class="ruby-identifier">configurations</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
72:           <span class="ruby-keyword kw">else</span>
73:             <span class="ruby-identifier">configurations</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
74:           <span class="ruby-keyword kw">end</span>
75:         <span class="ruby-keyword kw">end</span>
76:       <span class="ruby-keyword kw">end</span>
77:       
78:       <span class="ruby-identifier">configurations</span>
79:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000044" class="method-detail">
        <a name="M000044"></a>

        <div class="method-heading">
          <a href="#M000044" class="method-signature">
          <span class="method-name">parse</span><span class="method-args">(argv=ARGV, options={}) {|parser| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Parses <a href="ClassMethods.html#M000046">configurations</a> from argv in
a non-destructive manner by generating a <a
href="../ConfigParser.html">ConfigParser</a> using the <a
href="ClassMethods.html#M000046">configurations</a> for self. Returns an
array like
</p>
<dl>
<dt>args, <a href="ClassMethods.html#M000049">config</a></dt><dd>where the args are the arguments that remain after parsing,

</dd>
</dl>
<p>
and <a href="ClassMethods.html#M000049">config</a> is a hash of the parsed
configs. The parser is yielded to the block, if given, to register
additonal options.
</p>
<p>
See <a href="../ConfigParser.html#M000015">ConfigParser#parse</a> for more
information.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000044-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000044-source">
<pre>
    <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 39</span>
39:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse</span>(<span class="ruby-identifier">argv</span>=<span class="ruby-constant">ARGV</span>, <span class="ruby-identifier">options</span>={}) <span class="ruby-comment cmt"># :yields: parser</span>
40:       <span class="ruby-identifier">parse!</span>(<span class="ruby-identifier">argv</span>.<span class="ruby-identifier">dup</span>, <span class="ruby-identifier">options</span>)
41:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000045" class="method-detail">
        <a name="M000045"></a>

        <div class="method-heading">
          <a href="#M000045" class="method-signature">
          <span class="method-name">parse!</span><span class="method-args">(argv=ARGV, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="ClassMethods.html#M000044">parse</a>, but removes parsed
args from argv.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000045-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000045-source">
<pre>
    <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 44</span>
44:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse!</span>(<span class="ruby-identifier">argv</span>=<span class="ruby-constant">ARGV</span>, <span class="ruby-identifier">options</span>={})
45:       <span class="ruby-identifier">parser</span> = <span class="ruby-constant">ConfigParser</span>.<span class="ruby-identifier">new</span>
46:       <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">configurations</span>)
47:       
48:       <span class="ruby-identifier">args</span> = <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">parse!</span>(<span class="ruby-identifier">argv</span>, <span class="ruby-identifier">options</span>)
49:       [<span class="ruby-identifier">args</span>, <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">config</span>]
50:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000054" class="method-detail">
        <a name="M000054"></a>

        <div class="method-heading">
          <a href="#M000054" class="method-signature">
          <span class="method-name">c</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="Validation.html">Validation</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000054-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000054-source">
<pre>
     <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 411</span>
411:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">c</span>
412:       <span class="ruby-constant">Validation</span>
413:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000049" class="method-detail">
        <a name="M000049"></a>

        <div class="method-heading">
          <a href="#M000049" class="method-signature">
          <span class="method-name">config</span><span class="method-args">(key, value=nil, attributes={}) {|input| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Declares a class configuration and generates the associated accessors. If a
block is given, the <tt>key=</tt> method will set <tt>@key</tt> to the
return of the block, which executes in class-context.
</p>
<pre>
  class SampleClass
    include Configurable

    config :str, 'value'
    config(:upcase, 'value') {|input| input.upcase }
  end

  # An equivalent class to illustrate class-context
  class EquivalentClass
    attr_accessor :str
    attr_reader :upcase

    UPCASE_BLOCK = lambda {|input| input.upcase }

    def upcase=(input)
      @upcase = UPCASE_BLOCK.call(input)
    end
  end
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000049-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000049-source">
<pre>
     <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 127</span>
127:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">config</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">attributes</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
128:       <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">merge_attributes</span>(<span class="ruby-identifier">block</span>, <span class="ruby-identifier">attributes</span>)
129:       
130:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
131:         <span class="ruby-identifier">instance_variable</span> = <span class="ruby-node">&quot;@#{key}&quot;</span>.<span class="ruby-identifier">to_sym</span>
132:         <span class="ruby-identifier">config_attr</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">attributes</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">input</span><span class="ruby-operator">|</span>
133:           <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">instance_variable</span>, <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">input</span>))
134:         <span class="ruby-keyword kw">end</span>
135:       <span class="ruby-keyword kw">else</span>
136:         <span class="ruby-identifier">config_attr</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">attributes</span>)
137:       <span class="ruby-keyword kw">end</span>
138:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000050" class="method-detail">
        <a name="M000050"></a>

        <div class="method-heading">
          <a href="#M000050" class="method-signature">
          <span class="method-name">config_attr</span><span class="method-args">(key, value=nil, attributes={}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Declares a class configuration and generates the associated accessors. If a
block is given, the <tt>key=</tt> method will perform the block with
instance-context.
</p>
<pre>
  class SampleClass
    include Configurable

    def initialize
      initialize_config
    end

    config_attr :str, 'value'
    config_attr(:upcase, 'value') {|input| @upcase = input.upcase }
  end

  # An equivalent class to illustrate instance-context
  class EquivalentClass
    attr_accessor :str
    attr_reader :upcase

    def upcase=(input)
      @upcase = input.upcase
    end
  end
</pre>
<h3>Attributes</h3>
<p>
Several attributes may be specified to modify how a <a
href="ClassMethods.html#M000049">config</a> is constructed. Attribute keys
should be specified as symbols.
</p>
<table>
<tr><td valign="top">Attribute:</td><td>Description

</td></tr>
<tr><td valign="top">init:</td><td>When set to false the <a href="ClassMethods.html#M000049">config</a> will
not initialize during initialize_config. (default: true)

</td></tr>
<tr><td valign="top">reader:</td><td>The method used to read the configuration. (default: key)

</td></tr>
<tr><td valign="top">writer:</td><td>The method used to write the configuration (default: &quot;#{key}=&quot;)

</td></tr>
</table>
<p>
Neither reader nor writer may be set to nil, but they may be set to
non-default values. In that case, <a
href="ClassMethods.html#M000050">config_attr</a> will register the method
names as provided, but it will not define the methods themselves.
Specifying true defines the default methods. Specifying false makes the <a
href="ClassMethods.html#M000049">config</a> expect the default method name,
but does not define the method itself.
</p>
<p>
Any additional attributes are registered with the configuration.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000050-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000050-source">
<pre>
     <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 186</span>
186:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">config_attr</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">attributes</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
187:       <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">merge_attributes</span>(<span class="ruby-identifier">block</span>, <span class="ruby-identifier">attributes</span>)
188:       
189:       <span class="ruby-comment cmt"># define the reader</span>
190:       <span class="ruby-identifier">reader</span> = <span class="ruby-identifier">define_attribute_method</span>(<span class="ruby-identifier">:reader</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">key</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attribute</span><span class="ruby-operator">|</span>
191:         <span class="ruby-identifier">attr_reader</span>(<span class="ruby-identifier">attribute</span>) 
192:         <span class="ruby-identifier">public</span>(<span class="ruby-identifier">attribute</span>)
193:       <span class="ruby-keyword kw">end</span>
194:       
195:       <span class="ruby-comment cmt"># define the writer</span>
196:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">:writer</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">true</span>
197:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;a block may not be specified without writer == true&quot;</span>
198:       <span class="ruby-keyword kw">end</span>
199:       
200:       <span class="ruby-identifier">writer</span> = <span class="ruby-identifier">define_attribute_method</span>(<span class="ruby-identifier">:writer</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-node">&quot;#{key}=&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attribute</span><span class="ruby-operator">|</span>
201:         <span class="ruby-identifier">block_given?</span> <span class="ruby-value">? </span><span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">attribute</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">attr_writer</span>(<span class="ruby-identifier">key</span>)
202:         <span class="ruby-identifier">public</span>(<span class="ruby-identifier">attribute</span>)
203:       <span class="ruby-keyword kw">end</span>
204:       
205:       <span class="ruby-comment cmt"># define the configuration</span>
206:       <span class="ruby-identifier">init</span> = <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:init</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:init</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">true</span>
207:       <span class="ruby-identifier">dup</span> = <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:dup</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:dup</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
208:       <span class="ruby-identifier">config_registry</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-constant">Config</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">reader</span>, <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">init</span>, <span class="ruby-identifier">dup</span>)
209:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000051" class="method-detail">
        <a name="M000051"></a>

        <div class="method-heading">
          <a href="#M000051" class="method-signature">
          <span class="method-name">nest</span><span class="method-args">(key, configurable_class=nil, attributes={}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds nested <a href="ClassMethods.html#M000046">configurations</a> to self.
Nest creates a new configurable class using the block, and provides
accessors to an instance of the new class. Everything is set up so you can
access configs through the instance or through <a
href="ClassMethods.html#M000049">config</a>.
</p>
<pre>
  class A
    include Configurable

    config :key, 'one'
    nest :nest do
      config :key, 'two'
    end
  end

  a = A.new
  a.key                     # =&gt; 'one'
  a.config[:key]            # =&gt; 'one'

  a.nest.key                # =&gt; 'two'
  a.config[:nest][:key]     # =&gt; 'two'

  a.nest.key = 'TWO'
  a.config[:nest][:key]     # =&gt; 'TWO'

  a.config[:nest][:key] = 2
  a.nest.key                # =&gt; 2

  a.config.to_hash          # =&gt; {:key =&gt; 'one', :nest =&gt; {:key =&gt; 2}}
  a.nest.config.to_hash     # =&gt; {:key =&gt; 2}
  a.nest.class              # =&gt; A::Nest
</pre>
<p>
An existing configurable class may be provided instead of using the block
to define a new configurable class. Recursive nesting is supported.
</p>
<pre>
  class B
    include Configurable

    config :key, 1, &amp;c.integer
    nest :nest do
      config :key, 2, &amp;c.integer
      nest :nest do
        config :key, 3, &amp;c.integer
      end
    end
  end

  class C
    include Configurable
    nest :a, A
    nest :b, B
  end

  c = C.new
  c.b.key = 7
  c.b.nest.key = &quot;8&quot;
  c.config[:b][:nest][:nest][:key] = &quot;9&quot;

  c.config.to_hash
  # =&gt; {
  # :a =&gt; {
  #   :key =&gt; 'one',
  #   :nest =&gt; {:key =&gt; 'two'}
  # },
  # :b =&gt; {
  #   :key =&gt; 7,
  #   :nest =&gt; {
  #     :key =&gt; 8,
  #     :nest =&gt; {:key =&gt; 9}
  #   }
  # }}
</pre>
<h3>Attributes</h3>
<p>
Nest uses the same attributes as <a
href="ClassMethods.html#M000050">config_attr</a>, with a couple additions:
</p>
<table>
<tr><td valign="top">Attribute:</td><td>Description

</td></tr>
<tr><td valign="top">const_name:</td><td>Determines the constant name of the configurable class within the nesting
class. May be nil. (default: key.to_s.capitalize)

</td></tr>
<tr><td valign="top">type:</td><td>By default set to :<a href="ClassMethods.html#M000051">nest</a>.

</td></tr>
</table>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000051-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000051-source">
<pre>
     <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 292</span>
292:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">nest</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">configurable_class</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">attributes</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
293:       <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">merge_attributes</span>(<span class="ruby-identifier">block</span>, <span class="ruby-identifier">attributes</span>)
294:       <span class="ruby-identifier">attributes</span> = {
295:         <span class="ruby-identifier">:reader</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
296:         <span class="ruby-identifier">:writer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
297:         <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:nest</span>
298:       }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">attributes</span>)
299:       
300:       <span class="ruby-comment cmt"># define the nested configurable</span>
301:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">configurable_class</span>
302:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
303:           <span class="ruby-identifier">configurable_class</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">configurable_class</span>)
304:           <span class="ruby-identifier">configurable_class</span>.<span class="ruby-identifier">class_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
305:         <span class="ruby-keyword kw">end</span>
306:       <span class="ruby-keyword kw">else</span>
307:         <span class="ruby-identifier">configurable_class</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span> { <span class="ruby-identifier">include</span> <span class="ruby-constant">Configurable</span> }
308:         <span class="ruby-identifier">configurable_class</span>.<span class="ruby-identifier">class_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
309:       <span class="ruby-keyword kw">end</span>
310:       
311:       <span class="ruby-comment cmt"># set the new constant</span>
312:       <span class="ruby-identifier">const_name</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:const_name</span>) 
313:         <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:const_name</span>) 
314:       <span class="ruby-keyword kw">else</span>
315:         <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">capitalize</span>
316:       <span class="ruby-keyword kw">end</span>
317:       
318:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">const_name</span>
319:         <span class="ruby-comment cmt"># this prevents a warning in cases where the nesting</span>
320:         <span class="ruby-comment cmt"># class defines the configurable_class</span>
321:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">const_defined?</span>(<span class="ruby-identifier">const_name</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">const_name</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">configurable_class</span>
322:           <span class="ruby-identifier">const_set</span>(<span class="ruby-identifier">const_name</span>, <span class="ruby-identifier">configurable_class</span>)
323:         <span class="ruby-keyword kw">end</span>
324:       <span class="ruby-keyword kw">end</span>
325:       <span class="ruby-identifier">const_name</span> = <span class="ruby-keyword kw">nil</span>
326:       
327:       <span class="ruby-comment cmt"># define the reader.</span>
328:       <span class="ruby-identifier">reader</span> = <span class="ruby-identifier">define_attribute_method</span>(<span class="ruby-identifier">:reader</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">key</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attribute</span><span class="ruby-operator">|</span>
329:         <span class="ruby-identifier">attr_reader</span> <span class="ruby-identifier">attribute</span>
330:         <span class="ruby-identifier">public</span>(<span class="ruby-identifier">attribute</span>)
331:       <span class="ruby-keyword kw">end</span>
332:       
333:       <span class="ruby-comment cmt"># define the writer.  the default the writer validates the</span>
334:       <span class="ruby-comment cmt"># instance is the correct class then sets the instance variable</span>
335:       <span class="ruby-identifier">instance_variable</span> = <span class="ruby-node">&quot;@#{key}&quot;</span>.<span class="ruby-identifier">to_sym</span>
336:       <span class="ruby-identifier">writer</span> = <span class="ruby-identifier">define_attribute_method</span>(<span class="ruby-identifier">:writer</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-node">&quot;#{key}=&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attribute</span><span class="ruby-operator">|</span>
337:         <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">attribute</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
338:           <span class="ruby-constant">Validation</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">value</span>, [<span class="ruby-identifier">configurable_class</span>])
339:           <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">instance_variable</span>, <span class="ruby-identifier">value</span>)
340:         <span class="ruby-keyword kw">end</span>
341:         <span class="ruby-identifier">public</span>(<span class="ruby-identifier">attribute</span>)
342:       <span class="ruby-keyword kw">end</span>
343:       
344:       <span class="ruby-comment cmt"># define the configuration</span>
345:       <span class="ruby-identifier">init</span> = <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">:init</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:init</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">true</span>
346:       <span class="ruby-identifier">config_registry</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-constant">NestConfig</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">configurable_class</span>, <span class="ruby-identifier">reader</span>, <span class="ruby-identifier">writer</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">init</span>)
347:       <span class="ruby-identifier">check_infinite_nest</span>(<span class="ruby-identifier">configurable_class</span>)
348:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000052" class="method-detail">
        <a name="M000052"></a>

        <div class="method-heading">
          <a href="#M000052" class="method-signature">
          <span class="method-name">remove_config</span><span class="method-args">(key, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Removes a configuration much like remove_method removes a method. The
reader and writer for the <a href="ClassMethods.html#M000049">config</a>
are likewise removed. Nested configs can be removed using this method.
</p>
<p>
Setting :reader or :writer to false in the options prevents those methods
from being removed.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000052-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000052-source">
<pre>
     <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 357</span>
357:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">remove_config</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>={})
358:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">config_registry</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">key</span>)
359:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NameError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{key.inspect} is not a config on #{self}&quot;</span>)
360:       <span class="ruby-keyword kw">end</span>
361:       
362:       <span class="ruby-identifier">options</span> = {
363:         <span class="ruby-identifier">:reader</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
364:         <span class="ruby-identifier">:writer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
365:       }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
366:       
367:       <span class="ruby-identifier">config</span> = <span class="ruby-identifier">config_registry</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
368:       <span class="ruby-identifier">cache_configurations</span>(<span class="ruby-ivar">@configurations</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>)
369:       
370:       <span class="ruby-identifier">undef_method</span>(<span class="ruby-identifier">config</span>.<span class="ruby-identifier">reader</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:reader</span>]
371:       <span class="ruby-identifier">undef_method</span>(<span class="ruby-identifier">config</span>.<span class="ruby-identifier">writer</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:writer</span>]
372:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000053" class="method-detail">
        <a name="M000053"></a>

        <div class="method-heading">
          <a href="#M000053" class="method-signature">
          <span class="method-name">undef_config</span><span class="method-args">(key, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Undefines a configuration much like undef_method undefines a method. The
reader and writer for the <a href="ClassMethods.html#M000049">config</a>
are likewise undefined. Nested configs can be undefined using this method.
</p>
<p>
Setting :reader or :writer to false in the options prevents those methods
from being undefined.
</p>
<h4>Implementation Note</h4>
<p>
Configurations are undefined by setting the key to nil in the registry.
Deleting the <a href="ClassMethods.html#M000049">config</a> is not
sufficient because the registry needs to convey to self and subclasses to
not inherit the <a href="ClassMethods.html#M000049">config</a> from
ancestors.
</p>
<p>
This is unlike <a href="ClassMethods.html#M000052">remove_config</a> where
the <a href="ClassMethods.html#M000049">config</a> is simply deleted from
the config_registry.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000053-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000053-source">
<pre>
     <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 390</span>
390:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">undef_config</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span>={})
391:       <span class="ruby-comment cmt"># temporarily cache as an optimization</span>
392:       <span class="ruby-identifier">configs</span> = <span class="ruby-identifier">configurations</span>
393:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">configs</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">key</span>)
394:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NameError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{key.inspect} is not a config on #{self}&quot;</span>)
395:       <span class="ruby-keyword kw">end</span>
396:       
397:       <span class="ruby-identifier">options</span> = {
398:         <span class="ruby-identifier">:reader</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
399:         <span class="ruby-identifier">:writer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>
400:       }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
401:       
402:       <span class="ruby-identifier">config</span> = <span class="ruby-identifier">configs</span>[<span class="ruby-identifier">key</span>]
403:       <span class="ruby-identifier">config_registry</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-keyword kw">nil</span>
404:       <span class="ruby-identifier">cache_configurations</span>(<span class="ruby-ivar">@configurations</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>)
405:       
406:       <span class="ruby-identifier">undef_method</span>(<span class="ruby-identifier">config</span>.<span class="ruby-identifier">reader</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:reader</span>]
407:       <span class="ruby-identifier">undef_method</span>(<span class="ruby-identifier">config</span>.<span class="ruby-identifier">writer</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:writer</span>]
408:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000048" class="method-detail">
        <a name="M000048"></a>

        <div class="method-heading">
          <a href="#M000048" class="method-signature">
          <span class="method-name">use_indifferent_access</span><span class="method-args">(input=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets <a href="ClassMethods.html#M000046">configurations</a> to symbolize
keys for AGET ([]) and ASET([]=) operations, or not. By default, <a
href="ClassMethods.html#M000046">configurations</a> will use indifferent
access.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000048-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000048-source">
<pre>
     <span class="ruby-comment cmt"># File lib/configurable/class_methods.rb, line 93</span>
 93:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">use_indifferent_access</span>(<span class="ruby-identifier">input</span>=<span class="ruby-keyword kw">true</span>)
 94:       <span class="ruby-ivar">@use_indifferent_access</span> = <span class="ruby-identifier">input</span>
 95:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@configurations</span>
 96:       
 97:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@use_indifferent_access</span>
 98:         <span class="ruby-ivar">@configurations</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">IndifferentAccess</span>)
 99:       <span class="ruby-keyword kw">else</span>
100:         <span class="ruby-ivar">@configurations</span> = <span class="ruby-ivar">@configurations</span>.<span class="ruby-identifier">dup</span>
101:       <span class="ruby-keyword kw">end</span>
102:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>