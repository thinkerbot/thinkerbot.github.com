<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: README</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>README</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>README
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sun Jul 24 13:54:15 -0600 2011</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1><a href="http://tap.rubyforge.org/configurable">Configurable</a></h1>
<p>
Class configurations that map to the command line.
</p>
<h2>Description</h2>
<p>
<a href="../classes/Configurable.html">Configurable</a> allows the
declaration of class configurations. Configurations are inheritable,
delegate to methods, and have hash-like access. <a
href="../classes/Configurable.html">Configurable</a> maps configurations to
the command line through <a
href="../classes/ConfigParser.html">ConfigParser</a> and is used by the <a
href="http://tap.rubyforge.org">Tap</a> framework.
</p>
<p>
Check out these links for development and bug tracking.
</p>
<ul>
<li><a href="http://tap.rubyforge.org/configurable">Website</a>

</li>
<li><a href="http://github.com/bahuvrihi/configurable/tree/master">Github</a>

</li>
<li><a href="http://groups.google.com/group/ruby-on-tap">Google Group</a>

</li>
</ul>
<h4>Minimal Example</h4>
<p>
Include <a href="../classes/Configurable.html">Configurable</a> and declare
configurations using the config method. Configs now have accessors and
initialize with the default value.
</p>
<pre>
  class ConfigClass
    include Configurable
    config :key, 'default', :short =&gt; 'k'   # a sample config
  end

  c = ConfigClass.new
  c.key                   # =&gt; 'default'
  c.key = 'new value'
  c.config[:key]          # =&gt; 'new value'
</pre>
<p>
Use a <a href="../classes/ConfigParser.html">ConfigParser</a> to parse
configurations from the command line. Non-class options may be defined with
(mostly) the same syntax as <a
href="http://www.ruby-doc.org/core/classes/OptionParser.html">OptionParser</a>:
</p>
<pre>
  parser = ConfigParser.new

  # add class configurations
  parser.add(ConfigClass.configurations)

  # define an option a-la OptionParser
  parser.on '-s', '--long ARGUMENT', 'description' do |value|
    parser[:long] = value
  end

  parser.parse &quot;one two --key value -s VALUE three&quot;
  # =&gt; ['one', 'two', 'three']

  parser.config
  # =&gt; {
  # :key =&gt; 'value',
  # :long =&gt; 'VALUE'
  # }

  &quot;\n&quot; + parser.to_s
  # =&gt; %Q{
  #    -k, --key KEY                    a sample config
  #    -s, --long ARGUMENT              description
  # }
</pre>
<h2>Usage</h2>
<p>
The config method is used to declare class configurations. A block may be
provided to validate/transform inputs; many standard validations are
available through the &#8216;c&#8217; method (an alias for the <a
href="../classes/Configurable/Validation.html">Validation</a> module).
</p>
<pre>
  class ConfigClass
    include Configurable

    # basic #

    config :key, 'default'                    # a simple config
    config :flag, false, &amp;c.flag              # a flag config
    config :switch, false, &amp;c.switch          # a --[no-]switch config
    config :num, 10, &amp;c.integer               # integer only

    # fancy #

    config :range, 1..10, &amp;c.range            # specifies a range
    config :select, 'a', &amp;c.select('a','b')   # value must be 'a' or 'b'
    config :list, [], &amp;c.list                 # allows a list of entries

    # custom #

    config :upcase, 'default' do |value|      # custom transformation
      value.upcase
    end

    config :alt, 'default',                   # alternative flags
      :short =&gt; 's',
      :long =&gt; 'long',
      :arg_name =&gt; 'CUSTOM'

    # Initializes a new instance, setting the overriding configs.
    def initialize(config={})
      initialize_config(config)
    end
  end
</pre>
<p>
<a href="../classes/ConfigParser.html">ConfigParser</a> uses the config
declarations to parse configurations and to make a documented help string:
</p>
<pre>
  parser = ConfigParser.new
  parser.add(ConfigClass.configurations)

  parser.parse &quot;a b --key=value --flag --no-switch --num 8 c&quot;
  # =&gt; ['a', 'b', 'c']

  parser.config
  # =&gt; {
  # :key =&gt; 'value',
  # :flag =&gt; true,
  # :switch =&gt; false,
  # :num =&gt; '8',
  # :range =&gt; 1..10,
  # :select =&gt; 'a',
  # :list =&gt; [],
  # :upcase =&gt; 'default',
  # :alt =&gt; 'default'
  # }

  &quot;\n&quot; + parser.to_s
  # =&gt; %Q{
  #        --key KEY                    a simple config
  #        --flag                       a flag config
  #        --[no-]switch                a --[no-]switch config
  #        --num NUM                    integer only
  #        --range RANGE                specifies a range
  #        --select SELECT              value must be 'a' or 'b'
  #        --list LIST                  allows a list of entries
  #        --upcase UPCASE              custom transformation
  #    -s, --long CUSTOM                alternative flags
  # }
</pre>
<p>
<a href="../classes/Configurable.html">Configurable</a> classes typically
call initialize_config to set configurations during initialization. The
validation/transformation blocks are called as configurations are set.
Notice how the :num and :upcase configs are translated on the instance:
</p>
<pre>
  c = ConfigClass.new(parser.config)
  c.config.to_hash
  # =&gt; {
  # :key =&gt; 'value',
  # :flag =&gt; true,
  # :switch =&gt; false,
  # :num =&gt; 8,                    # no longer a string
  # :range =&gt; 1..10,
  # :select =&gt; 'a',
  # :list =&gt; [],
  # :upcase =&gt; 'DEFAULT',         # no longer downcase
  # :alt =&gt; 'default'
  # }
</pre>
<p>
Configurations automatically generate accessors (the blocks are basically
writer methods), and may be accessed through the config object.
Configurations are validated every time they are set, regardless of whether
they are set through an accessor or config.
</p>
<pre>
  c.upcase                    # =&gt; 'DEFAULT'

  c.config[:upcase] = 'neW valuE'
  c.upcase                    # =&gt; 'NEW VALUE'

  c.upcase = 'fiNal Value'
  c.config[:upcase]           # =&gt; 'FINAL VALUE'

  c.select = 'b'              # ok
  c.select = 'c'              # !&gt; ValidationError
  c.config[:select] = 'c'     # !&gt; ValidationError
</pre>
<p>
By default config treats string and symbol keys identically, making YAML an
obvious choice for configuration files.
</p>
<pre>
  yaml_str = %Q{
  key: a new value
  flag: false
  range: 1..100
  }

  c.reconfigure(YAML.load(yaml_str))
  c.config.to_hash
  # =&gt; {
  # :key =&gt; 'a new value',
  # :flag =&gt; false,
  # :switch =&gt; false,
  # :num =&gt; 8,
  # :range =&gt; 1..100,
  # :select =&gt; 'b',
  # :list =&gt; [],
  # :upcase =&gt; 'FINAL VALUE',
  # :alt =&gt; 'default'
  # }
</pre>
<p>
See the <a href="../classes/Configurable.html">Configurable</a> module for
more details.
</p>
<h2>Installation</h2>
<p>
<a href="../classes/Configurable.html">Configurable</a> is available as a
gem on <a href="http://gemcutter.org/gems/configurable">Gemcutter</a>.
</p>
<pre>
  % gem install configurable
</pre>
<h2>Info</h2>
<table>
<tr><td valign="top">Developer:</td><td><a href="http://bahuvrihi.wordpress.com">Simon Chiang</a>

</td></tr>
<tr><td valign="top">License:</td><td><a href="MIT-LICENSE.html">MIT-Style</a>

</td></tr>
</table>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>