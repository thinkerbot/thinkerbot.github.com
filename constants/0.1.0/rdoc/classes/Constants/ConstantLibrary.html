<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Constants::ConstantLibrary</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Constants::ConstantLibrary</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/constants/constant_library_rb.html">
                lib/constants/constant_library.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="ConstantLibrary.html">ConstantLibrary</a> facilitates indexing and
collection of a set of values.
</p>
<pre>
  lib = ConstantLibrary.new('one', 'two', :three)
  lib.index_by('upcase') {|value| value.to_s.upcase }
  lib.indicies['upcase']      # =&gt; {'ONE' =&gt; 'one', 'TWO' =&gt; 'two', 'THREE' =&gt; :three}

  lib.collect(&quot;string&quot;) {|value| value.to_s }
  lib.collections['string']   # =&gt; ['one', 'two', 'three']
</pre>
<p>
See <a href="Library.html">Constants::Library</a> for more details.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000101">[]</a>&nbsp;&nbsp;
      <a href="#M000103">add</a>&nbsp;&nbsp;
      <a href="#M000104">add_constants_from</a>&nbsp;&nbsp;
      <a href="#M000102">clear</a>&nbsp;&nbsp;
      <a href="#M000099">collect</a>&nbsp;&nbsp;
      <a href="#M000100">collect_attribute</a>&nbsp;&nbsp;
      <a href="#M000097">index_by</a>&nbsp;&nbsp;
      <a href="#M000098">index_by_attribute</a>&nbsp;&nbsp;
      <a href="#M000096">new</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">

    <div id="class-list">
      <h3 class="section-bar">Classes and Modules</h3>

      Class <a href="ConstantLibrary/Collection.html" class="link">Constants::ConstantLibrary::Collection</a><br />
Class <a href="ConstantLibrary/Index.html" class="link">Constants::ConstantLibrary::Index</a><br />

    </div>




    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">collections</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A hash of (name, collection) pairs tracking the collections in self

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">indicies</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A hash of (name, index) pairs tracking the indicies in self

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">values</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
An array of values in the library

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000096" class="method-detail">
        <a name="M000096"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000096.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000096.html');return false;">
          <span class="method-name">new</span><span class="method-args">(*values)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000101" class="method-detail">
        <a name="M000101"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000101.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000101.html');return false;">
          <span class="method-name">[]</span><span class="method-args">(key)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Lookup values by a key. All indicies will be searched in order; the first
matching value is returned. Returns nil if no matches are found.
</p>
        </div>
      </div>

      <div id="method-M000103" class="method-detail">
        <a name="M000103"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000103.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000103.html');return false;">
          <span class="method-name">add</span><span class="method-args">(*values)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add the specified values to self. New values are incorporated into existing
indicies and collections. Returns the values added (ie values minus any
already-existing values).
</p>
        </div>
      </div>

      <div id="method-M000104" class="method-detail">
        <a name="M000104"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000104.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000104.html');return false;">
          <span class="method-name">add_constants_from</span><span class="method-args">(mod) {|const| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds the constants from the specified module. If mod is a Class, then only
constants that are a kind of mod will be added. This behavior can be
altered by providing a block which each constant value; values are only
included if the block evaluates to true.
</p>
        </div>
      </div>

      <div id="method-M000102" class="method-detail">
        <a name="M000102"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000102.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000102.html');return false;">
          <span class="method-name">clear</span><span class="method-args">(complete=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Clears all values, from self, indicies, and collections. The indicies, and
collections themselves are preserved unless complete==true.
</p>
        </div>
      </div>

      <div id="method-M000099" class="method-detail">
        <a name="M000099"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000099.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000099.html');return false;">
          <span class="method-name">collect</span><span class="method-args">(name) {|value| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a collection to self for all values currently in self. The block is
used to calculate the values in the collection. The block receives each
value in self and should return one of the following:
</p>
<ul>
<li>a value to be pushed onto the collection

</li>
<li>a [value, index] array when an alternate value should be stored in the
place of value, or when the value should be at a special index in the
collection. When multiple values are directed to the same index, they are
stashed into an array.

</li>
<li>nil to exclude the value from the collection

</li>
</ul>
<p>
For example:
</p>
<pre>
  lib = ConstantLibrary.new('one', 'two', :three)
  lib.collect(&quot;string&quot;) {|value| value.to_s }
  lib.collections['string']   # =&gt; ['one', 'two', 'three']

  lib.collect(&quot;length&quot;) {|value| [value, value.to_s.length] }
  lib.collections['length']   # =&gt; [nil, nil, nil, ['one', 'two'], nil, :three]
</pre>
<p>
Works much like <a href="ConstantLibrary.html#M000097">index_by</a>, except
that the underlying data store for a collection is a <a
href="ConstantLibrary/Collection.html">Collection</a> (ie an array) rather
than an <a href="ConstantLibrary/Index.html">Index</a> (a hash).
</p>
        </div>
      </div>

      <div id="method-M000100" class="method-detail">
        <a name="M000100"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000100.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000100.html');return false;">
          <span class="method-name">collect_attribute</span><span class="method-args">(attribute)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds a collection using the attribute or method. Equivalent to:
</p>
<pre>
  lib.collect(attribute) {|value| value.attribute }
</pre>
        </div>
      </div>

      <div id="method-M000097" class="method-detail">
        <a name="M000097"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000097.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000097.html');return false;">
          <span class="method-name">index_by</span><span class="method-args">(name, exclusion_value=nil, nil_value=nil) {|value| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an index to self for all values currently in self. The block is used
to specify keys for each value in self; it receives each value and should
return one of the following:
</p>
<ul>
<li>a key

</li>
<li>a [key, value] array when an alternate value should be stored in the place
of value

</li>
<li>the exclusion_value to exclude the value from the index

</li>
</ul>
<p>
When multiple values return the same key, they are stashed into an array.
</p>
<pre>
  lib = ConstantLibrary.new('one', 'two', :one)
  lib.index_by(&quot;string&quot;) {|value| value.to_s }
  lib.indicies['string']
  # =&gt; {
  # 'one' =&gt; ['one', :one],
  # 'two' =&gt; 'two'}
</pre>
<p>
Existing indicies by the specified name are overwritten.
</p>
<h4>nil values</h4>
<p>
The index stores it&#8216;s data in an <a
href="ConstantLibrary/Index.html">Index</a> (ie a Hash) where nil_value
acts as the default value returned for non-existant keys as well as the
stash nil_value. Hence <a href="ConstantLibrary.html#M000097">index_by</a>
will raise an error if you try to store the nil_value.
</p>
<p>
This behavior can be seen when the exclusion value is set to something
other than nil, so that the nil value isn&#8216;t skipped outright:
</p>
<pre>
  # the nil will cause trouble
  lib = ConstantLibrary.new(1,2,nil)
  lib.index_by(&quot;error&quot;, false, nil) {|value| value }  # ! ArgumentError
</pre>
<p>
Specify an alternate nil_value (and exclusion value) to index nils; a plain
old Object works well.
</p>
<pre>
  obj = Object.new
  index = lib.index_by(&quot;ok&quot;, false, obj) {|value| value }
  index[1]                 # =&gt; 1
  index[nil]               # =&gt; nil

  # remember the nil_value is the default value
  index['non-existant']    # =&gt; obj
</pre>
        </div>
      </div>

      <div id="method-M000098" class="method-detail">
        <a name="M000098"></a>

        <div class="method-heading">
          <a href="ConstantLibrary.src/M000098.html" target="Code" class="method-signature"
            onclick="popupCode('ConstantLibrary.src/M000098.html');return false;">
          <span class="method-name">index_by_attribute</span><span class="method-args">(attribute, exclusion_value=nil, nil_value=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Adds an index using the attribute or method. Equivalent to:
</p>
<pre>
  lib.index_by(attribute) {|value| value.attribute }
</pre>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>