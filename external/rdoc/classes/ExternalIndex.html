<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: ExternalIndex</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">ExternalIndex</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/external_index_rb.html">
                lib/external_index.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="External/Base.html">
                External::Base
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Provides array-like access to index data kept on disk. Index data is
defined by a packing format (see Array#pack) like &#8216;II&#8217;, which
would represent two integers; in this case <a
href="ExternalIndex.html#M000023">each</a> member of the <a
href="ExternalIndex.html">ExternalIndex</a> would be a two-integer array.
</p>
<p>
All directives except &#8217;@&#8217; and &#8216;X&#8217; are allowed, in
any combination.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000013">+</a>&nbsp;&nbsp;
      <a href="#M000014">&lt;&lt;</a>&nbsp;&nbsp;
      <a href="#M000015">&lt;=&gt;</a>&nbsp;&nbsp;
      <a href="#M000016">==</a>&nbsp;&nbsp;
      <a href="#M000001">[]</a>&nbsp;&nbsp;
      <a href="#M000017">[]</a>&nbsp;&nbsp;
      <a href="#M000018">[]=</a>&nbsp;&nbsp;
      <a href="#M000012">another</a>&nbsp;&nbsp;
      <a href="#M000019">at</a>&nbsp;&nbsp;
      <a href="#M000006">buffer_size</a>&nbsp;&nbsp;
      <a href="#M000007">buffer_size=</a>&nbsp;&nbsp;
      <a href="#M000020">clear</a>&nbsp;&nbsp;
      <a href="#M000021">compact</a>&nbsp;&nbsp;
      <a href="#M000022">concat</a>&nbsp;&nbsp;
      <a href="#M000008">default_blksize=</a>&nbsp;&nbsp;
      <a href="#M000004">default_nil_value</a>&nbsp;&nbsp;
      <a href="#M000003">directive_size</a>&nbsp;&nbsp;
      <a href="#M000023">each</a>&nbsp;&nbsp;
      <a href="#M000024">each_index</a>&nbsp;&nbsp;
      <a href="#M000025">first</a>&nbsp;&nbsp;
      <a href="#M000010">index_attrs</a>&nbsp;&nbsp;
      <a href="#M000026">last</a>&nbsp;&nbsp;
      <a href="#M000027">length</a>&nbsp;&nbsp;
      <a href="#M000005">new</a>&nbsp;&nbsp;
      <a href="#M000009">nil_value</a>&nbsp;&nbsp;
      <a href="#M000028">nitems</a>&nbsp;&nbsp;
      <a href="#M000011">options</a>&nbsp;&nbsp;
      <a href="#M000034">pos</a>&nbsp;&nbsp;
      <a href="#M000035">pos=</a>&nbsp;&nbsp;
      <a href="#M000029">push</a>&nbsp;&nbsp;
      <a href="#M000002">read</a>&nbsp;&nbsp;
      <a href="#M000038">read</a>&nbsp;&nbsp;
      <a href="#M000036">readbytes</a>&nbsp;&nbsp;
      <a href="#M000030">reverse_each</a>&nbsp;&nbsp;
      <a href="#M000031">size</a>&nbsp;&nbsp;
      <a href="#M000032">to_a</a>&nbsp;&nbsp;
      <a href="#M000040">unframed_write</a>&nbsp;&nbsp;
      <a href="#M000037">unpack</a>&nbsp;&nbsp;
      <a href="#M000033">values_at</a>&nbsp;&nbsp;
      <a href="#M000039">write</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">DEFAULT_BUFFER_SIZE</td>
          <td>=</td>
          <td class="context-item-value">8 * 2**20</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The default buffer <a href="ExternalIndex.html#M000031">size</a> (8Mb)

</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">format</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The format of the indexed data. Format may be optimized from the original
input format in cases like &#8216;III&#8217; where bulk processing is
useful.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">frame</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The number of elements in <a href="ExternalIndex.html#M000023">each</a>
entry, ex: (&#8216;I&#8217; =&gt; 1, &#8216;III&#8217; =&gt; 3). frame is
calculated from format.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">frame_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The number of bytes required for <a
href="ExternalIndex.html#M000023">each</a> entry; frame_size is calculated
from format.

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">process_in_bulk</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
A flag indicating whether or not the format was optimized to pack/unpack
entries in bulk; proccess_in_bulk is automatically set according to format.

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000001" class="method-detail">
        <a name="M000001"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000001.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000001.html');return false;">
          <span class="method-name">[]</span><span class="method-args">(*argv)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Initializes a <a href="ExternalIndex.html#M000005">new</a> <a
href="ExternalIndex.html">ExternalIndex</a> using an array-like [] syntax.
The <a href="ExternalIndex.html#M000026">last</a> argument may be an <a
href="ExternalIndex.html#M000011">options</a> hash (this is ok since <a
href="ExternalIndex.html">ExternalIndex</a> cannot store a Hash anyhow).
</p>
        </div>
      </div>

      <div id="method-M000004" class="method-detail">
        <a name="M000004"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000004.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000004.html');return false;">
          <span class="method-name">default_nil_value</span><span class="method-args">(format, frame)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of zeros in the specified frame.
</p>
        </div>
      </div>

      <div id="method-M000003" class="method-detail">
        <a name="M000003"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000003.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000003.html');return false;">
          <span class="method-name">directive_size</span><span class="method-args">(directive)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the number of bytes required to pack an item in an array using the
directive (see Array.pack for more details). All directives return a <a
href="ExternalIndex.html#M000031">size</a> except the positioning
directives &#8217;@&#8217; and &#8216;X&#8217;; these and all other unknown
directives return nil.
</p>
<pre>
  Directives          N bytes
  ------------------------------
  AaBbCcHhUwxZ     |   1
  nSsv             |   2
  M                |   3
  eFfgIiLlNPpV     |   4
  m                |   5
  u                |   6
  DdEGQq           |   8
  @X               |   nil
</pre>
        </div>
      </div>

      <div id="method-M000005" class="method-detail">
        <a name="M000005"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000005.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000005.html');return false;">
          <span class="method-name">new</span><span class="method-args">(io=nil, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000002" class="method-detail">
        <a name="M000002"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000002.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000002.html');return false;">
          <span class="method-name">read</span><span class="method-args">(fd, options={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Opens and reads the file into an array.
</p>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000013.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000013.html');return false;">
          <span class="method-name">+</span><span class="method-args">(another)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
def *(arg)
</p>
<pre>
  not_implemented
</pre>
<p>
end
</p>
        </div>
      </div>

      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000014.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000014.html');return false;">
          <span class="method-name">&lt;&lt;</span><span class="method-args">(array)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Differs from the Array &lt;&lt; in that multiple entries can be shifted on
<a href="ExternalIndex.html#M000019">at</a> once.
</p>
        </div>
      </div>

      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000015.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000015.html');return false;">
          <span class="method-name">&lt;=&gt;</span><span class="method-args">(another)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000016" class="method-detail">
        <a name="M000016"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000016.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000016.html');return false;">
          <span class="method-name">==</span><span class="method-args">(another)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000017.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000017.html');return false;">
          <span class="method-name">[]</span><span class="method-args">(one, two = nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Element Reference — Returns the entry <a
href="ExternalIndex.html#M000019">at</a> index, or returns an array
starting <a href="ExternalIndex.html#M000019">at</a> start and continuing
for <a href="ExternalIndex.html#M000027">length</a> entries, or returns an
array specified by range. Negative indices count backward from the end of
self (-1 is the <a href="ExternalIndex.html#M000026">last</a> element).
Returns nil if the index (or starting index) is out of range.
</p>
<pre>
  index = ExternalIndex[1,2,3,4,5]
  index[2]                   #=&gt; [3]
  index[6]                   #=&gt; nil
  index[1, 2]                #=&gt; [[2],[3]]
  index[1..3]                #=&gt; [[2],[3],[4]]
  index[4..7]                #=&gt; [[5]]
  index[6..10]               #=&gt; nil
  index[-3, 3]               #=&gt; [[3],[4],[5]]

  # special cases
  index[5]                   #=&gt; nil
  index[5, 1]                #=&gt; []
  index[5..10]               #=&gt; []
</pre>
<p>
Note that entries are returned in frame.
</p>
        </div>
      </div>

      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000018.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000018.html');return false;">
          <span class="method-name">[]=</span><span class="method-args">(*args)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Element Assignment — Sets the entry <a
href="ExternalIndex.html#M000019">at</a> index, or replaces a subset
starting <a href="ExternalIndex.html#M000019">at</a> start and continuing
for <a href="ExternalIndex.html#M000027">length</a> entries, or replaces a
subset specified by range. A negative indices will count backward from the
end of self. Inserts elements if <a
href="ExternalIndex.html#M000027">length</a> is zero. If nil is used in the
second and third form, deletes elements from self. An IndexError is raised
if a negative index points past the beginning of self. See also <a
href="ExternalIndex.html#M000029">push</a>, and unshift.
</p>
<pre>
  index = ExternalIndex.new(&quot;&quot;, :format =&gt; 'I')
  index.nil_value                       # =&gt; [0]
  index[4] = [4]; index                 # =&gt; [[0], [0], [0], [0], [4]]
  index[0, 3] = [[1], [2], [3]]; index  # =&gt; [[1], [2], [3], [0], [4]]
  index[1..2] = [[5], [6]]; index       # =&gt; [[1], [5], [6], [0], [4]]
  index[0, 2] = [[7]]; index            # =&gt; [[7], [6], [0], [4]]
  index[0..2] = [[8]]; index            # =&gt; [[8], [4]]
  index[-1]   = [9]; index              # =&gt; [[8], [9]]
  index[1..-1] = nil; index             # =&gt; [[8]]
</pre>
<h3>Differences from Array#[]=</h3>
<p>
<a href="ExternalIndex.html">ExternalIndex</a>#[]= can only take entries in
frame. This means that for individual assignments, a framed array must be
given; in the case of [start, <a
href="ExternalIndex.html#M000027">length</a>] and range insertions, an
array of framed arrays must be given. Nils are allowed in both cases, and
are treated the same as in Array (although insertions replace nil with the
<a href="ExternalIndex.html#M000009">nil_value</a> for self).
</p>
<pre>
  index = ExternalIndex.new(&quot;&quot;, :format =&gt; 'II')
  index.nil_value                       # =&gt; [0,0]

  index[0] = [1,2]; index               # =&gt; [[1,2]]
  index[1] = nil; index                 # =&gt; [[1,2], [0,0]]

  index[0,2] = [[1,2],[3,4]]; index     # =&gt; [[1,2], [3,4]]
  index[1..3] = [[5,6],[7,8]]; index    # =&gt; [[1,2], [5,6], [7,8]]
  index[0,3] = nil; index               # =&gt; []
</pre>
<p>
Another <a href="ExternalIndex.html">ExternalIndex</a> with the same frame,
format, and <a href="ExternalIndex.html#M000009">nil_value</a> (ie <a
href="ExternalIndex.html#M000010">index_attrs</a>) may be used as an input
to [start, <a href="ExternalIndex.html#M000027">length</a>] and range
insertions.
</p>
<h3>Performance</h3>
<p>
Range insertions may require a full copy/rewrite of an <a
href="ExternalIndex.html">ExternalIndex</a> io. For very large instances,
this obviously can be quite slow; the cases to watch out for are:
</p>
<ul>
<li>insertion of self into self (worst case)

</li>
<li>insertion of values with lengths that do not match the insertion <a
href="ExternalIndex.html#M000027">length</a>

</li>
</ul>
<p>
For example:
</p>
<pre>
  index = ExternalIndex.new(&quot;&quot;)
  index[0,1] = index
  index[0,3] = [[1], [2]]
  index[0...3] = [[1], [2], [3], [4]]
</pre>
        </div>
      </div>

      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000012.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000012.html');return false;">
          <span class="method-name">another</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns <a href="ExternalIndex.html#M000012">another</a> instance of
self.class, initialized with the current <a
href="ExternalIndex.html#M000011">options</a> of self.
</p>
        </div>
      </div>

      <div id="method-M000019" class="method-detail">
        <a name="M000019"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000019.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000019.html');return false;">
          <span class="method-name">at</span><span class="method-args">(index)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns entry <a href="ExternalIndex.html#M000019">at</a> index
</p>
        </div>
      </div>

      <div id="method-M000006" class="method-detail">
        <a name="M000006"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000006.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000006.html');return false;">
          <span class="method-name">buffer_size</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the buffer <a href="ExternalIndex.html#M000031">size</a> of self
(equal to io.default_blksize and default_blksize * frame_size). Buffer <a
href="ExternalIndex.html#M000031">size</a> specifies the memory available
for io perform external operations.
</p>
        </div>
      </div>

      <div id="method-M000007" class="method-detail">
        <a name="M000007"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000007.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000007.html');return false;">
          <span class="method-name">buffer_size=</span><span class="method-args">(buffer_size)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the buffer <a href="ExternalIndex.html#M000031">size</a> of self (as
well as io.default_blksize and self.default_blksize). See <a
href="ExternalIndex.html#M000006">buffer_size</a>.
</p>
        </div>
      </div>

      <div id="method-M000020" class="method-detail">
        <a name="M000020"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000020.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000020.html');return false;">
          <span class="method-name">clear</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Removes all elements from <em>self</em>.
</p>
        </div>
      </div>

      <div id="method-M000021" class="method-detail">
        <a name="M000021"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000021.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000021.html');return false;">
          <span class="method-name">compact</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of self with all nil entries removed. Nil entries are those
which equal <a href="ExternalIndex.html#M000009">nil_value</a>.
</p>
<p>
<em>potentially expensive</em>
</p>
        </div>
      </div>

      <div id="method-M000022" class="method-detail">
        <a name="M000022"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000022.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000022.html');return false;">
          <span class="method-name">concat</span><span class="method-args">(another)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Appends the entries in <a href="ExternalIndex.html#M000012">another</a> to
self. Another may be an array of entries (in frame), or <a
href="ExternalIndex.html#M000012">another</a> <a
href="ExternalIndex.html">ExternalIndex</a> with corresponding <a
href="ExternalIndex.html#M000010">index_attrs</a>.
</p>
<p>
<em>potentially expensive</em> especially if <a
href="ExternalIndex.html#M000012">another</a> is very large, or if it must
be loaded into memory to be concatenated, ie when cached? = true.
</p>
        </div>
      </div>

      <div id="method-M000008" class="method-detail">
        <a name="M000008"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000008.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000008.html');return false;">
          <span class="method-name">default_blksize=</span><span class="method-args">(value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the default_blksize of self. See <a
href="ExternalIndex.html#M000006">buffer_size</a>.
</p>
        </div>
      </div>

      <div id="method-M000023" class="method-detail">
        <a name="M000023"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000023.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000023.html');return false;">
          <span class="method-name">each</span><span class="method-args">() {|entry| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Calls block once for <a href="ExternalIndex.html#M000023">each</a> entry in
self, passing that entry as a parameter.
</p>
        </div>
      </div>

      <div id="method-M000024" class="method-detail">
        <a name="M000024"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000024.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000024.html');return false;">
          <span class="method-name">each_index</span><span class="method-args">() {|index| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="ExternalIndex.html#M000023">each</a>, but passes the index
of the entry instead of the entry itself.
</p>
        </div>
      </div>

      <div id="method-M000025" class="method-detail">
        <a name="M000025"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000025.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000025.html');return false;">
          <span class="method-name">first</span><span class="method-args">(n=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="ExternalIndex.html#M000025">first</a> n entries
(default 1)
</p>
        </div>
      </div>

      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000010.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000010.html');return false;">
          <span class="method-name">index_attrs</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
An array of the index attributes of self: [frame, format, <a
href="ExternalIndex.html#M000009">nil_value</a>]
</p>
        </div>
      </div>

      <div id="method-M000026" class="method-detail">
        <a name="M000026"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000026.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000026.html');return false;">
          <span class="method-name">last</span><span class="method-args">(n=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the <a href="ExternalIndex.html#M000026">last</a> n entries
(default 1)
</p>
        </div>
      </div>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000027.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000027.html');return false;">
          <span class="method-name">length</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the number of entries in self
</p>
        </div>
      </div>

      <div id="method-M000009" class="method-detail">
        <a name="M000009"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000009.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000009.html');return false;">
          <span class="method-name">nil_value</span><span class="method-args">(unpacked=true)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the string value used for nils. Specify unpacked to show the
unpacked array value.
</p>
<pre>
  index = ExternalIndex.new
  index.nil_value            # =&gt; [0]
  index.nil_value(false)     # =&gt; &quot;\000\000\000\000&quot;
</pre>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000028.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000028.html');return false;">
          <span class="method-name">nitems</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the number of non-nil entries in self. Nil entries are those which
equal <a href="ExternalIndex.html#M000009">nil_value</a>. May be zero.
</p>
        </div>
      </div>

      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000011.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000011.html');return false;">
          <span class="method-name">options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns initialization <a href="ExternalIndex.html#M000011">options</a> for
the current settings of self.
</p>
        </div>
      </div>

      <div id="method-M000034" class="method-detail">
        <a name="M000034"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000034.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000034.html');return false;">
          <span class="method-name">pos</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the current position of self (ie io.pos/frame_size). <a
href="ExternalIndex.html#M000034">pos</a> is often used as the default
location for IO-like operations like <a
href="ExternalIndex.html#M000002">read</a> or <a
href="ExternalIndex.html#M000039">write</a>.
</p>
        </div>
      </div>

      <div id="method-M000035" class="method-detail">
        <a name="M000035"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000035.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000035.html');return false;">
          <span class="method-name">pos=</span><span class="method-args">(pos)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the current position of the index. Positions can be set beyond the
actual <a href="ExternalIndex.html#M000027">length</a> of the index,
similar to an IO. Negative positions are counted back from the end of the
index (just as they are in an array), but naturally raise an error if they
count back to a position less than zero.
</p>
<pre>
  index = ExternalIndex[[1],[2],[3]]
  index.length                          # =&gt; 3

  index.pos = 2; index.pos              # =&gt; 2
  index.pos = 10; index.pos             # =&gt; 10

  index.pos = -1; index.pos             # =&gt; 2
  index.pos = -10; index.pos            # !&gt; ArgumentError
</pre>
        </div>
      </div>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000029.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000029.html');return false;">
          <span class="method-name">push</span><span class="method-args">(*array)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Append — Pushes the given entry(s) on to the end of self. This expression
returns self, so several appends may be chained together. Pushed entries
must be in frame.
</p>
        </div>
      </div>

      <div id="method-M000038" class="method-detail">
        <a name="M000038"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000038.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000038.html');return false;">
          <span class="method-name">read</span><span class="method-args">(n=nil, pos=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reads n entries from the specified position (ie, <a
href="ExternalIndex.html#M000002">read</a> is basically <a
href="ExternalIndex.html#M000036">readbytes</a>, then <a
href="ExternalIndex.html#M000037">unpack</a>). By default all remaining
entries will be <a href="ExternalIndex.html#M000002">read</a>; single
entries are returned in frame, multiple entries are returned in an array.
</p>
<pre>
  index = ExternalIndex[[1],[2],[3]]
  index.pos                       # =&gt; 0
  index.read                      # =&gt; [[1],[2],[3]]
  index.read(1,0)                 # =&gt; [[1]]
  index.read(10,1)                # =&gt; [[2],[3]]
</pre>
<p>
The behavior of <a href="ExternalIndex.html#M000002">read</a> when no
entries can be <a href="ExternalIndex.html#M000002">read</a> echos that of
IO; when n is nil, an empty array is returned; when n is specified, nil
will be returned.
</p>
<pre>
  index.pos = 3
  index.read                      # =&gt; []
  index.read(1)                   # =&gt; nil
</pre>
        </div>
      </div>

      <div id="method-M000036" class="method-detail">
        <a name="M000036"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000036.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000036.html');return false;">
          <span class="method-name">readbytes</span><span class="method-args">(n=nil, pos=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reads the packed byte string for n entries from the specified position. By
default all remaining entries will be <a
href="ExternalIndex.html#M000002">read</a>.
</p>
<pre>
  index = ExternalIndex[[1],[2],[3]]
  index.pos                              # =&gt; 0
  index.readbytes.unpack(&quot;I*&quot;)           # =&gt; [1,2,3]
  index.readbytes(1,0).unpack(&quot;I*&quot;)      # =&gt; [1]
  index.readbytes(10,1).unpack(&quot;I*&quot;)     # =&gt; [2,3]
</pre>
<p>
The behavior of <a href="ExternalIndex.html#M000036">readbytes</a> when no
entries can be <a href="ExternalIndex.html#M000002">read</a> echos that of
IO; when n is nil, an empty string is returned; when n is specified, nil
will be returned.
</p>
<pre>
  index.pos = 3
  index.readbytes                        # =&gt; &quot;&quot;
  index.readbytes(1)                     # =&gt; nil
</pre>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000030.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000030.html');return false;">
          <span class="method-name">reverse_each</span><span class="method-args">(&amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="ExternalIndex.html#M000023">each</a>, but traverses self
in reverse order.
</p>
        </div>
      </div>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000031.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000031.html');return false;">
          <span class="method-name">size</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Alias for <a href="ExternalIndex.html#M000027">length</a>
</p>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000032.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000032.html');return false;">
          <span class="method-name">to_a</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Converts self to an array, or returns the cache if cached?.
</p>
        </div>
      </div>

      <div id="method-M000040" class="method-detail">
        <a name="M000040"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000040.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000040.html');return false;">
          <span class="method-name">unframed_write</span><span class="method-args">(array, pos=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Same as <a href="ExternalIndex.html#M000039">write</a>, except the input
entries are unframed. Multiple entries can be provided in a single array,
so long as the total number of elements is divisible into entries of the
correct frame.
</p>
<pre>
  index = ExternalIndex[]
  index.unframed_write([2,3], 1)
  index.pos = 0;
  index.unframed_write([1])
  index.read(3, 0)                # =&gt; [[1],[2],[3]]
</pre>
        </div>
      </div>

      <div id="method-M000037" class="method-detail">
        <a name="M000037"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000037.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000037.html');return false;">
          <span class="method-name">unpack</span><span class="method-args">(str)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Unpacks the given string into an array of index values. Entries are
returned in frame.
</p>
<pre>
  index = ExternalIndex[[1],[2],[3]]
  index.format                          # =&gt; 'I*'
  index.unpack( [1].pack('I*') )        # =&gt; [[1]]
  index.unpack( [1,2,3].pack('I*') )    # =&gt; [[1],[2],[3]]
  index.unpack(&quot;&quot;)                      # =&gt; []
</pre>
        </div>
      </div>

      <div id="method-M000033" class="method-detail">
        <a name="M000033"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000033.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000033.html');return false;">
          <span class="method-name">values_at</span><span class="method-args">(*selectors)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns a copy of self containing the entries corresponding to the given
selector(s). The selectors may be either integer indices or ranges.
</p>
<p>
<em>potentially expensive</em>
</p>
        </div>
      </div>

      <div id="method-M000039" class="method-detail">
        <a name="M000039"></a>

        <div class="method-heading">
          <a href="ExternalIndex.src/M000039.html" target="Code" class="method-signature"
            onclick="popupCode('ExternalIndex.src/M000039.html');return false;">
          <span class="method-name">write</span><span class="method-args">(array, pos=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Writes the framed entries into self starting <a
href="ExternalIndex.html#M000019">at</a> the specified position. By default
writing begins <a href="ExternalIndex.html#M000019">at</a> the current
position. The array can have multiple entries so long as <a
href="ExternalIndex.html#M000023">each</a> is in the correct frame.
</p>
<pre>
  index = ExternalIndex[]
  index.write([[2],[3]], 1)
  index.pos = 0;
  index.write([[1]])
  index.read(3, 0)                # =&gt; [[1],[2],[3]]
</pre>
<p>
<a href="ExternalIndex.html#M000039">write</a> may accept an <a
href="ExternalIndex.html">ExternalIndex</a> if it has the same <a
href="ExternalIndex.html#M000010">index_attrs</a> as self.
</p>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>