<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: README.rdoc</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>README.rdoc</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>README.rdoc
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Sun Jul 24 13:54:21 -0600 2011</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1><a href="../classes/ShellTest.html">ShellTest</a></h1>
<p>
Test modules for shell scripts.
</p>
<h2>Description</h2>
<p>
Provides test modules to simplify testing of shell scripts.
</p>
<p>
<a href="../classes/ShellTest.html">ShellTest</a> is not a testing
framework. <a href="../classes/ShellTest.html">ShellTest</a> integrates
with Test::Unit and MiniTest out of the box, but it should be possible to
include the test modules into other test frameworks.
</p>
<h2>Usage</h2>
<p>
<a href="../classes/ShellTest.html">ShellTest</a> builds on modules that
provide specific functionality. The modules may be used independently, but
by including <a href="../classes/ShellTest.html">ShellTest</a> you get them
all:
</p>
<pre>
  require 'shell_test/unit'

  class ShellTestExample &lt; Test::Unit::TestCase
    include ShellTest

    def test_a_script
      script = prepare('script.sh') do |io|
        io.puts &quot;echo goodnight $1&quot;
      end

      assert_script %{
        $ sh '#{script}' moon
        goodnight moon
      }
    end
  end
</pre>
<h4><a href="../classes/ShellTest/ShellMethods.html">ShellMethods</a></h4>
<p>
Provides the shell testing methods. These methods are designed to input a
string that looks like terminal input/output. Commands are parsed out of
the string, run, and then anything printed to stdout is compared to the
expected output. In addition the exit status is checked for success (0).
</p>
<p>
Special comments following the first line of a command can turn off
output/status checking, or specify a different exit status to expect.
</p>
<pre>
  require 'shell_test/unit'

  class ShellMethodsExample &lt; Test::Unit::TestCase
    include ShellTest::ShellMethods

    def test_a_script_using_variables
      with_env(&quot;THING&quot; =&gt; &quot;moon&quot;) do
        assert_script %{
          $ echo &quot;goodnight $THING&quot;
          goodnight moon
        }
      end
    end

    def test_multiple_commands
      assert_script %{
        $ echo one
        one
        $ echo two
        two
      }
    end

    def test_multiline_commands
      assert_script %{
        $ for n in one two; do
        &gt;   echo $n
        &gt; done
        one
        two
      }
    end

    def test_exit_statuses
      assert_script %{
        $ true  # [0]
        $ false # [1]
      }
    end

    def test_exit_status_and_not_ouptut
      assert_script %{
        $ date  # [0] ...
      }
    end

    def test_output_with_inline_regexps
      assert_script_match %{
        $ cal
        :...:
        Su Mo Tu We Th Fr Sa
        :...:
      }
    end
  end
</pre>
<h4><a href="../classes/ShellTest/FileMethods.html">FileMethods</a></h4>
<p>
Sets up a temporary, test-specific directory for working with files. This
approach is better in most cases than using Tempfile because you can flag
the directory to be saved on a failure (using
ENV[&#8216;KEEP_OUTPUTS&#8217;]=&#8217;true&#8217;).
</p>
<p>
By default the directory is guessed based off of the test file and test
method. If this example were located in the
&#8216;test/file_methods_example.rb&#8217; file, then the directory for the
test case would be
&#8216;test/file_methods_example/test_preparation_of_a_test_specific_file&#8217;.
</p>
<pre>
  require 'shell_test/unit'

  class FileMethodsExample &lt; Test::Unit::TestCase
    include ShellTest::FileMethods

    def test_preparation_of_a_test_specific_file
      path = prepare('dir/file.txt') {|io| io &lt;&lt; 'content' }
      assert_equal &quot;content&quot;, File.read(path)
    end
  end
</pre>
<h2>Installation</h2>
<p>
<a href="../classes/ShellTest.html">ShellTest</a> is available as a <a
href="http://rubygems.org/gems/shell_test">gem</a>.
</p>
<pre>
  $ gem install shell_test
</pre>
<h2>Development</h2>
<p>
To get started, checkout the code from <a
href="http://github.com/thinkerbot/shell_test">GitHub</a> and run:
</p>
<pre>
  git clone https://thinkerbot@github.com/thinkerbot/shell_test.git
  cd shell_test
  rake test
</pre>
<p>
To test against multiple platforms I suggest using rvm. In that case:
</p>
<pre>
  rvm rake test
</pre>
<p>
Please report any issues <a
href="http://github.com/thinkerbot/shell_test/issues">here</a>.
</p>
<h2>Info</h2>
<table>
<tr><td valign="top">Developer:</td><td><a href="http://thinkerbot.posterous.com">Simon Chiang</a>

</td></tr>
<tr><td valign="top">License:</td><td><a href="MIT-LICENSE.html">MIT-Style</a>

</td></tr>
</table>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>