<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Lazydoc::Document</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Lazydoc::Document</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/lazydoc/document_rb.html">
                lib/lazydoc/document.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
A <a href="Document.html">Document</a> resolves constant attributes and
code comments for a particular source file. Documents may be assigned a
default_const_name to be used when a constant attribute does not specify a
constant.
</p>
<pre>
  # Const::Name::key value a
  # ::key value b

  doc = Document.new(__FILE__, 'Default')
  doc.resolve

  Document['Const::Name']['key'].value      # =&gt; 'value a'
  Document['Default']['key'].value          # =&gt; 'value b'
</pre>
<p>
As shown in the example, constant attibutes for all documents are cached in
the class-level <a href="Document.html#M000046">const_attrs</a> hash and
are normally consumed through <a href="Document.html">Document</a> itself.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000050">[]</a>&nbsp;&nbsp;
      <a href="#M000047">[]</a>&nbsp;&nbsp;
      <a href="#M000046">const_attrs</a>&nbsp;&nbsp;
      <a href="#M000052">default_const_name=</a>&nbsp;&nbsp;
      <a href="#M000049">new</a>&nbsp;&nbsp;
      <a href="#M000053">register</a>&nbsp;&nbsp;
      <a href="#M000054">register___</a>&nbsp;&nbsp;
      <a href="#M000055">resolve</a>&nbsp;&nbsp;
      <a href="#M000048">scan</a>&nbsp;&nbsp;
      <a href="#M000051">source_file=</a>&nbsp;&nbsp;
      <a href="#M000056">summarize</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">comments</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
An array of <a href="Comment.html">Comment</a> objects registered to self

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">default_const_name</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The default constant name used when no constant name is specified for a
constant attribute

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">resolved</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Flag indicating whether or not self has been resolved

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">source_file</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc">
The source file for self, used during <a
href="Document.html#M000055">resolve</a>

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000047" class="method-detail">
        <a name="M000047"></a>

        <div class="method-heading">
          <a href="#M000047" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(const_name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the hash of (key, comment) pairs for const_name stored in <a
href="Document.html#M000046">const_attrs</a>. If no such hash exists, one
will be created.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000047-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000047-source">
<pre>
    <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 57</span>
57:       <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">const_name</span>)
58:         <span class="ruby-identifier">const_attrs</span>[<span class="ruby-identifier">const_name</span>] <span class="ruby-operator">||=</span> {}
59:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000046" class="method-detail">
        <a name="M000046"></a>

        <div class="method-heading">
          <a href="#M000046" class="method-signature">
          <span class="method-name">const_attrs</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A nested hash of (const_name, (key, comment)) pairs tracking the constant
attributes assigned to a constant name.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000046-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000046-source">
<pre>
    <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 51</span>
51:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">const_attrs</span>
52:         <span class="ruby-ivar">@const_attrs</span> <span class="ruby-operator">||=</span> {}
53:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000049" class="method-detail">
        <a name="M000049"></a>

        <div class="method-heading">
          <a href="#M000049" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(source_file=nil, default_const_name=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000049-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000049-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 129</span>
129:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">source_file</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">default_const_name</span>=<span class="ruby-keyword kw">nil</span>)
130:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">source_file</span> = <span class="ruby-identifier">source_file</span>
131:       <span class="ruby-ivar">@default_const_name</span> = <span class="ruby-identifier">default_const_name</span>
132:       <span class="ruby-ivar">@comments</span> = []
133:       <span class="ruby-ivar">@resolved</span> = <span class="ruby-keyword kw">false</span>
134:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000048" class="method-detail">
        <a name="M000048"></a>

        <div class="method-heading">
          <a href="#M000048" class="method-signature">
          <span class="method-name">scan</span><span class="method-args">(str, key) {|const_name, key, value| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Scans the string or StringScanner for attributes matching the key (keys may
be patterns; they are incorporated into a regexp). Regions delimited by the
stop and start keys <tt>:::-</tt> and <tt>:::+</tt> are skipped. Yields
each (const_name, key, value) triplet to the block.
</p>
<pre>
  str = %Q{
  # Name::Space::key value
  # ::alt alt_value
  #
  # Ignored::Attribute::not_matched value
  # :::-
  # Also::Ignored::key value
  # :::+
  # Another::key another value

  Ignored::key value
  }

  results = []
  Document.scan(str, 'key|alt') do |const_name, key, value|
    results &lt;&lt; [const_name, key, value]
  end

  results
  # =&gt; [
  # ['Name::Space', 'key', 'value'],
  # ['', 'alt', 'alt_value'],
  # ['Another', 'key', 'another value']]
</pre>
<p>
Returns the StringScanner used during scanning.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000048-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000048-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 92</span>
 92:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scan</span>(<span class="ruby-identifier">str</span>, <span class="ruby-identifier">key</span>) <span class="ruby-comment cmt"># :yields: const_name, key, value</span>
 93:         <span class="ruby-identifier">scanner</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">str</span>
 94:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">StringScanner</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">str</span>
 95:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span> <span class="ruby-keyword kw">then</span> <span class="ruby-constant">StringScanner</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">str</span>)
 96:         <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;can't convert #{str.class} into StringScanner or String&quot;</span>
 97:         <span class="ruby-keyword kw">end</span>
 98:         
 99:         <span class="ruby-identifier">regexp</span> = <span class="ruby-node">/^(.*?)::(:-|#{key})/</span>
100:         <span class="ruby-keyword kw">while</span> <span class="ruby-operator">!</span><span class="ruby-identifier">scanner</span>.<span class="ruby-identifier">eos?</span>
101:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">scanner</span>.<span class="ruby-identifier">skip_until</span>(<span class="ruby-identifier">regexp</span>) <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
102: 
103:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">scanner</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;:-&quot;</span>
104:             <span class="ruby-identifier">scanner</span>.<span class="ruby-identifier">skip_until</span>(<span class="ruby-regexp re">/:::\+/</span>)
105:           <span class="ruby-keyword kw">else</span>
106:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">scanner</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">=~</span> <span class="ruby-constant">CONSTANT_REGEXP</span>
107:             <span class="ruby-identifier">key</span> = <span class="ruby-identifier">scanner</span>[<span class="ruby-value">2</span>]
108:             <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">$1</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">scanner</span>.<span class="ruby-identifier">matched</span>.<span class="ruby-identifier">strip</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">scanner</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/[ \r\t].*$|$/</span>)
109:           <span class="ruby-keyword kw">end</span>
110:         <span class="ruby-keyword kw">end</span>
111: 
112:         <span class="ruby-identifier">scanner</span>
113:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000050" class="method-detail">
        <a name="M000050"></a>

        <div class="method-heading">
          <a href="#M000050" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(const_name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns the attributes for the specified const_name. If an empty const_name
(&#8217;&#8217;) is specified, and a default_const_name is set, the
default_const_name will be used instead.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000050-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000050-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 139</span>
139:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">const_name</span>)
140:       <span class="ruby-identifier">const_name</span> = <span class="ruby-identifier">default_const_name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">default_const_name</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">const_name</span> <span class="ruby-operator">==</span> <span class="ruby-value str">''</span>
141:       <span class="ruby-constant">Document</span>[<span class="ruby-identifier">const_name</span>]
142:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000052" class="method-detail">
        <a name="M000052"></a>

        <div class="method-heading">
          <a href="#M000052" class="method-signature">
          <span class="method-name">default_const_name=</span><span class="method-args">(input)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the default_const_name. Raises an error if default_const_name is
already set to a different value.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000052-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000052-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 151</span>
151:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_const_name=</span>(<span class="ruby-identifier">input</span>)
152:       <span class="ruby-ivar">@default_const_name</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@default_const_name</span>
153:       <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">input</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">input</span>
154:       <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;default_const_name cannot be overridden #{source_file}: #{@default_const_name.inspect} != #{input.inspect}&quot;</span>
155:       <span class="ruby-keyword kw">end</span>
156:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000053" class="method-detail">
        <a name="M000053"></a>

        <div class="method-heading">
          <a href="#M000053" class="method-signature">
          <span class="method-name">register</span><span class="method-args">(line_number, comment_class=Comment)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers the specified line number to self. Register may take an integer
or a regexp for dynamic evaluation. See <a
href="Comment.html#M000035">Comment#resolve</a> for more details.
</p>
<p>
Returns the newly registered comment.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000053-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000053-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 163</span>
163:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">register</span>(<span class="ruby-identifier">line_number</span>, <span class="ruby-identifier">comment_class</span>=<span class="ruby-constant">Comment</span>)
164:       <span class="ruby-identifier">comment</span> = <span class="ruby-identifier">comment_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">line_number</span>, <span class="ruby-keyword kw">self</span>)
165:       <span class="ruby-identifier">comments</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">comment</span>
166:       <span class="ruby-identifier">comment</span>
167:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000054" class="method-detail">
        <a name="M000054"></a>

        <div class="method-heading">
          <a href="#M000054" class="method-signature">
          <span class="method-name">register___</span><span class="method-args">(comment_class=Comment, caller_index=0)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Registers the next comment.
</p>
<pre>
  lazydoc = Document.new(__FILE__)

  c = lazydoc.register___
  # this is the comment
  # that is registered
  def method(a,b,c)
  end

  lazydoc.resolve

  c.subject      # =&gt; &quot;def method(a,b,c)&quot;
  c.comment      # =&gt; &quot;this is the comment that is registered&quot;
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000054-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000054-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 184</span>
184:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">register___</span>(<span class="ruby-identifier">comment_class</span>=<span class="ruby-constant">Comment</span>, <span class="ruby-identifier">caller_index</span>=<span class="ruby-value">0</span>)
185:       <span class="ruby-identifier">caller</span>[<span class="ruby-identifier">caller_index</span>] <span class="ruby-operator">=~</span> <span class="ruby-constant">CALLER_REGEXP</span>
186:       <span class="ruby-identifier">block</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">scanner</span>, <span class="ruby-identifier">lines</span><span class="ruby-operator">|</span>
187:         <span class="ruby-identifier">n</span> = <span class="ruby-identifier">$3</span>.<span class="ruby-identifier">to_i</span>
188:         <span class="ruby-identifier">n</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">lines</span>[<span class="ruby-identifier">n</span>] <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*(#.*)?$/</span>
189:         <span class="ruby-identifier">n</span>
190:       <span class="ruby-keyword kw">end</span>
191:       <span class="ruby-identifier">register</span>(<span class="ruby-identifier">block</span>, <span class="ruby-identifier">comment_class</span>)
192:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000055" class="method-detail">
        <a name="M000055"></a>

        <div class="method-heading">
          <a href="#M000055" class="method-signature">
          <span class="method-name">resolve</span><span class="method-args">(str=nil, force=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Scans str for constant attributes and adds them to <a
href="Document.html#M000046">Document.const_attrs</a>. Comments registered
with self are also resolved against str. If no str is specified, the
contents of source_file are used instead.
</p>
<p>
Resolve does nothing if resolved == true, unless force is also specified.
Returns true if str was resolved, or false otherwise.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000055-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000055-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 200</span>
200:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">str</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">force</span>=<span class="ruby-keyword kw">false</span>)
201:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">resolved</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">force</span>
202:       <span class="ruby-ivar">@resolved</span> = <span class="ruby-keyword kw">true</span>
203:       
204:       <span class="ruby-identifier">str</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">source_file</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
205:       <span class="ruby-identifier">lines</span> = <span class="ruby-constant">Utils</span>.<span class="ruby-identifier">split_lines</span>(<span class="ruby-identifier">str</span>)
206:       <span class="ruby-identifier">scanner</span> = <span class="ruby-constant">Utils</span>.<span class="ruby-identifier">convert_to_scanner</span>(<span class="ruby-identifier">str</span>)
207:       
208:       <span class="ruby-constant">Document</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-identifier">scanner</span>, <span class="ruby-value str">'[a-z_]+'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">const_name</span>, <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
209:         <span class="ruby-comment cmt"># get or initialize the comment that will be parsed</span>
210:         <span class="ruby-identifier">comment</span> = (<span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">const_name</span>][<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Subject</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">self</span>))
211:         
212:         <span class="ruby-comment cmt"># skip non-comment constant attributes</span>
213:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Comment</span>)
214:         
215:         <span class="ruby-comment cmt"># parse the comment</span>
216:         <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">parse_down</span>(<span class="ruby-identifier">scanner</span>, <span class="ruby-identifier">lines</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
217:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">ATTRIBUTE_REGEXP</span>
218:             <span class="ruby-comment cmt"># rewind to capture the next attribute unless an end is specified.</span>
219:             <span class="ruby-identifier">scanner</span>.<span class="ruby-identifier">unscan</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">$4</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'-'</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$3</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$1</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">const_name</span>
220:             <span class="ruby-keyword kw">true</span>
221:           <span class="ruby-keyword kw">else</span> <span class="ruby-keyword kw">false</span>
222:           <span class="ruby-keyword kw">end</span>
223:         <span class="ruby-keyword kw">end</span>
224:         
225:         <span class="ruby-comment cmt"># set the subject</span>
226:         <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-identifier">value</span>
227:       <span class="ruby-keyword kw">end</span>
228:       
229:       <span class="ruby-comment cmt"># resolve registered comments</span>
230:       <span class="ruby-identifier">comments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">comment</span><span class="ruby-operator">|</span>
231:         <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">parse_up</span>(<span class="ruby-identifier">scanner</span>, <span class="ruby-identifier">lines</span>)
232:         
233:         <span class="ruby-identifier">n</span> = <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">line_number</span>
234:         <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-identifier">n</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Integer</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">lines</span>[<span class="ruby-identifier">n</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
235:       <span class="ruby-keyword kw">end</span>
236:       
237:       <span class="ruby-keyword kw">true</span>
238:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000051" class="method-detail">
        <a name="M000051"></a>

        <div class="method-heading">
          <a href="#M000051" class="method-signature">
          <span class="method-name">source_file=</span><span class="method-args">(source_file)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Expands and sets the source file for self.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000051-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000051-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 145</span>
145:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">source_file=</span>(<span class="ruby-identifier">source_file</span>)
146:       <span class="ruby-ivar">@source_file</span> = <span class="ruby-identifier">source_file</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">source_file</span>)
147:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000056" class="method-detail">
        <a name="M000056"></a>

        <div class="method-heading">
          <a href="#M000056" class="method-signature">
          <span class="method-name">summarize</span><span class="method-args">() {|comment| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Summarizes constant attributes registered to self by collecting them into a
nested hash of (const_name, (key, comment)) pairs. A block may be provided
to collect values from the comments; each comment is yielded to the block
and the return stored in it&#8216;s place.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000056-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000056-source">
<pre>
     <span class="ruby-comment cmt"># File lib/lazydoc/document.rb, line 244</span>
244:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">summarize</span>
245:       <span class="ruby-identifier">const_hash</span> = {}
246:       <span class="ruby-constant">Document</span>.<span class="ruby-identifier">const_attrs</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">const_name</span>, <span class="ruby-identifier">attributes</span><span class="ruby-operator">|</span>
247:         <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">empty?</span>
248: 
249:         <span class="ruby-identifier">const_hash</span>[<span class="ruby-identifier">const_name</span>] = <span class="ruby-identifier">attr_hash</span> = {}
250:         <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">comment</span><span class="ruby-operator">|</span>
251:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">document</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>
252:           <span class="ruby-identifier">attr_hash</span>[<span class="ruby-identifier">key</span>] = (<span class="ruby-identifier">block_given?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">comment</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">comment</span>)
253:         <span class="ruby-keyword kw">end</span>
254:       <span class="ruby-keyword kw">end</span>
255:       <span class="ruby-identifier">const_hash</span>
256:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>